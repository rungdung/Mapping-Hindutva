(function(){const U=document.createElement("link").relList;if(U&&U.supports&&U.supports("modulepreload"))return;for(const tt of document.querySelectorAll('link[rel="modulepreload"]'))X(tt);new MutationObserver(tt=>{for(const Y of tt)if(Y.type==="childList")for(const nt of Y.addedNodes)nt.tagName==="LINK"&&nt.rel==="modulepreload"&&X(nt)}).observe(document,{childList:!0,subtree:!0});function W(tt){const Y={};return tt.integrity&&(Y.integrity=tt.integrity),tt.referrerPolicy&&(Y.referrerPolicy=tt.referrerPolicy),tt.crossOrigin==="use-credentials"?Y.credentials="include":tt.crossOrigin==="anonymous"?Y.credentials="omit":Y.credentials="same-origin",Y}function X(tt){if(tt.ep)return;tt.ep=!0;const Y=W(tt);fetch(tt.href,Y)}})();const app="";function noop$1(){}function assign(Z,U){for(const W in U)Z[W]=U[W];return Z}function run(Z){return Z()}function blank_object(){return Object.create(null)}function run_all(Z){Z.forEach(run)}function is_function(Z){return typeof Z=="function"}function safe_not_equal(Z,U){return Z!=Z?U==U:Z!==U||Z&&typeof Z=="object"||typeof Z=="function"}let src_url_equal_anchor;function src_url_equal(Z,U){return src_url_equal_anchor||(src_url_equal_anchor=document.createElement("a")),src_url_equal_anchor.href=U,Z===src_url_equal_anchor.href}function is_empty(Z){return Object.keys(Z).length===0}function subscribe(Z,...U){if(Z==null)return noop$1;const W=Z.subscribe(...U);return W.unsubscribe?()=>W.unsubscribe():W}function get_store_value(Z){let U;return subscribe(Z,W=>U=W)(),U}function component_subscribe(Z,U,W){Z.$$.on_destroy.push(subscribe(U,W))}function create_slot(Z,U,W,X){if(Z){const tt=get_slot_context(Z,U,W,X);return Z[0](tt)}}function get_slot_context(Z,U,W,X){return Z[1]&&X?assign(W.ctx.slice(),Z[1](X(U))):W.ctx}function get_slot_changes(Z,U,W,X){if(Z[2]&&X){const tt=Z[2](X(W));if(U.dirty===void 0)return tt;if(typeof tt=="object"){const Y=[],nt=Math.max(U.dirty.length,tt.length);for(let it=0;it<nt;it+=1)Y[it]=U.dirty[it]|tt[it];return Y}return U.dirty|tt}return U.dirty}function update_slot_base(Z,U,W,X,tt,Y){if(tt){const nt=get_slot_context(U,W,X,Y);Z.p(nt,tt)}}function get_all_dirty_from_scope(Z){if(Z.ctx.length>32){const U=[],W=Z.ctx.length/32;for(let X=0;X<W;X++)U[X]=-1;return U}return-1}function null_to_empty(Z){return Z??""}function set_store_value(Z,U,W){return Z.set(W),U}function append(Z,U){Z.appendChild(U)}function insert(Z,U,W){Z.insertBefore(U,W||null)}function detach(Z){Z.parentNode&&Z.parentNode.removeChild(Z)}function destroy_each(Z,U){for(let W=0;W<Z.length;W+=1)Z[W]&&Z[W].d(U)}function element(Z){return document.createElement(Z)}function svg_element(Z){return document.createElementNS("http://www.w3.org/2000/svg",Z)}function text(Z){return document.createTextNode(Z)}function space(){return text(" ")}function empty$1(){return text("")}function listen(Z,U,W,X){return Z.addEventListener(U,W,X),()=>Z.removeEventListener(U,W,X)}function prevent_default(Z){return function(U){return U.preventDefault(),Z.call(this,U)}}function attr(Z,U,W){W==null?Z.removeAttribute(U):Z.getAttribute(U)!==W&&Z.setAttribute(U,W)}function children$1(Z){return Array.from(Z.childNodes)}function set_data(Z,U){U=""+U,Z.wholeText!==U&&(Z.data=U)}function set_input_value(Z,U){Z.value=U??""}function set_style(Z,U,W,X){W===null?Z.style.removeProperty(U):Z.style.setProperty(U,W,X?"important":"")}function custom_event(Z,U,{bubbles:W=!1,cancelable:X=!1}={}){const tt=document.createEvent("CustomEvent");return tt.initCustomEvent(Z,W,X,U),tt}class HtmlTag{constructor(U=!1){this.is_svg=!1,this.is_svg=U,this.e=this.n=null}c(U){this.h(U)}m(U,W,X=null){this.e||(this.is_svg?this.e=svg_element(W.nodeName):this.e=element(W.nodeType===11?"TEMPLATE":W.nodeName),this.t=W.tagName!=="TEMPLATE"?W:W.content,this.c(U)),this.i(X)}h(U){this.e.innerHTML=U,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(U){for(let W=0;W<this.n.length;W+=1)insert(this.t,this.n[W],U)}p(U){this.d(),this.h(U),this.i(this.a)}d(){this.n.forEach(detach)}}function construct_svelte_component(Z,U){return new Z(U)}let current_component;function set_current_component(Z){current_component=Z}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function onMount(Z){get_current_component().$$.on_mount.push(Z)}function afterUpdate(Z){get_current_component().$$.after_update.push(Z)}function createEventDispatcher(){const Z=get_current_component();return(U,W,{cancelable:X=!1}={})=>{const tt=Z.$$.callbacks[U];if(tt){const Y=custom_event(U,W,{cancelable:X});return tt.slice().forEach(nt=>{nt.call(Z,Y)}),!Y.defaultPrevented}return!0}}function bubble(Z,U){const W=Z.$$.callbacks[U.type];W&&W.slice().forEach(X=>X.call(this,U))}const dirty_components=[],binding_callbacks=[];let render_callbacks=[];const flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function add_render_callback(Z){render_callbacks.push(Z)}const seen_callbacks=new Set;let flushidx=0;function flush(){if(flushidx!==0)return;const Z=current_component;do{try{for(;flushidx<dirty_components.length;){const U=dirty_components[flushidx];flushidx++,set_current_component(U),update(U.$$)}}catch(U){throw dirty_components.length=0,flushidx=0,U}for(set_current_component(null),dirty_components.length=0,flushidx=0;binding_callbacks.length;)binding_callbacks.pop()();for(let U=0;U<render_callbacks.length;U+=1){const W=render_callbacks[U];seen_callbacks.has(W)||(seen_callbacks.add(W),W())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,seen_callbacks.clear(),set_current_component(Z)}function update(Z){if(Z.fragment!==null){Z.update(),run_all(Z.before_update);const U=Z.dirty;Z.dirty=[-1],Z.fragment&&Z.fragment.p(Z.ctx,U),Z.after_update.forEach(add_render_callback)}}function flush_render_callbacks(Z){const U=[],W=[];render_callbacks.forEach(X=>Z.indexOf(X)===-1?U.push(X):W.push(X)),W.forEach(X=>X()),render_callbacks=U}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(Z,U){Z&&Z.i&&(outroing.delete(Z),Z.i(U))}function transition_out(Z,U,W,X){if(Z&&Z.o){if(outroing.has(Z))return;outroing.add(Z),outros.c.push(()=>{outroing.delete(Z),X&&(W&&Z.d(1),X())}),Z.o(U)}else X&&X()}function create_component(Z){Z&&Z.c()}function mount_component(Z,U,W,X){const{fragment:tt,after_update:Y}=Z.$$;tt&&tt.m(U,W),X||add_render_callback(()=>{const nt=Z.$$.on_mount.map(run).filter(is_function);Z.$$.on_destroy?Z.$$.on_destroy.push(...nt):run_all(nt),Z.$$.on_mount=[]}),Y.forEach(add_render_callback)}function destroy_component(Z,U){const W=Z.$$;W.fragment!==null&&(flush_render_callbacks(W.after_update),run_all(W.on_destroy),W.fragment&&W.fragment.d(U),W.on_destroy=W.fragment=null,W.ctx=[])}function make_dirty(Z,U){Z.$$.dirty[0]===-1&&(dirty_components.push(Z),schedule_update(),Z.$$.dirty.fill(0)),Z.$$.dirty[U/31|0]|=1<<U%31}function init$1(Z,U,W,X,tt,Y,nt,it=[-1]){const rt=current_component;set_current_component(Z);const st=Z.$$={fragment:null,ctx:[],props:Y,update:noop$1,not_equal:tt,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(U.context||(rt?rt.$$.context:[])),callbacks:blank_object(),dirty:it,skip_bound:!1,root:U.target||rt.$$.root};nt&&nt(st.root);let at=!1;if(st.ctx=W?W(Z,U.props||{},(ct,ht,...ut)=>{const dt=ut.length?ut[0]:ht;return st.ctx&&tt(st.ctx[ct],st.ctx[ct]=dt)&&(!st.skip_bound&&st.bound[ct]&&st.bound[ct](dt),at&&make_dirty(Z,ct)),ht}):[],st.update(),at=!0,run_all(st.before_update),st.fragment=X?X(st.ctx):!1,U.target){if(U.hydrate){const ct=children$1(U.target);st.fragment&&st.fragment.l(ct),ct.forEach(detach)}else st.fragment&&st.fragment.c();U.intro&&transition_in(Z.$$.fragment),mount_component(Z,U.target,U.anchor,U.customElement),flush()}set_current_component(rt)}class SvelteComponent{$destroy(){destroy_component(this,1),this.$destroy=noop$1}$on(U,W){if(!is_function(W))return noop$1;const X=this.$$.callbacks[U]||(this.$$.callbacks[U]=[]);return X.push(W),()=>{const tt=X.indexOf(W);tt!==-1&&X.splice(tt,1)}}$set(U){this.$$set&&!is_empty(U)&&(this.$$.skip_bound=!0,this.$$set(U),this.$$.skip_bound=!1)}}const leaflet="";var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},leafletSrcExports={},leafletSrc={get exports(){return leafletSrcExports},set exports(Z){leafletSrcExports=Z}};/* @preserve
 * Leaflet 1.9.3, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2022 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(Z,U){(function(W,X){X(U)})(commonjsGlobal,function(W){var X="1.9.3";function tt(r){var V,et,ot,lt;for(et=1,ot=arguments.length;et<ot;et++){lt=arguments[et];for(V in lt)r[V]=lt[V]}return r}var Y=Object.create||function(){function r(){}return function(V){return r.prototype=V,new r}}();function nt(r,V){var et=Array.prototype.slice;if(r.bind)return r.bind.apply(r,et.call(arguments,1));var ot=et.call(arguments,2);return function(){return r.apply(V,ot.length?ot.concat(et.call(arguments)):arguments)}}var it=0;function rt(r){return"_leaflet_id"in r||(r._leaflet_id=++it),r._leaflet_id}function st(r,V,et){var ot,lt,ft,pt;return pt=function(){ot=!1,lt&&(ft.apply(et,lt),lt=!1)},ft=function(){ot?lt=arguments:(r.apply(et,arguments),setTimeout(pt,V),ot=!0)},ft}function at(r,V,et){var ot=V[1],lt=V[0],ft=ot-lt;return r===ot&&et?r:((r-lt)%ft+ft)%ft+lt}function ct(){return!1}function ht(r,V){if(V===!1)return r;var et=Math.pow(10,V===void 0?6:V);return Math.round(r*et)/et}function ut(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function dt(r){return ut(r).split(/\s+/)}function _t(r,V){Object.prototype.hasOwnProperty.call(r,"options")||(r.options=r.options?Y(r.options):{});for(var et in V)r.options[et]=V[et];return r.options}function kt(r,V,et){var ot=[];for(var lt in r)ot.push(encodeURIComponent(et?lt.toUpperCase():lt)+"="+encodeURIComponent(r[lt]));return(!V||V.indexOf("?")===-1?"?":"&")+ot.join("&")}var gt=/\{ *([\w_ -]+) *\}/g;function Tt(r,V){return r.replace(gt,function(et,ot){var lt=V[ot];if(lt===void 0)throw new Error("No value provided for variable "+et);return typeof lt=="function"&&(lt=lt(V)),lt})}var Ot=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};function Lt(r,V){for(var et=0;et<r.length;et++)if(r[et]===V)return et;return-1}var vt="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function bt(r){return window["webkit"+r]||window["moz"+r]||window["ms"+r]}var Pt=0;function zt(r){var V=+new Date,et=Math.max(0,16-(V-Pt));return Pt=V+et,window.setTimeout(r,et)}var wt=window.requestAnimationFrame||bt("RequestAnimationFrame")||zt,Ct=window.cancelAnimationFrame||bt("CancelAnimationFrame")||bt("CancelRequestAnimationFrame")||function(r){window.clearTimeout(r)};function Vt(r,V,et){if(et&&wt===zt)r.call(V);else return wt.call(window,nt(r,V))}function Ut(r){r&&Ct.call(window,r)}var oe={__proto__:null,extend:tt,create:Y,bind:nt,get lastId(){return it},stamp:rt,throttle:st,wrapNum:at,falseFn:ct,formatNum:ht,trim:ut,splitWords:dt,setOptions:_t,getParamString:kt,template:Tt,isArray:Ot,indexOf:Lt,emptyImageUrl:vt,requestFn:wt,cancelFn:Ct,requestAnimFrame:Vt,cancelAnimFrame:Ut};function mt(){}mt.extend=function(r){var V=function(){_t(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},et=V.__super__=this.prototype,ot=Y(et);ot.constructor=V,V.prototype=ot;for(var lt in this)Object.prototype.hasOwnProperty.call(this,lt)&&lt!=="prototype"&&lt!=="__super__"&&(V[lt]=this[lt]);return r.statics&&tt(V,r.statics),r.includes&&(Bt(r.includes),tt.apply(null,[ot].concat(r.includes))),tt(ot,r),delete ot.statics,delete ot.includes,ot.options&&(ot.options=et.options?Y(et.options):{},tt(ot.options,r.options)),ot._initHooks=[],ot.callInitHooks=function(){if(!this._initHooksCalled){et.callInitHooks&&et.callInitHooks.call(this),this._initHooksCalled=!0;for(var ft=0,pt=ot._initHooks.length;ft<pt;ft++)ot._initHooks[ft].call(this)}},V},mt.include=function(r){var V=this.prototype.options;return tt(this.prototype,r),r.options&&(this.prototype.options=V,this.mergeOptions(r.options)),this},mt.mergeOptions=function(r){return tt(this.prototype.options,r),this},mt.addInitHook=function(r){var V=Array.prototype.slice.call(arguments,1),et=typeof r=="function"?r:function(){this[r].apply(this,V)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(et),this};function Bt(r){if(!(typeof L>"u"||!L||!L.Mixin)){r=Ot(r)?r:[r];for(var V=0;V<r.length;V++)r[V]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var It={on:function(r,V,et){if(typeof r=="object")for(var ot in r)this._on(ot,r[ot],V);else{r=dt(r);for(var lt=0,ft=r.length;lt<ft;lt++)this._on(r[lt],V,et)}return this},off:function(r,V,et){if(!arguments.length)delete this._events;else if(typeof r=="object")for(var ot in r)this._off(ot,r[ot],V);else{r=dt(r);for(var lt=arguments.length===1,ft=0,pt=r.length;ft<pt;ft++)lt?this._off(r[ft]):this._off(r[ft],V,et)}return this},_on:function(r,V,et,ot){if(typeof V!="function"){console.warn("wrong listener type: "+typeof V);return}if(this._listens(r,V,et)===!1){et===this&&(et=void 0);var lt={fn:V,ctx:et};ot&&(lt.once=!0),this._events=this._events||{},this._events[r]=this._events[r]||[],this._events[r].push(lt)}},_off:function(r,V,et){var ot,lt,ft;if(this._events&&(ot=this._events[r],!!ot)){if(arguments.length===1){if(this._firingCount)for(lt=0,ft=ot.length;lt<ft;lt++)ot[lt].fn=ct;delete this._events[r];return}if(typeof V!="function"){console.warn("wrong listener type: "+typeof V);return}var pt=this._listens(r,V,et);if(pt!==!1){var yt=ot[pt];this._firingCount&&(yt.fn=ct,this._events[r]=ot=ot.slice()),ot.splice(pt,1)}}},fire:function(r,V,et){if(!this.listens(r,et))return this;var ot=tt({},V,{type:r,target:this,sourceTarget:V&&V.sourceTarget||this});if(this._events){var lt=this._events[r];if(lt){this._firingCount=this._firingCount+1||1;for(var ft=0,pt=lt.length;ft<pt;ft++){var yt=lt[ft],xt=yt.fn;yt.once&&this.off(r,xt,yt.ctx),xt.call(yt.ctx||this,ot)}this._firingCount--}}return et&&this._propagateEvent(ot),this},listens:function(r,V,et,ot){typeof r!="string"&&console.warn('"string" type argument expected');var lt=V;typeof V!="function"&&(ot=!!V,lt=void 0,et=void 0);var ft=this._events&&this._events[r];if(ft&&ft.length&&this._listens(r,lt,et)!==!1)return!0;if(ot){for(var pt in this._eventParents)if(this._eventParents[pt].listens(r,V,et,ot))return!0}return!1},_listens:function(r,V,et){if(!this._events)return!1;var ot=this._events[r]||[];if(!V)return!!ot.length;et===this&&(et=void 0);for(var lt=0,ft=ot.length;lt<ft;lt++)if(ot[lt].fn===V&&ot[lt].ctx===et)return lt;return!1},once:function(r,V,et){if(typeof r=="object")for(var ot in r)this._on(ot,r[ot],V,!0);else{r=dt(r);for(var lt=0,ft=r.length;lt<ft;lt++)this._on(r[lt],V,et,!0)}return this},addEventParent:function(r){return this._eventParents=this._eventParents||{},this._eventParents[rt(r)]=r,this},removeEventParent:function(r){return this._eventParents&&delete this._eventParents[rt(r)],this},_propagateEvent:function(r){for(var V in this._eventParents)this._eventParents[V].fire(r.type,tt({layer:r.target,propagatedFrom:r.target},r),!0)}};It.addEventListener=It.on,It.removeEventListener=It.clearAllEventListeners=It.off,It.addOneTimeEventListener=It.once,It.fireEvent=It.fire,It.hasEventListeners=It.listens;var At=mt.extend(It);function Et(r,V,et){this.x=et?Math.round(r):r,this.y=et?Math.round(V):V}var jt=Math.trunc||function(r){return r>0?Math.floor(r):Math.ceil(r)};Et.prototype={clone:function(){return new Et(this.x,this.y)},add:function(r){return this.clone()._add(Mt(r))},_add:function(r){return this.x+=r.x,this.y+=r.y,this},subtract:function(r){return this.clone()._subtract(Mt(r))},_subtract:function(r){return this.x-=r.x,this.y-=r.y,this},divideBy:function(r){return this.clone()._divideBy(r)},_divideBy:function(r){return this.x/=r,this.y/=r,this},multiplyBy:function(r){return this.clone()._multiplyBy(r)},_multiplyBy:function(r){return this.x*=r,this.y*=r,this},scaleBy:function(r){return new Et(this.x*r.x,this.y*r.y)},unscaleBy:function(r){return new Et(this.x/r.x,this.y/r.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=jt(this.x),this.y=jt(this.y),this},distanceTo:function(r){r=Mt(r);var V=r.x-this.x,et=r.y-this.y;return Math.sqrt(V*V+et*et)},equals:function(r){return r=Mt(r),r.x===this.x&&r.y===this.y},contains:function(r){return r=Mt(r),Math.abs(r.x)<=Math.abs(this.x)&&Math.abs(r.y)<=Math.abs(this.y)},toString:function(){return"Point("+ht(this.x)+", "+ht(this.y)+")"}};function Mt(r,V,et){return r instanceof Et?r:Ot(r)?new Et(r[0],r[1]):r==null?r:typeof r=="object"&&"x"in r&&"y"in r?new Et(r.x,r.y):new Et(r,V,et)}function Zt(r,V){if(r)for(var et=V?[r,V]:r,ot=0,lt=et.length;ot<lt;ot++)this.extend(et[ot])}Zt.prototype={extend:function(r){var V,et;if(!r)return this;if(r instanceof Et||typeof r[0]=="number"||"x"in r)V=et=Mt(r);else if(r=Xt(r),V=r.min,et=r.max,!V||!et)return this;return!this.min&&!this.max?(this.min=V.clone(),this.max=et.clone()):(this.min.x=Math.min(V.x,this.min.x),this.max.x=Math.max(et.x,this.max.x),this.min.y=Math.min(V.y,this.min.y),this.max.y=Math.max(et.y,this.max.y)),this},getCenter:function(r){return Mt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,r)},getBottomLeft:function(){return Mt(this.min.x,this.max.y)},getTopRight:function(){return Mt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(r){var V,et;return typeof r[0]=="number"||r instanceof Et?r=Mt(r):r=Xt(r),r instanceof Zt?(V=r.min,et=r.max):V=et=r,V.x>=this.min.x&&et.x<=this.max.x&&V.y>=this.min.y&&et.y<=this.max.y},intersects:function(r){r=Xt(r);var V=this.min,et=this.max,ot=r.min,lt=r.max,ft=lt.x>=V.x&&ot.x<=et.x,pt=lt.y>=V.y&&ot.y<=et.y;return ft&&pt},overlaps:function(r){r=Xt(r);var V=this.min,et=this.max,ot=r.min,lt=r.max,ft=lt.x>V.x&&ot.x<et.x,pt=lt.y>V.y&&ot.y<et.y;return ft&&pt},isValid:function(){return!!(this.min&&this.max)},pad:function(r){var V=this.min,et=this.max,ot=Math.abs(V.x-et.x)*r,lt=Math.abs(V.y-et.y)*r;return Xt(Mt(V.x-ot,V.y-lt),Mt(et.x+ot,et.y+lt))},equals:function(r){return r?(r=Xt(r),this.min.equals(r.getTopLeft())&&this.max.equals(r.getBottomRight())):!1}};function Xt(r,V){return!r||r instanceof Zt?r:new Zt(r,V)}function Yt(r,V){if(r)for(var et=V?[r,V]:r,ot=0,lt=et.length;ot<lt;ot++)this.extend(et[ot])}Yt.prototype={extend:function(r){var V=this._southWest,et=this._northEast,ot,lt;if(r instanceof Ft)ot=r,lt=r;else if(r instanceof Yt){if(ot=r._southWest,lt=r._northEast,!ot||!lt)return this}else return r?this.extend(te(r)||qt(r)):this;return!V&&!et?(this._southWest=new Ft(ot.lat,ot.lng),this._northEast=new Ft(lt.lat,lt.lng)):(V.lat=Math.min(ot.lat,V.lat),V.lng=Math.min(ot.lng,V.lng),et.lat=Math.max(lt.lat,et.lat),et.lng=Math.max(lt.lng,et.lng)),this},pad:function(r){var V=this._southWest,et=this._northEast,ot=Math.abs(V.lat-et.lat)*r,lt=Math.abs(V.lng-et.lng)*r;return new Yt(new Ft(V.lat-ot,V.lng-lt),new Ft(et.lat+ot,et.lng+lt))},getCenter:function(){return new Ft((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Ft(this.getNorth(),this.getWest())},getSouthEast:function(){return new Ft(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(r){typeof r[0]=="number"||r instanceof Ft||"lat"in r?r=te(r):r=qt(r);var V=this._southWest,et=this._northEast,ot,lt;return r instanceof Yt?(ot=r.getSouthWest(),lt=r.getNorthEast()):ot=lt=r,ot.lat>=V.lat&&lt.lat<=et.lat&&ot.lng>=V.lng&&lt.lng<=et.lng},intersects:function(r){r=qt(r);var V=this._southWest,et=this._northEast,ot=r.getSouthWest(),lt=r.getNorthEast(),ft=lt.lat>=V.lat&&ot.lat<=et.lat,pt=lt.lng>=V.lng&&ot.lng<=et.lng;return ft&&pt},overlaps:function(r){r=qt(r);var V=this._southWest,et=this._northEast,ot=r.getSouthWest(),lt=r.getNorthEast(),ft=lt.lat>V.lat&&ot.lat<et.lat,pt=lt.lng>V.lng&&ot.lng<et.lng;return ft&&pt},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(r,V){return r?(r=qt(r),this._southWest.equals(r.getSouthWest(),V)&&this._northEast.equals(r.getNorthEast(),V)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function qt(r,V){return r instanceof Yt?r:new Yt(r,V)}function Ft(r,V,et){if(isNaN(r)||isNaN(V))throw new Error("Invalid LatLng object: ("+r+", "+V+")");this.lat=+r,this.lng=+V,et!==void 0&&(this.alt=+et)}Ft.prototype={equals:function(r,V){if(!r)return!1;r=te(r);var et=Math.max(Math.abs(this.lat-r.lat),Math.abs(this.lng-r.lng));return et<=(V===void 0?1e-9:V)},toString:function(r){return"LatLng("+ht(this.lat,r)+", "+ht(this.lng,r)+")"},distanceTo:function(r){return Jt.distance(this,te(r))},wrap:function(){return Jt.wrapLatLng(this)},toBounds:function(r){var V=180*r/40075017,et=V/Math.cos(Math.PI/180*this.lat);return qt([this.lat-V,this.lng-et],[this.lat+V,this.lng+et])},clone:function(){return new Ft(this.lat,this.lng,this.alt)}};function te(r,V,et){return r instanceof Ft?r:Ot(r)&&typeof r[0]!="object"?r.length===3?new Ft(r[0],r[1],r[2]):r.length===2?new Ft(r[0],r[1]):null:r==null?r:typeof r=="object"&&"lat"in r?new Ft(r.lat,"lng"in r?r.lng:r.lon,r.alt):V===void 0?null:new Ft(r,V,et)}var se={latLngToPoint:function(r,V){var et=this.projection.project(r),ot=this.scale(V);return this.transformation._transform(et,ot)},pointToLatLng:function(r,V){var et=this.scale(V),ot=this.transformation.untransform(r,et);return this.projection.unproject(ot)},project:function(r){return this.projection.project(r)},unproject:function(r){return this.projection.unproject(r)},scale:function(r){return 256*Math.pow(2,r)},zoom:function(r){return Math.log(r/256)/Math.LN2},getProjectedBounds:function(r){if(this.infinite)return null;var V=this.projection.bounds,et=this.scale(r),ot=this.transformation.transform(V.min,et),lt=this.transformation.transform(V.max,et);return new Zt(ot,lt)},infinite:!1,wrapLatLng:function(r){var V=this.wrapLng?at(r.lng,this.wrapLng,!0):r.lng,et=this.wrapLat?at(r.lat,this.wrapLat,!0):r.lat,ot=r.alt;return new Ft(et,V,ot)},wrapLatLngBounds:function(r){var V=r.getCenter(),et=this.wrapLatLng(V),ot=V.lat-et.lat,lt=V.lng-et.lng;if(ot===0&&lt===0)return r;var ft=r.getSouthWest(),pt=r.getNorthEast(),yt=new Ft(ft.lat-ot,ft.lng-lt),xt=new Ft(pt.lat-ot,pt.lng-lt);return new Yt(yt,xt)}},Jt=tt({},se,{wrapLng:[-180,180],R:6371e3,distance:function(r,V){var et=Math.PI/180,ot=r.lat*et,lt=V.lat*et,ft=Math.sin((V.lat-r.lat)*et/2),pt=Math.sin((V.lng-r.lng)*et/2),yt=ft*ft+Math.cos(ot)*Math.cos(lt)*pt*pt,xt=2*Math.atan2(Math.sqrt(yt),Math.sqrt(1-yt));return this.R*xt}}),be=6378137,me={R:be,MAX_LATITUDE:85.0511287798,project:function(r){var V=Math.PI/180,et=this.MAX_LATITUDE,ot=Math.max(Math.min(et,r.lat),-et),lt=Math.sin(ot*V);return new Et(this.R*r.lng*V,this.R*Math.log((1+lt)/(1-lt))/2)},unproject:function(r){var V=180/Math.PI;return new Ft((2*Math.atan(Math.exp(r.y/this.R))-Math.PI/2)*V,r.x*V/this.R)},bounds:function(){var r=be*Math.PI;return new Zt([-r,-r],[r,r])}()};function Qt(r,V,et,ot){if(Ot(r)){this._a=r[0],this._b=r[1],this._c=r[2],this._d=r[3];return}this._a=r,this._b=V,this._c=et,this._d=ot}Qt.prototype={transform:function(r,V){return this._transform(r.clone(),V)},_transform:function(r,V){return V=V||1,r.x=V*(this._a*r.x+this._b),r.y=V*(this._c*r.y+this._d),r},untransform:function(r,V){return V=V||1,new Et((r.x/V-this._b)/this._a,(r.y/V-this._d)/this._c)}};function _e(r,V,et,ot){return new Qt(r,V,et,ot)}var St=tt({},Jt,{code:"EPSG:3857",projection:me,transformation:function(){var r=.5/(Math.PI*me.R);return _e(r,.5,-r,.5)}()}),Dt=tt({},St,{code:"EPSG:900913"});function ee(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function Rt(r,V){var et="",ot,lt,ft,pt,yt,xt;for(ot=0,ft=r.length;ot<ft;ot++){for(yt=r[ot],lt=0,pt=yt.length;lt<pt;lt++)xt=yt[lt],et+=(lt?"L":"M")+xt.x+" "+xt.y;et+=V?Wt.svg?"z":"x":""}return et||"M0 0"}var ue=document.documentElement.style,Le="ActiveXObject"in window,En=Le&&!document.addEventListener,hn="msLaunchUri"in navigator&&!("documentMode"in document),Ke=ke("webkit"),Gt=ke("android"),Ae=ke("android 2")||ke("android 3"),ho=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),fo=Gt&&ke("Google")&&ho<537&&!("AudioNode"in window),An=!!window.opera,ai=!hn&&ke("chrome"),li=ke("gecko")&&!Ke&&!An&&!Le,_o=!ai&&ke("safari"),ui=ke("phantom"),ci="OTransition"in ue,po=navigator.platform.indexOf("Win")===0,hi=Le&&"transition"in ue,zn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ae,fi="MozPerspective"in ue,mo=!window.L_DISABLE_3D&&(hi||zn||fi)&&!ci&&!ui,Je=typeof orientation<"u"||ke("mobile"),go=Je&&Ke,vo=Je&&zn,di=!window.PointerEvent&&window.MSPointerEvent,_i=!!(window.PointerEvent||di),pi="ontouchstart"in window||!!window.TouchEvent,yo=!window.L_NO_TOUCH&&(pi||_i),bo=Je&&An,wo=Je&&li,xo=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Lo=function(){var r=!1;try{var V=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassiveEventSupport",ct,V),window.removeEventListener("testPassiveEventSupport",ct,V)}catch{}return r}(),ko=function(){return!!document.createElement("canvas").getContext}(),Nn=!!(document.createElementNS&&ee("svg").createSVGRect),So=!!Nn&&function(){var r=document.createElement("div");return r.innerHTML="<svg/>",(r.firstChild&&r.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Co=!Nn&&function(){try{var r=document.createElement("div");r.innerHTML='<v:shape adj="1"/>';var V=r.firstChild;return V.style.behavior="url(#default#VML)",V&&typeof V.adj=="object"}catch{return!1}}(),Po=navigator.platform.indexOf("Mac")===0,To=navigator.platform.indexOf("Linux")===0;function ke(r){return navigator.userAgent.toLowerCase().indexOf(r)>=0}var Wt={ie:Le,ielt9:En,edge:hn,webkit:Ke,android:Gt,android23:Ae,androidStock:fo,opera:An,chrome:ai,gecko:li,safari:_o,phantom:ui,opera12:ci,win:po,ie3d:hi,webkit3d:zn,gecko3d:fi,any3d:mo,mobile:Je,mobileWebkit:go,mobileWebkit3d:vo,msPointer:di,pointer:_i,touch:yo,touchNative:pi,mobileOpera:bo,mobileGecko:wo,retina:xo,passiveEvents:Lo,canvas:ko,svg:Nn,vml:Co,inlineSvg:So,mac:Po,linux:To},mi=Wt.msPointer?"MSPointerDown":"pointerdown",gi=Wt.msPointer?"MSPointerMove":"pointermove",vi=Wt.msPointer?"MSPointerUp":"pointerup",yi=Wt.msPointer?"MSPointerCancel":"pointercancel",On={touchstart:mi,touchmove:gi,touchend:vi,touchcancel:yi},bi={touchstart:No,touchmove:fn,touchend:fn,touchcancel:fn},Ge={},wi=!1;function Mo(r,V,et){return V==="touchstart"&&zo(),bi[V]?(et=bi[V].bind(this,et),r.addEventListener(On[V],et,!1),et):(console.warn("wrong event specified:",V),ct)}function Io(r,V,et){if(!On[V]){console.warn("wrong event specified:",V);return}r.removeEventListener(On[V],et,!1)}function Eo(r){Ge[r.pointerId]=r}function Ao(r){Ge[r.pointerId]&&(Ge[r.pointerId]=r)}function xi(r){delete Ge[r.pointerId]}function zo(){wi||(document.addEventListener(mi,Eo,!0),document.addEventListener(gi,Ao,!0),document.addEventListener(vi,xi,!0),document.addEventListener(yi,xi,!0),wi=!0)}function fn(r,V){if(V.pointerType!==(V.MSPOINTER_TYPE_MOUSE||"mouse")){V.touches=[];for(var et in Ge)V.touches.push(Ge[et]);V.changedTouches=[V],r(V)}}function No(r,V){V.MSPOINTER_TYPE_TOUCH&&V.pointerType===V.MSPOINTER_TYPE_TOUCH&&pe(V),fn(r,V)}function Oo(r){var V={},et,ot;for(ot in r)et=r[ot],V[ot]=et&&et.bind?et.bind(r):et;return r=V,V.type="dblclick",V.detail=2,V.isTrusted=!1,V._simulated=!0,V}var Bo=200;function Ro(r,V){r.addEventListener("dblclick",V);var et=0,ot;function lt(ft){if(ft.detail!==1){ot=ft.detail;return}if(!(ft.pointerType==="mouse"||ft.sourceCapabilities&&!ft.sourceCapabilities.firesTouchEvents)){var pt=Pi(ft);if(!(pt.some(function(xt){return xt instanceof HTMLLabelElement&&xt.attributes.for})&&!pt.some(function(xt){return xt instanceof HTMLInputElement||xt instanceof HTMLSelectElement}))){var yt=Date.now();yt-et<=Bo?(ot++,ot===2&&V(Oo(ft))):ot=1,et=yt}}}return r.addEventListener("click",lt),{dblclick:V,simDblclick:lt}}function Zo(r,V){r.removeEventListener("dblclick",V.dblclick),r.removeEventListener("click",V.simDblclick)}var Bn=pn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Qe=pn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Li=Qe==="webkitTransition"||Qe==="OTransition"?Qe+"End":"transitionend";function ki(r){return typeof r=="string"?document.getElementById(r):r}function $e(r,V){var et=r.style[V]||r.currentStyle&&r.currentStyle[V];if((!et||et==="auto")&&document.defaultView){var ot=document.defaultView.getComputedStyle(r,null);et=ot?ot[V]:null}return et==="auto"?null:et}function ae(r,V,et){var ot=document.createElement(r);return ot.className=V||"",et&&et.appendChild(ot),ot}function ce(r){var V=r.parentNode;V&&V.removeChild(r)}function dn(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function Ue(r){var V=r.parentNode;V&&V.lastChild!==r&&V.appendChild(r)}function qe(r){var V=r.parentNode;V&&V.firstChild!==r&&V.insertBefore(r,V.firstChild)}function Rn(r,V){if(r.classList!==void 0)return r.classList.contains(V);var et=_n(r);return et.length>0&&new RegExp("(^|\\s)"+V+"(\\s|$)").test(et)}function ne(r,V){if(r.classList!==void 0)for(var et=dt(V),ot=0,lt=et.length;ot<lt;ot++)r.classList.add(et[ot]);else if(!Rn(r,V)){var ft=_n(r);Zn(r,(ft?ft+" ":"")+V)}}function he(r,V){r.classList!==void 0?r.classList.remove(V):Zn(r,ut((" "+_n(r)+" ").replace(" "+V+" "," ")))}function Zn(r,V){r.className.baseVal===void 0?r.className=V:r.className.baseVal=V}function _n(r){return r.correspondingElement&&(r=r.correspondingElement),r.className.baseVal===void 0?r.className:r.className.baseVal}function ge(r,V){"opacity"in r.style?r.style.opacity=V:"filter"in r.style&&Do(r,V)}function Do(r,V){var et=!1,ot="DXImageTransform.Microsoft.Alpha";try{et=r.filters.item(ot)}catch{if(V===1)return}V=Math.round(V*100),et?(et.Enabled=V!==100,et.Opacity=V):r.style.filter+=" progid:"+ot+"(opacity="+V+")"}function pn(r){for(var V=document.documentElement.style,et=0;et<r.length;et++)if(r[et]in V)return r[et];return!1}function Be(r,V,et){var ot=V||new Et(0,0);r.style[Bn]=(Wt.ie3d?"translate("+ot.x+"px,"+ot.y+"px)":"translate3d("+ot.x+"px,"+ot.y+"px,0)")+(et?" scale("+et+")":"")}function fe(r,V){r._leaflet_pos=V,Wt.any3d?Be(r,V):(r.style.left=V.x+"px",r.style.top=V.y+"px")}function Re(r){return r._leaflet_pos||new Et(0,0)}var tn,en,Dn;if("onselectstart"in document)tn=function(){$t(window,"selectstart",pe)},en=function(){le(window,"selectstart",pe)};else{var nn=pn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);tn=function(){if(nn){var r=document.documentElement.style;Dn=r[nn],r[nn]="none"}},en=function(){nn&&(document.documentElement.style[nn]=Dn,Dn=void 0)}}function Fn(){$t(window,"dragstart",pe)}function Hn(){le(window,"dragstart",pe)}var mn,Gn;function Un(r){for(;r.tabIndex===-1;)r=r.parentNode;r.style&&(gn(),mn=r,Gn=r.style.outline,r.style.outline="none",$t(window,"keydown",gn))}function gn(){mn&&(mn.style.outline=Gn,mn=void 0,Gn=void 0,le(window,"keydown",gn))}function Si(r){do r=r.parentNode;while((!r.offsetWidth||!r.offsetHeight)&&r!==document.body);return r}function qn(r){var V=r.getBoundingClientRect();return{x:V.width/r.offsetWidth||1,y:V.height/r.offsetHeight||1,boundingClientRect:V}}var Fo={__proto__:null,TRANSFORM:Bn,TRANSITION:Qe,TRANSITION_END:Li,get:ki,getStyle:$e,create:ae,remove:ce,empty:dn,toFront:Ue,toBack:qe,hasClass:Rn,addClass:ne,removeClass:he,setClass:Zn,getClass:_n,setOpacity:ge,testProp:pn,setTransform:Be,setPosition:fe,getPosition:Re,get disableTextSelection(){return tn},get enableTextSelection(){return en},disableImageDrag:Fn,enableImageDrag:Hn,preventOutline:Un,restoreOutline:gn,getSizedParentNode:Si,getScale:qn};function $t(r,V,et,ot){if(V&&typeof V=="object")for(var lt in V)Vn(r,lt,V[lt],et);else{V=dt(V);for(var ft=0,pt=V.length;ft<pt;ft++)Vn(r,V[ft],et,ot)}return this}var Se="_leaflet_events";function le(r,V,et,ot){if(arguments.length===1)Ci(r),delete r[Se];else if(V&&typeof V=="object")for(var lt in V)Xn(r,lt,V[lt],et);else if(V=dt(V),arguments.length===2)Ci(r,function(yt){return Lt(V,yt)!==-1});else for(var ft=0,pt=V.length;ft<pt;ft++)Xn(r,V[ft],et,ot);return this}function Ci(r,V){for(var et in r[Se]){var ot=et.split(/\d/)[0];(!V||V(ot))&&Xn(r,ot,null,null,et)}}var Wn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Vn(r,V,et,ot){var lt=V+rt(et)+(ot?"_"+rt(ot):"");if(r[Se]&&r[Se][lt])return this;var ft=function(yt){return et.call(ot||r,yt||window.event)},pt=ft;!Wt.touchNative&&Wt.pointer&&V.indexOf("touch")===0?ft=Mo(r,V,ft):Wt.touch&&V==="dblclick"?ft=Ro(r,ft):"addEventListener"in r?V==="touchstart"||V==="touchmove"||V==="wheel"||V==="mousewheel"?r.addEventListener(Wn[V]||V,ft,Wt.passiveEvents?{passive:!1}:!1):V==="mouseenter"||V==="mouseleave"?(ft=function(yt){yt=yt||window.event,jn(r,yt)&&pt(yt)},r.addEventListener(Wn[V],ft,!1)):r.addEventListener(V,pt,!1):r.attachEvent("on"+V,ft),r[Se]=r[Se]||{},r[Se][lt]=ft}function Xn(r,V,et,ot,lt){lt=lt||V+rt(et)+(ot?"_"+rt(ot):"");var ft=r[Se]&&r[Se][lt];if(!ft)return this;!Wt.touchNative&&Wt.pointer&&V.indexOf("touch")===0?Io(r,V,ft):Wt.touch&&V==="dblclick"?Zo(r,ft):"removeEventListener"in r?r.removeEventListener(Wn[V]||V,ft,!1):r.detachEvent("on"+V,ft),r[Se][lt]=null}function Ze(r){return r.stopPropagation?r.stopPropagation():r.originalEvent?r.originalEvent._stopped=!0:r.cancelBubble=!0,this}function Yn(r){return Vn(r,"wheel",Ze),this}function on(r){return $t(r,"mousedown touchstart dblclick contextmenu",Ze),r._leaflet_disable_click=!0,this}function pe(r){return r.preventDefault?r.preventDefault():r.returnValue=!1,this}function De(r){return pe(r),Ze(r),this}function Pi(r){if(r.composedPath)return r.composedPath();for(var V=[],et=r.target;et;)V.push(et),et=et.parentNode;return V}function Ti(r,V){if(!V)return new Et(r.clientX,r.clientY);var et=qn(V),ot=et.boundingClientRect;return new Et((r.clientX-ot.left)/et.x-V.clientLeft,(r.clientY-ot.top)/et.y-V.clientTop)}var Ho=Wt.linux&&Wt.chrome?window.devicePixelRatio:Wt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Mi(r){return Wt.edge?r.wheelDeltaY/2:r.deltaY&&r.deltaMode===0?-r.deltaY/Ho:r.deltaY&&r.deltaMode===1?-r.deltaY*20:r.deltaY&&r.deltaMode===2?-r.deltaY*60:r.deltaX||r.deltaZ?0:r.wheelDelta?(r.wheelDeltaY||r.wheelDelta)/2:r.detail&&Math.abs(r.detail)<32765?-r.detail*20:r.detail?r.detail/-32765*60:0}function jn(r,V){var et=V.relatedTarget;if(!et)return!0;try{for(;et&&et!==r;)et=et.parentNode}catch{return!1}return et!==r}var Go={__proto__:null,on:$t,off:le,stopPropagation:Ze,disableScrollPropagation:Yn,disableClickPropagation:on,preventDefault:pe,stop:De,getPropagationPath:Pi,getMousePosition:Ti,getWheelDelta:Mi,isExternalTarget:jn,addListener:$t,removeListener:le},Ii=At.extend({run:function(r,V,et,ot){this.stop(),this._el=r,this._inProgress=!0,this._duration=et||.25,this._easeOutPower=1/Math.max(ot||.5,.2),this._startPos=Re(r),this._offset=V.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Vt(this._animate,this),this._step()},_step:function(r){var V=+new Date-this._startTime,et=this._duration*1e3;V<et?this._runFrame(this._easeOut(V/et),r):(this._runFrame(1),this._complete())},_runFrame:function(r,V){var et=this._startPos.add(this._offset.multiplyBy(r));V&&et._round(),fe(this._el,et),this.fire("step")},_complete:function(){Ut(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(r){return 1-Math.pow(1-r,this._easeOutPower)}}),re=At.extend({options:{crs:St,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(r,V){V=_t(this,V),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(r),this._initLayout(),this._onResize=nt(this._onResize,this),this._initEvents(),V.maxBounds&&this.setMaxBounds(V.maxBounds),V.zoom!==void 0&&(this._zoom=this._limitZoom(V.zoom)),V.center&&V.zoom!==void 0&&this.setView(te(V.center),V.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Qe&&Wt.any3d&&!Wt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),$t(this._proxy,Li,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(r,V,et){if(V=V===void 0?this._zoom:this._limitZoom(V),r=this._limitCenter(te(r),V,this.options.maxBounds),et=et||{},this._stop(),this._loaded&&!et.reset&&et!==!0){et.animate!==void 0&&(et.zoom=tt({animate:et.animate},et.zoom),et.pan=tt({animate:et.animate,duration:et.duration},et.pan));var ot=this._zoom!==V?this._tryAnimatedZoom&&this._tryAnimatedZoom(r,V,et.zoom):this._tryAnimatedPan(r,et.pan);if(ot)return clearTimeout(this._sizeTimer),this}return this._resetView(r,V,et.pan&&et.pan.noMoveStart),this},setZoom:function(r,V){return this._loaded?this.setView(this.getCenter(),r,{zoom:V}):(this._zoom=r,this)},zoomIn:function(r,V){return r=r||(Wt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+r,V)},zoomOut:function(r,V){return r=r||(Wt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-r,V)},setZoomAround:function(r,V,et){var ot=this.getZoomScale(V),lt=this.getSize().divideBy(2),ft=r instanceof Et?r:this.latLngToContainerPoint(r),pt=ft.subtract(lt).multiplyBy(1-1/ot),yt=this.containerPointToLatLng(lt.add(pt));return this.setView(yt,V,{zoom:et})},_getBoundsCenterZoom:function(r,V){V=V||{},r=r.getBounds?r.getBounds():qt(r);var et=Mt(V.paddingTopLeft||V.padding||[0,0]),ot=Mt(V.paddingBottomRight||V.padding||[0,0]),lt=this.getBoundsZoom(r,!1,et.add(ot));if(lt=typeof V.maxZoom=="number"?Math.min(V.maxZoom,lt):lt,lt===1/0)return{center:r.getCenter(),zoom:lt};var ft=ot.subtract(et).divideBy(2),pt=this.project(r.getSouthWest(),lt),yt=this.project(r.getNorthEast(),lt),xt=this.unproject(pt.add(yt).divideBy(2).add(ft),lt);return{center:xt,zoom:lt}},fitBounds:function(r,V){if(r=qt(r),!r.isValid())throw new Error("Bounds are not valid.");var et=this._getBoundsCenterZoom(r,V);return this.setView(et.center,et.zoom,V)},fitWorld:function(r){return this.fitBounds([[-90,-180],[90,180]],r)},panTo:function(r,V){return this.setView(r,this._zoom,{pan:V})},panBy:function(r,V){if(r=Mt(r).round(),V=V||{},!r.x&&!r.y)return this.fire("moveend");if(V.animate!==!0&&!this.getSize().contains(r))return this._resetView(this.unproject(this.project(this.getCenter()).add(r)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ii,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),V.noMoveStart||this.fire("movestart"),V.animate!==!1){ne(this._mapPane,"leaflet-pan-anim");var et=this._getMapPanePos().subtract(r).round();this._panAnim.run(this._mapPane,et,V.duration||.25,V.easeLinearity)}else this._rawPanBy(r),this.fire("move").fire("moveend");return this},flyTo:function(r,V,et){if(et=et||{},et.animate===!1||!Wt.any3d)return this.setView(r,V,et);this._stop();var ot=this.project(this.getCenter()),lt=this.project(r),ft=this.getSize(),pt=this._zoom;r=te(r),V=V===void 0?pt:V;var yt=Math.max(ft.x,ft.y),xt=yt*this.getZoomScale(pt,V),Nt=lt.distanceTo(ot)||1,Ht=1.42,Kt=Ht*Ht;function ie(de){var In=de?-1:1,Ir=de?xt:yt,Er=xt*xt-yt*yt+In*Kt*Kt*Nt*Nt,Ar=2*Ir*Kt*Nt,si=Er/Ar,co=Math.sqrt(si*si+1)-si,zr=co<1e-9?-18:Math.log(co);return zr}function ye(de){return(Math.exp(de)-Math.exp(-de))/2}function He(de){return(Math.exp(de)+Math.exp(-de))/2}function Mn(de){return ye(de)/He(de)}var Oe=ie(0);function ri(de){return yt*(He(Oe)/He(Oe+Ht*de))}function Cr(de){return yt*(He(Oe)*Mn(Oe+Ht*de)-ye(Oe))/Kt}function Pr(de){return 1-Math.pow(1-de,1.5)}var Tr=Date.now(),lo=(ie(1)-Oe)/Ht,Mr=et.duration?1e3*et.duration:1e3*lo*.8;function uo(){var de=(Date.now()-Tr)/Mr,In=Pr(de)*lo;de<=1?(this._flyToFrame=Vt(uo,this),this._move(this.unproject(ot.add(lt.subtract(ot).multiplyBy(Cr(In)/Nt)),pt),this.getScaleZoom(yt/ri(In),pt),{flyTo:!0})):this._move(r,V)._moveEnd(!0)}return this._moveStart(!0,et.noMoveStart),uo.call(this),this},flyToBounds:function(r,V){var et=this._getBoundsCenterZoom(r,V);return this.flyTo(et.center,et.zoom,V)},setMaxBounds:function(r){return r=qt(r),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),r.isValid()?(this.options.maxBounds=r,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(r){var V=this.options.minZoom;return this.options.minZoom=r,this._loaded&&V!==r&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(r):this},setMaxZoom:function(r){var V=this.options.maxZoom;return this.options.maxZoom=r,this._loaded&&V!==r&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(r):this},panInsideBounds:function(r,V){this._enforcingBounds=!0;var et=this.getCenter(),ot=this._limitCenter(et,this._zoom,qt(r));return et.equals(ot)||this.panTo(ot,V),this._enforcingBounds=!1,this},panInside:function(r,V){V=V||{};var et=Mt(V.paddingTopLeft||V.padding||[0,0]),ot=Mt(V.paddingBottomRight||V.padding||[0,0]),lt=this.project(this.getCenter()),ft=this.project(r),pt=this.getPixelBounds(),yt=Xt([pt.min.add(et),pt.max.subtract(ot)]),xt=yt.getSize();if(!yt.contains(ft)){this._enforcingBounds=!0;var Nt=ft.subtract(yt.getCenter()),Ht=yt.extend(ft).getSize().subtract(xt);lt.x+=Nt.x<0?-Ht.x:Ht.x,lt.y+=Nt.y<0?-Ht.y:Ht.y,this.panTo(this.unproject(lt),V),this._enforcingBounds=!1}return this},invalidateSize:function(r){if(!this._loaded)return this;r=tt({animate:!1,pan:!0},r===!0?{animate:!0}:r);var V=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var et=this.getSize(),ot=V.divideBy(2).round(),lt=et.divideBy(2).round(),ft=ot.subtract(lt);return!ft.x&&!ft.y?this:(r.animate&&r.pan?this.panBy(ft):(r.pan&&this._rawPanBy(ft),this.fire("move"),r.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(nt(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:V,newSize:et}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(r){if(r=this._locateOptions=tt({timeout:1e4,watch:!1},r),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var V=nt(this._handleGeolocationResponse,this),et=nt(this._handleGeolocationError,this);return r.watch?this._locationWatchId=navigator.geolocation.watchPosition(V,et,r):navigator.geolocation.getCurrentPosition(V,et,r),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(r){if(this._container._leaflet_id){var V=r.code,et=r.message||(V===1?"permission denied":V===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:V,message:"Geolocation error: "+et+"."})}},_handleGeolocationResponse:function(r){if(this._container._leaflet_id){var V=r.coords.latitude,et=r.coords.longitude,ot=new Ft(V,et),lt=ot.toBounds(r.coords.accuracy*2),ft=this._locateOptions;if(ft.setView){var pt=this.getBoundsZoom(lt);this.setView(ot,ft.maxZoom?Math.min(pt,ft.maxZoom):pt)}var yt={latlng:ot,bounds:lt,timestamp:r.timestamp};for(var xt in r.coords)typeof r.coords[xt]=="number"&&(yt[xt]=r.coords[xt]);this.fire("locationfound",yt)}},addHandler:function(r,V){if(!V)return this;var et=this[r]=new V(this);return this._handlers.push(et),this.options[r]&&et.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ce(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Ut(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var r;for(r in this._layers)this._layers[r].remove();for(r in this._panes)ce(this._panes[r]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(r,V){var et="leaflet-pane"+(r?" leaflet-"+r.replace("Pane","")+"-pane":""),ot=ae("div",et,V||this._mapPane);return r&&(this._panes[r]=ot),ot},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var r=this.getPixelBounds(),V=this.unproject(r.getBottomLeft()),et=this.unproject(r.getTopRight());return new Yt(V,et)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(r,V,et){r=qt(r),et=Mt(et||[0,0]);var ot=this.getZoom()||0,lt=this.getMinZoom(),ft=this.getMaxZoom(),pt=r.getNorthWest(),yt=r.getSouthEast(),xt=this.getSize().subtract(et),Nt=Xt(this.project(yt,ot),this.project(pt,ot)).getSize(),Ht=Wt.any3d?this.options.zoomSnap:1,Kt=xt.x/Nt.x,ie=xt.y/Nt.y,ye=V?Math.max(Kt,ie):Math.min(Kt,ie);return ot=this.getScaleZoom(ye,ot),Ht&&(ot=Math.round(ot/(Ht/100))*(Ht/100),ot=V?Math.ceil(ot/Ht)*Ht:Math.floor(ot/Ht)*Ht),Math.max(lt,Math.min(ft,ot))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Et(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(r,V){var et=this._getTopLeftPoint(r,V);return new Zt(et,et.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(r){return this.options.crs.getProjectedBounds(r===void 0?this.getZoom():r)},getPane:function(r){return typeof r=="string"?this._panes[r]:r},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(r,V){var et=this.options.crs;return V=V===void 0?this._zoom:V,et.scale(r)/et.scale(V)},getScaleZoom:function(r,V){var et=this.options.crs;V=V===void 0?this._zoom:V;var ot=et.zoom(r*et.scale(V));return isNaN(ot)?1/0:ot},project:function(r,V){return V=V===void 0?this._zoom:V,this.options.crs.latLngToPoint(te(r),V)},unproject:function(r,V){return V=V===void 0?this._zoom:V,this.options.crs.pointToLatLng(Mt(r),V)},layerPointToLatLng:function(r){var V=Mt(r).add(this.getPixelOrigin());return this.unproject(V)},latLngToLayerPoint:function(r){var V=this.project(te(r))._round();return V._subtract(this.getPixelOrigin())},wrapLatLng:function(r){return this.options.crs.wrapLatLng(te(r))},wrapLatLngBounds:function(r){return this.options.crs.wrapLatLngBounds(qt(r))},distance:function(r,V){return this.options.crs.distance(te(r),te(V))},containerPointToLayerPoint:function(r){return Mt(r).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(r){return Mt(r).add(this._getMapPanePos())},containerPointToLatLng:function(r){var V=this.containerPointToLayerPoint(Mt(r));return this.layerPointToLatLng(V)},latLngToContainerPoint:function(r){return this.layerPointToContainerPoint(this.latLngToLayerPoint(te(r)))},mouseEventToContainerPoint:function(r){return Ti(r,this._container)},mouseEventToLayerPoint:function(r){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(r))},mouseEventToLatLng:function(r){return this.layerPointToLatLng(this.mouseEventToLayerPoint(r))},_initContainer:function(r){var V=this._container=ki(r);if(V){if(V._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");$t(V,"scroll",this._onScroll,this),this._containerId=rt(V)},_initLayout:function(){var r=this._container;this._fadeAnimated=this.options.fadeAnimation&&Wt.any3d,ne(r,"leaflet-container"+(Wt.touch?" leaflet-touch":"")+(Wt.retina?" leaflet-retina":"")+(Wt.ielt9?" leaflet-oldie":"")+(Wt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var V=$e(r,"position");V!=="absolute"&&V!=="relative"&&V!=="fixed"&&V!=="sticky"&&(r.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var r=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),fe(this._mapPane,new Et(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ne(r.markerPane,"leaflet-zoom-hide"),ne(r.shadowPane,"leaflet-zoom-hide"))},_resetView:function(r,V,et){fe(this._mapPane,new Et(0,0));var ot=!this._loaded;this._loaded=!0,V=this._limitZoom(V),this.fire("viewprereset");var lt=this._zoom!==V;this._moveStart(lt,et)._move(r,V)._moveEnd(lt),this.fire("viewreset"),ot&&this.fire("load")},_moveStart:function(r,V){return r&&this.fire("zoomstart"),V||this.fire("movestart"),this},_move:function(r,V,et,ot){V===void 0&&(V=this._zoom);var lt=this._zoom!==V;return this._zoom=V,this._lastCenter=r,this._pixelOrigin=this._getNewPixelOrigin(r),ot?et&&et.pinch&&this.fire("zoom",et):((lt||et&&et.pinch)&&this.fire("zoom",et),this.fire("move",et)),this},_moveEnd:function(r){return r&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Ut(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(r){fe(this._mapPane,this._getMapPanePos().subtract(r))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(r){this._targets={},this._targets[rt(this._container)]=this;var V=r?le:$t;V(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&V(window,"resize",this._onResize,this),Wt.any3d&&this.options.transform3DLimit&&(r?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Ut(this._resizeRequest),this._resizeRequest=Vt(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var r=this._getMapPanePos();Math.max(Math.abs(r.x),Math.abs(r.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(r,V){for(var et=[],ot,lt=V==="mouseout"||V==="mouseover",ft=r.target||r.srcElement,pt=!1;ft;){if(ot=this._targets[rt(ft)],ot&&(V==="click"||V==="preclick")&&this._draggableMoved(ot)){pt=!0;break}if(ot&&ot.listens(V,!0)&&(lt&&!jn(ft,r)||(et.push(ot),lt))||ft===this._container)break;ft=ft.parentNode}return!et.length&&!pt&&!lt&&this.listens(V,!0)&&(et=[this]),et},_isClickDisabled:function(r){for(;r&&r!==this._container;){if(r._leaflet_disable_click)return!0;r=r.parentNode}},_handleDOMEvent:function(r){var V=r.target||r.srcElement;if(!(!this._loaded||V._leaflet_disable_events||r.type==="click"&&this._isClickDisabled(V))){var et=r.type;et==="mousedown"&&Un(V),this._fireDOMEvent(r,et)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(r,V,et){if(r.type==="click"){var ot=tt({},r);ot.type="preclick",this._fireDOMEvent(ot,ot.type,et)}var lt=this._findEventTargets(r,V);if(et){for(var ft=[],pt=0;pt<et.length;pt++)et[pt].listens(V,!0)&&ft.push(et[pt]);lt=ft.concat(lt)}if(lt.length){V==="contextmenu"&&pe(r);var yt=lt[0],xt={originalEvent:r};if(r.type!=="keypress"&&r.type!=="keydown"&&r.type!=="keyup"){var Nt=yt.getLatLng&&(!yt._radius||yt._radius<=10);xt.containerPoint=Nt?this.latLngToContainerPoint(yt.getLatLng()):this.mouseEventToContainerPoint(r),xt.layerPoint=this.containerPointToLayerPoint(xt.containerPoint),xt.latlng=Nt?yt.getLatLng():this.layerPointToLatLng(xt.layerPoint)}for(pt=0;pt<lt.length;pt++)if(lt[pt].fire(V,xt,!0),xt.originalEvent._stopped||lt[pt].options.bubblingMouseEvents===!1&&Lt(this._mouseEvents,V)!==-1)return}},_draggableMoved:function(r){return r=r.dragging&&r.dragging.enabled()?r:this,r.dragging&&r.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var r=0,V=this._handlers.length;r<V;r++)this._handlers[r].disable()},whenReady:function(r,V){return this._loaded?r.call(V||this,{target:this}):this.on("load",r,V),this},_getMapPanePos:function(){return Re(this._mapPane)||new Et(0,0)},_moved:function(){var r=this._getMapPanePos();return r&&!r.equals([0,0])},_getTopLeftPoint:function(r,V){var et=r&&V!==void 0?this._getNewPixelOrigin(r,V):this.getPixelOrigin();return et.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(r,V){var et=this.getSize()._divideBy(2);return this.project(r,V)._subtract(et)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(r,V,et){var ot=this._getNewPixelOrigin(et,V);return this.project(r,V)._subtract(ot)},_latLngBoundsToNewLayerBounds:function(r,V,et){var ot=this._getNewPixelOrigin(et,V);return Xt([this.project(r.getSouthWest(),V)._subtract(ot),this.project(r.getNorthWest(),V)._subtract(ot),this.project(r.getSouthEast(),V)._subtract(ot),this.project(r.getNorthEast(),V)._subtract(ot)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(r){return this.latLngToLayerPoint(r).subtract(this._getCenterLayerPoint())},_limitCenter:function(r,V,et){if(!et)return r;var ot=this.project(r,V),lt=this.getSize().divideBy(2),ft=new Zt(ot.subtract(lt),ot.add(lt)),pt=this._getBoundsOffset(ft,et,V);return Math.abs(pt.x)<=1&&Math.abs(pt.y)<=1?r:this.unproject(ot.add(pt),V)},_limitOffset:function(r,V){if(!V)return r;var et=this.getPixelBounds(),ot=new Zt(et.min.add(r),et.max.add(r));return r.add(this._getBoundsOffset(ot,V))},_getBoundsOffset:function(r,V,et){var ot=Xt(this.project(V.getNorthEast(),et),this.project(V.getSouthWest(),et)),lt=ot.min.subtract(r.min),ft=ot.max.subtract(r.max),pt=this._rebound(lt.x,-ft.x),yt=this._rebound(lt.y,-ft.y);return new Et(pt,yt)},_rebound:function(r,V){return r+V>0?Math.round(r-V)/2:Math.max(0,Math.ceil(r))-Math.max(0,Math.floor(V))},_limitZoom:function(r){var V=this.getMinZoom(),et=this.getMaxZoom(),ot=Wt.any3d?this.options.zoomSnap:1;return ot&&(r=Math.round(r/ot)*ot),Math.max(V,Math.min(et,r))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){he(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(r,V){var et=this._getCenterOffset(r)._trunc();return(V&&V.animate)!==!0&&!this.getSize().contains(et)?!1:(this.panBy(et,V),!0)},_createAnimProxy:function(){var r=this._proxy=ae("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(r),this.on("zoomanim",function(V){var et=Bn,ot=this._proxy.style[et];Be(this._proxy,this.project(V.center,V.zoom),this.getZoomScale(V.zoom,1)),ot===this._proxy.style[et]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ce(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var r=this.getCenter(),V=this.getZoom();Be(this._proxy,this.project(r,V),this.getZoomScale(V,1))},_catchTransitionEnd:function(r){this._animatingZoom&&r.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(r,V,et){if(this._animatingZoom)return!0;if(et=et||{},!this._zoomAnimated||et.animate===!1||this._nothingToAnimate()||Math.abs(V-this._zoom)>this.options.zoomAnimationThreshold)return!1;var ot=this.getZoomScale(V),lt=this._getCenterOffset(r)._divideBy(1-1/ot);return et.animate!==!0&&!this.getSize().contains(lt)?!1:(Vt(function(){this._moveStart(!0,!1)._animateZoom(r,V,!0)},this),!0)},_animateZoom:function(r,V,et,ot){this._mapPane&&(et&&(this._animatingZoom=!0,this._animateToCenter=r,this._animateToZoom=V,ne(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:r,zoom:V,noUpdate:ot}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(nt(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&he(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Uo(r,V){return new re(r,V)}var we=mt.extend({options:{position:"topright"},initialize:function(r){_t(this,r)},getPosition:function(){return this.options.position},setPosition:function(r){var V=this._map;return V&&V.removeControl(this),this.options.position=r,V&&V.addControl(this),this},getContainer:function(){return this._container},addTo:function(r){this.remove(),this._map=r;var V=this._container=this.onAdd(r),et=this.getPosition(),ot=r._controlCorners[et];return ne(V,"leaflet-control"),et.indexOf("bottom")!==-1?ot.insertBefore(V,ot.firstChild):ot.appendChild(V),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ce(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(r){this._map&&r&&r.screenX>0&&r.screenY>0&&this._map.getContainer().focus()}}),rn=function(r){return new we(r)};re.include({addControl:function(r){return r.addTo(this),this},removeControl:function(r){return r.remove(),this},_initControlPos:function(){var r=this._controlCorners={},V="leaflet-",et=this._controlContainer=ae("div",V+"control-container",this._container);function ot(lt,ft){var pt=V+lt+" "+V+ft;r[lt+ft]=ae("div",pt,et)}ot("top","left"),ot("top","right"),ot("bottom","left"),ot("bottom","right")},_clearControlPos:function(){for(var r in this._controlCorners)ce(this._controlCorners[r]);ce(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ei=we.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(r,V,et,ot){return et<ot?-1:ot<et?1:0}},initialize:function(r,V,et){_t(this,et),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var ot in r)this._addLayer(r[ot],ot);for(ot in V)this._addLayer(V[ot],ot,!0)},onAdd:function(r){this._initLayout(),this._update(),this._map=r,r.on("zoomend",this._checkDisabledLayers,this);for(var V=0;V<this._layers.length;V++)this._layers[V].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(r){return we.prototype.addTo.call(this,r),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(r,V){return this._addLayer(r,V),this._map?this._update():this},addOverlay:function(r,V){return this._addLayer(r,V,!0),this._map?this._update():this},removeLayer:function(r){r.off("add remove",this._onLayerChange,this);var V=this._getLayer(rt(r));return V&&this._layers.splice(this._layers.indexOf(V),1),this._map?this._update():this},expand:function(){ne(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var r=this._map.getSize().y-(this._container.offsetTop+50);return r<this._section.clientHeight?(ne(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=r+"px"):he(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return he(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var r="leaflet-control-layers",V=this._container=ae("div",r),et=this.options.collapsed;V.setAttribute("aria-haspopup",!0),on(V),Yn(V);var ot=this._section=ae("section",r+"-list");et&&(this._map.on("click",this.collapse,this),$t(V,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var lt=this._layersLink=ae("a",r+"-toggle",V);lt.href="#",lt.title="Layers",lt.setAttribute("role","button"),$t(lt,{keydown:function(ft){ft.keyCode===13&&this._expandSafely()},click:function(ft){pe(ft),this._expandSafely()}},this),et||this.expand(),this._baseLayersList=ae("div",r+"-base",ot),this._separator=ae("div",r+"-separator",ot),this._overlaysList=ae("div",r+"-overlays",ot),V.appendChild(ot)},_getLayer:function(r){for(var V=0;V<this._layers.length;V++)if(this._layers[V]&&rt(this._layers[V].layer)===r)return this._layers[V]},_addLayer:function(r,V,et){this._map&&r.on("add remove",this._onLayerChange,this),this._layers.push({layer:r,name:V,overlay:et}),this.options.sortLayers&&this._layers.sort(nt(function(ot,lt){return this.options.sortFunction(ot.layer,lt.layer,ot.name,lt.name)},this)),this.options.autoZIndex&&r.setZIndex&&(this._lastZIndex++,r.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;dn(this._baseLayersList),dn(this._overlaysList),this._layerControlInputs=[];var r,V,et,ot,lt=0;for(et=0;et<this._layers.length;et++)ot=this._layers[et],this._addItem(ot),V=V||ot.overlay,r=r||!ot.overlay,lt+=ot.overlay?0:1;return this.options.hideSingleBase&&(r=r&&lt>1,this._baseLayersList.style.display=r?"":"none"),this._separator.style.display=V&&r?"":"none",this},_onLayerChange:function(r){this._handlingClick||this._update();var V=this._getLayer(rt(r.target)),et=V.overlay?r.type==="add"?"overlayadd":"overlayremove":r.type==="add"?"baselayerchange":null;et&&this._map.fire(et,V)},_createRadioElement:function(r,V){var et='<input type="radio" class="leaflet-control-layers-selector" name="'+r+'"'+(V?' checked="checked"':"")+"/>",ot=document.createElement("div");return ot.innerHTML=et,ot.firstChild},_addItem:function(r){var V=document.createElement("label"),et=this._map.hasLayer(r.layer),ot;r.overlay?(ot=document.createElement("input"),ot.type="checkbox",ot.className="leaflet-control-layers-selector",ot.defaultChecked=et):ot=this._createRadioElement("leaflet-base-layers_"+rt(this),et),this._layerControlInputs.push(ot),ot.layerId=rt(r.layer),$t(ot,"click",this._onInputClick,this);var lt=document.createElement("span");lt.innerHTML=" "+r.name;var ft=document.createElement("span");V.appendChild(ft),ft.appendChild(ot),ft.appendChild(lt);var pt=r.overlay?this._overlaysList:this._baseLayersList;return pt.appendChild(V),this._checkDisabledLayers(),V},_onInputClick:function(){var r=this._layerControlInputs,V,et,ot=[],lt=[];this._handlingClick=!0;for(var ft=r.length-1;ft>=0;ft--)V=r[ft],et=this._getLayer(V.layerId).layer,V.checked?ot.push(et):V.checked||lt.push(et);for(ft=0;ft<lt.length;ft++)this._map.hasLayer(lt[ft])&&this._map.removeLayer(lt[ft]);for(ft=0;ft<ot.length;ft++)this._map.hasLayer(ot[ft])||this._map.addLayer(ot[ft]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var r=this._layerControlInputs,V,et,ot=this._map.getZoom(),lt=r.length-1;lt>=0;lt--)V=r[lt],et=this._getLayer(V.layerId).layer,V.disabled=et.options.minZoom!==void 0&&ot<et.options.minZoom||et.options.maxZoom!==void 0&&ot>et.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var r=this._section;$t(r,"click",pe),this.expand(),setTimeout(function(){le(r,"click",pe)})}}),qo=function(r,V,et){return new Ei(r,V,et)},Kn=we.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(r){var V="leaflet-control-zoom",et=ae("div",V+" leaflet-bar"),ot=this.options;return this._zoomInButton=this._createButton(ot.zoomInText,ot.zoomInTitle,V+"-in",et,this._zoomIn),this._zoomOutButton=this._createButton(ot.zoomOutText,ot.zoomOutTitle,V+"-out",et,this._zoomOut),this._updateDisabled(),r.on("zoomend zoomlevelschange",this._updateDisabled,this),et},onRemove:function(r){r.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(r){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(r.shiftKey?3:1))},_zoomOut:function(r){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(r.shiftKey?3:1))},_createButton:function(r,V,et,ot,lt){var ft=ae("a",et,ot);return ft.innerHTML=r,ft.href="#",ft.title=V,ft.setAttribute("role","button"),ft.setAttribute("aria-label",V),on(ft),$t(ft,"click",De),$t(ft,"click",lt,this),$t(ft,"click",this._refocusOnMap,this),ft},_updateDisabled:function(){var r=this._map,V="leaflet-disabled";he(this._zoomInButton,V),he(this._zoomOutButton,V),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||r._zoom===r.getMinZoom())&&(ne(this._zoomOutButton,V),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||r._zoom===r.getMaxZoom())&&(ne(this._zoomInButton,V),this._zoomInButton.setAttribute("aria-disabled","true"))}});re.mergeOptions({zoomControl:!0}),re.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Kn,this.addControl(this.zoomControl))});var Wo=function(r){return new Kn(r)},Ai=we.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(r){var V="leaflet-control-scale",et=ae("div",V),ot=this.options;return this._addScales(ot,V+"-line",et),r.on(ot.updateWhenIdle?"moveend":"move",this._update,this),r.whenReady(this._update,this),et},onRemove:function(r){r.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(r,V,et){r.metric&&(this._mScale=ae("div",V,et)),r.imperial&&(this._iScale=ae("div",V,et))},_update:function(){var r=this._map,V=r.getSize().y/2,et=r.distance(r.containerPointToLatLng([0,V]),r.containerPointToLatLng([this.options.maxWidth,V]));this._updateScales(et)},_updateScales:function(r){this.options.metric&&r&&this._updateMetric(r),this.options.imperial&&r&&this._updateImperial(r)},_updateMetric:function(r){var V=this._getRoundNum(r),et=V<1e3?V+" m":V/1e3+" km";this._updateScale(this._mScale,et,V/r)},_updateImperial:function(r){var V=r*3.2808399,et,ot,lt;V>5280?(et=V/5280,ot=this._getRoundNum(et),this._updateScale(this._iScale,ot+" mi",ot/et)):(lt=this._getRoundNum(V),this._updateScale(this._iScale,lt+" ft",lt/V))},_updateScale:function(r,V,et){r.style.width=Math.round(this.options.maxWidth*et)+"px",r.innerHTML=V},_getRoundNum:function(r){var V=Math.pow(10,(Math.floor(r)+"").length-1),et=r/V;return et=et>=10?10:et>=5?5:et>=3?3:et>=2?2:1,V*et}}),Vo=function(r){return new Ai(r)},Xo='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Jn=we.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Wt.inlineSvg?Xo+" ":"")+"Leaflet</a>"},initialize:function(r){_t(this,r),this._attributions={}},onAdd:function(r){r.attributionControl=this,this._container=ae("div","leaflet-control-attribution"),on(this._container);for(var V in r._layers)r._layers[V].getAttribution&&this.addAttribution(r._layers[V].getAttribution());return this._update(),r.on("layeradd",this._addAttribution,this),this._container},onRemove:function(r){r.off("layeradd",this._addAttribution,this)},_addAttribution:function(r){r.layer.getAttribution&&(this.addAttribution(r.layer.getAttribution()),r.layer.once("remove",function(){this.removeAttribution(r.layer.getAttribution())},this))},setPrefix:function(r){return this.options.prefix=r,this._update(),this},addAttribution:function(r){return r?(this._attributions[r]||(this._attributions[r]=0),this._attributions[r]++,this._update(),this):this},removeAttribution:function(r){return r?(this._attributions[r]&&(this._attributions[r]--,this._update()),this):this},_update:function(){if(this._map){var r=[];for(var V in this._attributions)this._attributions[V]&&r.push(V);var et=[];this.options.prefix&&et.push(this.options.prefix),r.length&&et.push(r.join(", ")),this._container.innerHTML=et.join(' <span aria-hidden="true">|</span> ')}}});re.mergeOptions({attributionControl:!0}),re.addInitHook(function(){this.options.attributionControl&&new Jn().addTo(this)});var Yo=function(r){return new Jn(r)};we.Layers=Ei,we.Zoom=Kn,we.Scale=Ai,we.Attribution=Jn,rn.layers=qo,rn.zoom=Wo,rn.scale=Vo,rn.attribution=Yo;var Ce=mt.extend({initialize:function(r){this._map=r},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ce.addTo=function(r,V){return r.addHandler(V,this),this};var jo={Events:It},zi=Wt.touch?"touchstart mousedown":"mousedown",ze=At.extend({options:{clickTolerance:3},initialize:function(r,V,et,ot){_t(this,ot),this._element=r,this._dragStartTarget=V||r,this._preventOutline=et},enable:function(){this._enabled||($t(this._dragStartTarget,zi,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ze._dragging===this&&this.finishDrag(!0),le(this._dragStartTarget,zi,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(r){if(this._enabled&&(this._moved=!1,!Rn(this._element,"leaflet-zoom-anim"))){if(r.touches&&r.touches.length!==1){ze._dragging===this&&this.finishDrag();return}if(!(ze._dragging||r.shiftKey||r.which!==1&&r.button!==1&&!r.touches)&&(ze._dragging=this,this._preventOutline&&Un(this._element),Fn(),tn(),!this._moving)){this.fire("down");var V=r.touches?r.touches[0]:r,et=Si(this._element);this._startPoint=new Et(V.clientX,V.clientY),this._startPos=Re(this._element),this._parentScale=qn(et);var ot=r.type==="mousedown";$t(document,ot?"mousemove":"touchmove",this._onMove,this),$t(document,ot?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(r){if(this._enabled){if(r.touches&&r.touches.length>1){this._moved=!0;return}var V=r.touches&&r.touches.length===1?r.touches[0]:r,et=new Et(V.clientX,V.clientY)._subtract(this._startPoint);!et.x&&!et.y||Math.abs(et.x)+Math.abs(et.y)<this.options.clickTolerance||(et.x/=this._parentScale.x,et.y/=this._parentScale.y,pe(r),this._moved||(this.fire("dragstart"),this._moved=!0,ne(document.body,"leaflet-dragging"),this._lastTarget=r.target||r.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ne(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(et),this._moving=!0,this._lastEvent=r,this._updatePosition())}},_updatePosition:function(){var r={originalEvent:this._lastEvent};this.fire("predrag",r),fe(this._element,this._newPos),this.fire("drag",r)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(r){he(document.body,"leaflet-dragging"),this._lastTarget&&(he(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),le(document,"mousemove touchmove",this._onMove,this),le(document,"mouseup touchend touchcancel",this._onUp,this),Hn(),en(),this._moved&&this._moving&&this.fire("dragend",{noInertia:r,distance:this._newPos.distanceTo(this._startPos)}),this._moving=!1,ze._dragging=!1}});function Ni(r,V){if(!V||!r.length)return r.slice();var et=V*V;return r=Qo(r,et),r=Jo(r,et),r}function Oi(r,V,et){return Math.sqrt(sn(r,V,et,!0))}function Ko(r,V,et){return sn(r,V,et)}function Jo(r,V){var et=r.length,ot=typeof Uint8Array!=void 0+""?Uint8Array:Array,lt=new ot(et);lt[0]=lt[et-1]=1,Qn(r,lt,V,0,et-1);var ft,pt=[];for(ft=0;ft<et;ft++)lt[ft]&&pt.push(r[ft]);return pt}function Qn(r,V,et,ot,lt){var ft=0,pt,yt,xt;for(yt=ot+1;yt<=lt-1;yt++)xt=sn(r[yt],r[ot],r[lt],!0),xt>ft&&(pt=yt,ft=xt);ft>et&&(V[pt]=1,Qn(r,V,et,ot,pt),Qn(r,V,et,pt,lt))}function Qo(r,V){for(var et=[r[0]],ot=1,lt=0,ft=r.length;ot<ft;ot++)$o(r[ot],r[lt])>V&&(et.push(r[ot]),lt=ot);return lt<ft-1&&et.push(r[ft-1]),et}var Bi;function Ri(r,V,et,ot,lt){var ft=ot?Bi:Fe(r,et),pt=Fe(V,et),yt,xt,Nt;for(Bi=pt;;){if(!(ft|pt))return[r,V];if(ft&pt)return!1;yt=ft||pt,xt=vn(r,V,yt,et,lt),Nt=Fe(xt,et),yt===ft?(r=xt,ft=Nt):(V=xt,pt=Nt)}}function vn(r,V,et,ot,lt){var ft=V.x-r.x,pt=V.y-r.y,yt=ot.min,xt=ot.max,Nt,Ht;return et&8?(Nt=r.x+ft*(xt.y-r.y)/pt,Ht=xt.y):et&4?(Nt=r.x+ft*(yt.y-r.y)/pt,Ht=yt.y):et&2?(Nt=xt.x,Ht=r.y+pt*(xt.x-r.x)/ft):et&1&&(Nt=yt.x,Ht=r.y+pt*(yt.x-r.x)/ft),new Et(Nt,Ht,lt)}function Fe(r,V){var et=0;return r.x<V.min.x?et|=1:r.x>V.max.x&&(et|=2),r.y<V.min.y?et|=4:r.y>V.max.y&&(et|=8),et}function $o(r,V){var et=V.x-r.x,ot=V.y-r.y;return et*et+ot*ot}function sn(r,V,et,ot){var lt=V.x,ft=V.y,pt=et.x-lt,yt=et.y-ft,xt=pt*pt+yt*yt,Nt;return xt>0&&(Nt=((r.x-lt)*pt+(r.y-ft)*yt)/xt,Nt>1?(lt=et.x,ft=et.y):Nt>0&&(lt+=pt*Nt,ft+=yt*Nt)),pt=r.x-lt,yt=r.y-ft,ot?pt*pt+yt*yt:new Et(lt,ft)}function ve(r){return!Ot(r[0])||typeof r[0][0]!="object"&&typeof r[0][0]<"u"}function Zi(r){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ve(r)}function Di(r,V){var et,ot,lt,ft,pt,yt,xt,Nt;if(!r||r.length===0)throw new Error("latlngs not passed");ve(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var Ht=[];for(var Kt in r)Ht.push(V.project(te(r[Kt])));var ie=Ht.length;for(et=0,ot=0;et<ie-1;et++)ot+=Ht[et].distanceTo(Ht[et+1])/2;if(ot===0)Nt=Ht[0];else for(et=0,ft=0;et<ie-1;et++)if(pt=Ht[et],yt=Ht[et+1],lt=pt.distanceTo(yt),ft+=lt,ft>ot){xt=(ft-ot)/lt,Nt=[yt.x-xt*(yt.x-pt.x),yt.y-xt*(yt.y-pt.y)];break}return V.unproject(Mt(Nt))}var tr={__proto__:null,simplify:Ni,pointToSegmentDistance:Oi,closestPointOnSegment:Ko,clipSegment:Ri,_getEdgeIntersection:vn,_getBitCode:Fe,_sqClosestPointOnSegment:sn,isFlat:ve,_flat:Zi,polylineCenter:Di};function Fi(r,V,et){var ot,lt=[1,4,2,8],ft,pt,yt,xt,Nt,Ht,Kt,ie;for(ft=0,Ht=r.length;ft<Ht;ft++)r[ft]._code=Fe(r[ft],V);for(yt=0;yt<4;yt++){for(Kt=lt[yt],ot=[],ft=0,Ht=r.length,pt=Ht-1;ft<Ht;pt=ft++)xt=r[ft],Nt=r[pt],xt._code&Kt?Nt._code&Kt||(ie=vn(Nt,xt,Kt,V,et),ie._code=Fe(ie,V),ot.push(ie)):(Nt._code&Kt&&(ie=vn(Nt,xt,Kt,V,et),ie._code=Fe(ie,V),ot.push(ie)),ot.push(xt));r=ot}return r}function Hi(r,V){var et,ot,lt,ft,pt,yt,xt,Nt,Ht;if(!r||r.length===0)throw new Error("latlngs not passed");ve(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var Kt=[];for(var ie in r)Kt.push(V.project(te(r[ie])));var ye=Kt.length;for(yt=xt=Nt=0,et=0,ot=ye-1;et<ye;ot=et++)lt=Kt[et],ft=Kt[ot],pt=lt.y*ft.x-ft.y*lt.x,xt+=(lt.x+ft.x)*pt,Nt+=(lt.y+ft.y)*pt,yt+=pt*3;return yt===0?Ht=Kt[0]:Ht=[xt/yt,Nt/yt],V.unproject(Mt(Ht))}var er={__proto__:null,clipPolygon:Fi,polygonCenter:Hi},$n={project:function(r){return new Et(r.lng,r.lat)},unproject:function(r){return new Ft(r.y,r.x)},bounds:new Zt([-180,-90],[180,90])},ti={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Zt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(r){var V=Math.PI/180,et=this.R,ot=r.lat*V,lt=this.R_MINOR/et,ft=Math.sqrt(1-lt*lt),pt=ft*Math.sin(ot),yt=Math.tan(Math.PI/4-ot/2)/Math.pow((1-pt)/(1+pt),ft/2);return ot=-et*Math.log(Math.max(yt,1e-10)),new Et(r.lng*V*et,ot)},unproject:function(r){for(var V=180/Math.PI,et=this.R,ot=this.R_MINOR/et,lt=Math.sqrt(1-ot*ot),ft=Math.exp(-r.y/et),pt=Math.PI/2-2*Math.atan(ft),yt=0,xt=.1,Nt;yt<15&&Math.abs(xt)>1e-7;yt++)Nt=lt*Math.sin(pt),Nt=Math.pow((1-Nt)/(1+Nt),lt/2),xt=Math.PI/2-2*Math.atan(ft*Nt)-pt,pt+=xt;return new Ft(pt*V,r.x*V/et)}},nr={__proto__:null,LonLat:$n,Mercator:ti,SphericalMercator:me},ir=tt({},Jt,{code:"EPSG:3395",projection:ti,transformation:function(){var r=.5/(Math.PI*ti.R);return _e(r,.5,-r,.5)}()}),Gi=tt({},Jt,{code:"EPSG:4326",projection:$n,transformation:_e(1/180,1,-1/180,.5)}),or=tt({},se,{projection:$n,transformation:_e(1,0,-1,0),scale:function(r){return Math.pow(2,r)},zoom:function(r){return Math.log(r)/Math.LN2},distance:function(r,V){var et=V.lng-r.lng,ot=V.lat-r.lat;return Math.sqrt(et*et+ot*ot)},infinite:!0});se.Earth=Jt,se.EPSG3395=ir,se.EPSG3857=St,se.EPSG900913=Dt,se.EPSG4326=Gi,se.Simple=or;var xe=At.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(r){return r.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(r){return r&&r.removeLayer(this),this},getPane:function(r){return this._map.getPane(r?this.options[r]||r:this.options.pane)},addInteractiveTarget:function(r){return this._map._targets[rt(r)]=this,this},removeInteractiveTarget:function(r){return delete this._map._targets[rt(r)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(r){var V=r.target;if(V.hasLayer(this)){if(this._map=V,this._zoomAnimated=V._zoomAnimated,this.getEvents){var et=this.getEvents();V.on(et,this),this.once("remove",function(){V.off(et,this)},this)}this.onAdd(V),this.fire("add"),V.fire("layeradd",{layer:this})}}});re.include({addLayer:function(r){if(!r._layerAdd)throw new Error("The provided object is not a Layer.");var V=rt(r);return this._layers[V]?this:(this._layers[V]=r,r._mapToAdd=this,r.beforeAdd&&r.beforeAdd(this),this.whenReady(r._layerAdd,r),this)},removeLayer:function(r){var V=rt(r);return this._layers[V]?(this._loaded&&r.onRemove(this),delete this._layers[V],this._loaded&&(this.fire("layerremove",{layer:r}),r.fire("remove")),r._map=r._mapToAdd=null,this):this},hasLayer:function(r){return rt(r)in this._layers},eachLayer:function(r,V){for(var et in this._layers)r.call(V,this._layers[et]);return this},_addLayers:function(r){r=r?Ot(r)?r:[r]:[];for(var V=0,et=r.length;V<et;V++)this.addLayer(r[V])},_addZoomLimit:function(r){(!isNaN(r.options.maxZoom)||!isNaN(r.options.minZoom))&&(this._zoomBoundLayers[rt(r)]=r,this._updateZoomLevels())},_removeZoomLimit:function(r){var V=rt(r);this._zoomBoundLayers[V]&&(delete this._zoomBoundLayers[V],this._updateZoomLevels())},_updateZoomLevels:function(){var r=1/0,V=-1/0,et=this._getZoomSpan();for(var ot in this._zoomBoundLayers){var lt=this._zoomBoundLayers[ot].options;r=lt.minZoom===void 0?r:Math.min(r,lt.minZoom),V=lt.maxZoom===void 0?V:Math.max(V,lt.maxZoom)}this._layersMaxZoom=V===-1/0?void 0:V,this._layersMinZoom=r===1/0?void 0:r,et!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var We=xe.extend({initialize:function(r,V){_t(this,V),this._layers={};var et,ot;if(r)for(et=0,ot=r.length;et<ot;et++)this.addLayer(r[et])},addLayer:function(r){var V=this.getLayerId(r);return this._layers[V]=r,this._map&&this._map.addLayer(r),this},removeLayer:function(r){var V=r in this._layers?r:this.getLayerId(r);return this._map&&this._layers[V]&&this._map.removeLayer(this._layers[V]),delete this._layers[V],this},hasLayer:function(r){var V=typeof r=="number"?r:this.getLayerId(r);return V in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(r){var V=Array.prototype.slice.call(arguments,1),et,ot;for(et in this._layers)ot=this._layers[et],ot[r]&&ot[r].apply(ot,V);return this},onAdd:function(r){this.eachLayer(r.addLayer,r)},onRemove:function(r){this.eachLayer(r.removeLayer,r)},eachLayer:function(r,V){for(var et in this._layers)r.call(V,this._layers[et]);return this},getLayer:function(r){return this._layers[r]},getLayers:function(){var r=[];return this.eachLayer(r.push,r),r},setZIndex:function(r){return this.invoke("setZIndex",r)},getLayerId:function(r){return rt(r)}}),rr=function(r,V){return new We(r,V)},Te=We.extend({addLayer:function(r){return this.hasLayer(r)?this:(r.addEventParent(this),We.prototype.addLayer.call(this,r),this.fire("layeradd",{layer:r}))},removeLayer:function(r){return this.hasLayer(r)?(r in this._layers&&(r=this._layers[r]),r.removeEventParent(this),We.prototype.removeLayer.call(this,r),this.fire("layerremove",{layer:r})):this},setStyle:function(r){return this.invoke("setStyle",r)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var r=new Yt;for(var V in this._layers){var et=this._layers[V];r.extend(et.getBounds?et.getBounds():et.getLatLng())}return r}}),sr=function(r,V){return new Te(r,V)},Ve=mt.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(r){_t(this,r)},createIcon:function(r){return this._createIcon("icon",r)},createShadow:function(r){return this._createIcon("shadow",r)},_createIcon:function(r,V){var et=this._getIconUrl(r);if(!et){if(r==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var ot=this._createImg(et,V&&V.tagName==="IMG"?V:null);return this._setIconStyles(ot,r),(this.options.crossOrigin||this.options.crossOrigin==="")&&(ot.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),ot},_setIconStyles:function(r,V){var et=this.options,ot=et[V+"Size"];typeof ot=="number"&&(ot=[ot,ot]);var lt=Mt(ot),ft=Mt(V==="shadow"&&et.shadowAnchor||et.iconAnchor||lt&&lt.divideBy(2,!0));r.className="leaflet-marker-"+V+" "+(et.className||""),ft&&(r.style.marginLeft=-ft.x+"px",r.style.marginTop=-ft.y+"px"),lt&&(r.style.width=lt.x+"px",r.style.height=lt.y+"px")},_createImg:function(r,V){return V=V||document.createElement("img"),V.src=r,V},_getIconUrl:function(r){return Wt.retina&&this.options[r+"RetinaUrl"]||this.options[r+"Url"]}});function ar(r){return new Ve(r)}var an=Ve.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(r){return typeof an.imagePath!="string"&&(an.imagePath=this._detectIconPath()),(this.options.imagePath||an.imagePath)+Ve.prototype._getIconUrl.call(this,r)},_stripUrl:function(r){var V=function(et,ot,lt){var ft=ot.exec(et);return ft&&ft[lt]};return r=V(r,/^url\((['"])?(.+)\1\)$/,2),r&&V(r,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var r=ae("div","leaflet-default-icon-path",document.body),V=$e(r,"background-image")||$e(r,"backgroundImage");if(document.body.removeChild(r),V=this._stripUrl(V),V)return V;var et=document.querySelector('link[href$="leaflet.css"]');return et?et.href.substring(0,et.href.length-11-1):""}}),Ui=Ce.extend({initialize:function(r){this._marker=r},addHooks:function(){var r=this._marker._icon;this._draggable||(this._draggable=new ze(r,r,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ne(r,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&he(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(r){var V=this._marker,et=V._map,ot=this._marker.options.autoPanSpeed,lt=this._marker.options.autoPanPadding,ft=Re(V._icon),pt=et.getPixelBounds(),yt=et.getPixelOrigin(),xt=Xt(pt.min._subtract(yt).add(lt),pt.max._subtract(yt).subtract(lt));if(!xt.contains(ft)){var Nt=Mt((Math.max(xt.max.x,ft.x)-xt.max.x)/(pt.max.x-xt.max.x)-(Math.min(xt.min.x,ft.x)-xt.min.x)/(pt.min.x-xt.min.x),(Math.max(xt.max.y,ft.y)-xt.max.y)/(pt.max.y-xt.max.y)-(Math.min(xt.min.y,ft.y)-xt.min.y)/(pt.min.y-xt.min.y)).multiplyBy(ot);et.panBy(Nt,{animate:!1}),this._draggable._newPos._add(Nt),this._draggable._startPos._add(Nt),fe(V._icon,this._draggable._newPos),this._onDrag(r),this._panRequest=Vt(this._adjustPan.bind(this,r))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(r){this._marker.options.autoPan&&(Ut(this._panRequest),this._panRequest=Vt(this._adjustPan.bind(this,r)))},_onDrag:function(r){var V=this._marker,et=V._shadow,ot=Re(V._icon),lt=V._map.layerPointToLatLng(ot);et&&fe(et,ot),V._latlng=lt,r.latlng=lt,r.oldLatLng=this._oldLatLng,V.fire("move",r).fire("drag",r)},_onDragEnd:function(r){Ut(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",r)}}),yn=xe.extend({options:{icon:new an,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(r,V){_t(this,V),this._latlng=te(r)},onAdd:function(r){this._zoomAnimated=this._zoomAnimated&&r.options.markerZoomAnimation,this._zoomAnimated&&r.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(r){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&r.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(r){var V=this._latlng;return this._latlng=te(r),this.update(),this.fire("move",{oldLatLng:V,latlng:this._latlng})},setZIndexOffset:function(r){return this.options.zIndexOffset=r,this.update()},getIcon:function(){return this.options.icon},setIcon:function(r){return this.options.icon=r,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var r=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(r)}return this},_initIcon:function(){var r=this.options,V="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),et=r.icon.createIcon(this._icon),ot=!1;et!==this._icon&&(this._icon&&this._removeIcon(),ot=!0,r.title&&(et.title=r.title),et.tagName==="IMG"&&(et.alt=r.alt||"")),ne(et,V),r.keyboard&&(et.tabIndex="0",et.setAttribute("role","button")),this._icon=et,r.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&$t(et,"focus",this._panOnFocus,this);var lt=r.icon.createShadow(this._shadow),ft=!1;lt!==this._shadow&&(this._removeShadow(),ft=!0),lt&&(ne(lt,V),lt.alt=""),this._shadow=lt,r.opacity<1&&this._updateOpacity(),ot&&this.getPane().appendChild(this._icon),this._initInteraction(),lt&&ft&&this.getPane(r.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&le(this._icon,"focus",this._panOnFocus,this),ce(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ce(this._shadow),this._shadow=null},_setPos:function(r){this._icon&&fe(this._icon,r),this._shadow&&fe(this._shadow,r),this._zIndex=r.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(r){this._icon&&(this._icon.style.zIndex=this._zIndex+r)},_animateZoom:function(r){var V=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center).round();this._setPos(V)},_initInteraction:function(){if(this.options.interactive&&(ne(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ui)){var r=this.options.draggable;this.dragging&&(r=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ui(this),r&&this.dragging.enable()}},setOpacity:function(r){return this.options.opacity=r,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var r=this.options.opacity;this._icon&&ge(this._icon,r),this._shadow&&ge(this._shadow,r)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var r=this._map;if(r){var V=this.options.icon.options,et=V.iconSize?Mt(V.iconSize):Mt(0,0),ot=V.iconAnchor?Mt(V.iconAnchor):Mt(0,0);r.panInside(this._latlng,{paddingTopLeft:ot,paddingBottomRight:et.subtract(ot)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function lr(r,V){return new yn(r,V)}var Ne=xe.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(r){this._renderer=r.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(r){return _t(this,r),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&r&&Object.prototype.hasOwnProperty.call(r,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),bn=Ne.extend({options:{fill:!0,radius:10},initialize:function(r,V){_t(this,V),this._latlng=te(r),this._radius=this.options.radius},setLatLng:function(r){var V=this._latlng;return this._latlng=te(r),this.redraw(),this.fire("move",{oldLatLng:V,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(r){return this.options.radius=this._radius=r,this.redraw()},getRadius:function(){return this._radius},setStyle:function(r){var V=r&&r.radius||this._radius;return Ne.prototype.setStyle.call(this,r),this.setRadius(V),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var r=this._radius,V=this._radiusY||r,et=this._clickTolerance(),ot=[r+et,V+et];this._pxBounds=new Zt(this._point.subtract(ot),this._point.add(ot))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(r){return r.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function ur(r,V){return new bn(r,V)}var ei=bn.extend({initialize:function(r,V,et){if(typeof V=="number"&&(V=tt({},et,{radius:V})),_t(this,V),this._latlng=te(r),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(r){return this._mRadius=r,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var r=[this._radius,this._radiusY||this._radius];return new Yt(this._map.layerPointToLatLng(this._point.subtract(r)),this._map.layerPointToLatLng(this._point.add(r)))},setStyle:Ne.prototype.setStyle,_project:function(){var r=this._latlng.lng,V=this._latlng.lat,et=this._map,ot=et.options.crs;if(ot.distance===Jt.distance){var lt=Math.PI/180,ft=this._mRadius/Jt.R/lt,pt=et.project([V+ft,r]),yt=et.project([V-ft,r]),xt=pt.add(yt).divideBy(2),Nt=et.unproject(xt).lat,Ht=Math.acos((Math.cos(ft*lt)-Math.sin(V*lt)*Math.sin(Nt*lt))/(Math.cos(V*lt)*Math.cos(Nt*lt)))/lt;(isNaN(Ht)||Ht===0)&&(Ht=ft/Math.cos(Math.PI/180*V)),this._point=xt.subtract(et.getPixelOrigin()),this._radius=isNaN(Ht)?0:xt.x-et.project([Nt,r-Ht]).x,this._radiusY=xt.y-pt.y}else{var Kt=ot.unproject(ot.project(this._latlng).subtract([this._mRadius,0]));this._point=et.latLngToLayerPoint(this._latlng),this._radius=this._point.x-et.latLngToLayerPoint(Kt).x}this._updateBounds()}});function cr(r,V,et){return new ei(r,V,et)}var Me=Ne.extend({options:{smoothFactor:1,noClip:!1},initialize:function(r,V){_t(this,V),this._setLatLngs(r)},getLatLngs:function(){return this._latlngs},setLatLngs:function(r){return this._setLatLngs(r),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(r){for(var V=1/0,et=null,ot=sn,lt,ft,pt=0,yt=this._parts.length;pt<yt;pt++)for(var xt=this._parts[pt],Nt=1,Ht=xt.length;Nt<Ht;Nt++){lt=xt[Nt-1],ft=xt[Nt];var Kt=ot(r,lt,ft,!0);Kt<V&&(V=Kt,et=ot(r,lt,ft))}return et&&(et.distance=Math.sqrt(V)),et},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Di(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(r,V){return V=V||this._defaultShape(),r=te(r),V.push(r),this._bounds.extend(r),this.redraw()},_setLatLngs:function(r){this._bounds=new Yt,this._latlngs=this._convertLatLngs(r)},_defaultShape:function(){return ve(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(r){for(var V=[],et=ve(r),ot=0,lt=r.length;ot<lt;ot++)et?(V[ot]=te(r[ot]),this._bounds.extend(V[ot])):V[ot]=this._convertLatLngs(r[ot]);return V},_project:function(){var r=new Zt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,r),this._bounds.isValid()&&r.isValid()&&(this._rawPxBounds=r,this._updateBounds())},_updateBounds:function(){var r=this._clickTolerance(),V=new Et(r,r);this._rawPxBounds&&(this._pxBounds=new Zt([this._rawPxBounds.min.subtract(V),this._rawPxBounds.max.add(V)]))},_projectLatlngs:function(r,V,et){var ot=r[0]instanceof Ft,lt=r.length,ft,pt;if(ot){for(pt=[],ft=0;ft<lt;ft++)pt[ft]=this._map.latLngToLayerPoint(r[ft]),et.extend(pt[ft]);V.push(pt)}else for(ft=0;ft<lt;ft++)this._projectLatlngs(r[ft],V,et)},_clipPoints:function(){var r=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}var V=this._parts,et,ot,lt,ft,pt,yt,xt;for(et=0,lt=0,ft=this._rings.length;et<ft;et++)for(xt=this._rings[et],ot=0,pt=xt.length;ot<pt-1;ot++)yt=Ri(xt[ot],xt[ot+1],r,ot,!0),yt&&(V[lt]=V[lt]||[],V[lt].push(yt[0]),(yt[1]!==xt[ot+1]||ot===pt-2)&&(V[lt].push(yt[1]),lt++))}},_simplifyPoints:function(){for(var r=this._parts,V=this.options.smoothFactor,et=0,ot=r.length;et<ot;et++)r[et]=Ni(r[et],V)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(r,V){var et,ot,lt,ft,pt,yt,xt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(et=0,ft=this._parts.length;et<ft;et++)for(yt=this._parts[et],ot=0,pt=yt.length,lt=pt-1;ot<pt;lt=ot++)if(!(!V&&ot===0)&&Oi(r,yt[lt],yt[ot])<=xt)return!0;return!1}});function hr(r,V){return new Me(r,V)}Me._flat=Zi;var Xe=Me.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Hi(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(r){var V=Me.prototype._convertLatLngs.call(this,r),et=V.length;return et>=2&&V[0]instanceof Ft&&V[0].equals(V[et-1])&&V.pop(),V},_setLatLngs:function(r){Me.prototype._setLatLngs.call(this,r),ve(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return ve(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var r=this._renderer._bounds,V=this.options.weight,et=new Et(V,V);if(r=new Zt(r.min.subtract(et),r.max.add(et)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}for(var ot=0,lt=this._rings.length,ft;ot<lt;ot++)ft=Fi(this._rings[ot],r,!0),ft.length&&this._parts.push(ft)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(r){var V=!1,et,ot,lt,ft,pt,yt,xt,Nt;if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(ft=0,xt=this._parts.length;ft<xt;ft++)for(et=this._parts[ft],pt=0,Nt=et.length,yt=Nt-1;pt<Nt;yt=pt++)ot=et[pt],lt=et[yt],ot.y>r.y!=lt.y>r.y&&r.x<(lt.x-ot.x)*(r.y-ot.y)/(lt.y-ot.y)+ot.x&&(V=!V);return V||Me.prototype._containsPoint.call(this,r,!0)}});function fr(r,V){return new Xe(r,V)}var Ie=Te.extend({initialize:function(r,V){_t(this,V),this._layers={},r&&this.addData(r)},addData:function(r){var V=Ot(r)?r:r.features,et,ot,lt;if(V){for(et=0,ot=V.length;et<ot;et++)lt=V[et],(lt.geometries||lt.geometry||lt.features||lt.coordinates)&&this.addData(lt);return this}var ft=this.options;if(ft.filter&&!ft.filter(r))return this;var pt=wn(r,ft);return pt?(pt.feature=kn(r),pt.defaultOptions=pt.options,this.resetStyle(pt),ft.onEachFeature&&ft.onEachFeature(r,pt),this.addLayer(pt)):this},resetStyle:function(r){return r===void 0?this.eachLayer(this.resetStyle,this):(r.options=tt({},r.defaultOptions),this._setLayerStyle(r,this.options.style),this)},setStyle:function(r){return this.eachLayer(function(V){this._setLayerStyle(V,r)},this)},_setLayerStyle:function(r,V){r.setStyle&&(typeof V=="function"&&(V=V(r.feature)),r.setStyle(V))}});function wn(r,V){var et=r.type==="Feature"?r.geometry:r,ot=et?et.coordinates:null,lt=[],ft=V&&V.pointToLayer,pt=V&&V.coordsToLatLng||ni,yt,xt,Nt,Ht;if(!ot&&!et)return null;switch(et.type){case"Point":return yt=pt(ot),qi(ft,r,yt,V);case"MultiPoint":for(Nt=0,Ht=ot.length;Nt<Ht;Nt++)yt=pt(ot[Nt]),lt.push(qi(ft,r,yt,V));return new Te(lt);case"LineString":case"MultiLineString":return xt=xn(ot,et.type==="LineString"?0:1,pt),new Me(xt,V);case"Polygon":case"MultiPolygon":return xt=xn(ot,et.type==="Polygon"?1:2,pt),new Xe(xt,V);case"GeometryCollection":for(Nt=0,Ht=et.geometries.length;Nt<Ht;Nt++){var Kt=wn({geometry:et.geometries[Nt],type:"Feature",properties:r.properties},V);Kt&&lt.push(Kt)}return new Te(lt);case"FeatureCollection":for(Nt=0,Ht=et.features.length;Nt<Ht;Nt++){var ie=wn(et.features[Nt],V);ie&&lt.push(ie)}return new Te(lt);default:throw new Error("Invalid GeoJSON object.")}}function qi(r,V,et,ot){return r?r(V,et):new yn(et,ot&&ot.markersInheritOptions&&ot)}function ni(r){return new Ft(r[1],r[0],r[2])}function xn(r,V,et){for(var ot=[],lt=0,ft=r.length,pt;lt<ft;lt++)pt=V?xn(r[lt],V-1,et):(et||ni)(r[lt]),ot.push(pt);return ot}function ii(r,V){return r=te(r),r.alt!==void 0?[ht(r.lng,V),ht(r.lat,V),ht(r.alt,V)]:[ht(r.lng,V),ht(r.lat,V)]}function Ln(r,V,et,ot){for(var lt=[],ft=0,pt=r.length;ft<pt;ft++)lt.push(V?Ln(r[ft],ve(r[ft])?0:V-1,et,ot):ii(r[ft],ot));return!V&&et&&lt.push(lt[0].slice()),lt}function Ye(r,V){return r.feature?tt({},r.feature,{geometry:V}):kn(V)}function kn(r){return r.type==="Feature"||r.type==="FeatureCollection"?r:{type:"Feature",properties:{},geometry:r}}var oi={toGeoJSON:function(r){return Ye(this,{type:"Point",coordinates:ii(this.getLatLng(),r)})}};yn.include(oi),ei.include(oi),bn.include(oi),Me.include({toGeoJSON:function(r){var V=!ve(this._latlngs),et=Ln(this._latlngs,V?1:0,!1,r);return Ye(this,{type:(V?"Multi":"")+"LineString",coordinates:et})}}),Xe.include({toGeoJSON:function(r){var V=!ve(this._latlngs),et=V&&!ve(this._latlngs[0]),ot=Ln(this._latlngs,et?2:V?1:0,!0,r);return V||(ot=[ot]),Ye(this,{type:(et?"Multi":"")+"Polygon",coordinates:ot})}}),We.include({toMultiPoint:function(r){var V=[];return this.eachLayer(function(et){V.push(et.toGeoJSON(r).geometry.coordinates)}),Ye(this,{type:"MultiPoint",coordinates:V})},toGeoJSON:function(r){var V=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(V==="MultiPoint")return this.toMultiPoint(r);var et=V==="GeometryCollection",ot=[];return this.eachLayer(function(lt){if(lt.toGeoJSON){var ft=lt.toGeoJSON(r);if(et)ot.push(ft.geometry);else{var pt=kn(ft);pt.type==="FeatureCollection"?ot.push.apply(ot,pt.features):ot.push(pt)}}}),et?Ye(this,{geometries:ot,type:"GeometryCollection"}):{type:"FeatureCollection",features:ot}}});function Wi(r,V){return new Ie(r,V)}var dr=Wi,Sn=xe.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(r,V,et){this._url=r,this._bounds=qt(V),_t(this,et)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ne(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ce(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(r){return this.options.opacity=r,this._image&&this._updateOpacity(),this},setStyle:function(r){return r.opacity&&this.setOpacity(r.opacity),this},bringToFront:function(){return this._map&&Ue(this._image),this},bringToBack:function(){return this._map&&qe(this._image),this},setUrl:function(r){return this._url=r,this._image&&(this._image.src=r),this},setBounds:function(r){return this._bounds=qt(r),this._map&&this._reset(),this},getEvents:function(){var r={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var r=this._url.tagName==="IMG",V=this._image=r?this._url:ae("img");if(ne(V,"leaflet-image-layer"),this._zoomAnimated&&ne(V,"leaflet-zoom-animated"),this.options.className&&ne(V,this.options.className),V.onselectstart=ct,V.onmousemove=ct,V.onload=nt(this.fire,this,"load"),V.onerror=nt(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(V.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),r){this._url=V.src;return}V.src=this._url,V.alt=this.options.alt},_animateZoom:function(r){var V=this._map.getZoomScale(r.zoom),et=this._map._latLngBoundsToNewLayerBounds(this._bounds,r.zoom,r.center).min;Be(this._image,et,V)},_reset:function(){var r=this._image,V=new Zt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),et=V.getSize();fe(r,V.min),r.style.width=et.x+"px",r.style.height=et.y+"px"},_updateOpacity:function(){ge(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var r=this.options.errorOverlayUrl;r&&this._url!==r&&(this._url=r,this._image.src=r)},getCenter:function(){return this._bounds.getCenter()}}),_r=function(r,V,et){return new Sn(r,V,et)},Vi=Sn.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var r=this._url.tagName==="VIDEO",V=this._image=r?this._url:ae("video");if(ne(V,"leaflet-image-layer"),this._zoomAnimated&&ne(V,"leaflet-zoom-animated"),this.options.className&&ne(V,this.options.className),V.onselectstart=ct,V.onmousemove=ct,V.onloadeddata=nt(this.fire,this,"load"),r){for(var et=V.getElementsByTagName("source"),ot=[],lt=0;lt<et.length;lt++)ot.push(et[lt].src);this._url=et.length>0?ot:[V.src];return}Ot(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(V.style,"objectFit")&&(V.style.objectFit="fill"),V.autoplay=!!this.options.autoplay,V.loop=!!this.options.loop,V.muted=!!this.options.muted,V.playsInline=!!this.options.playsInline;for(var ft=0;ft<this._url.length;ft++){var pt=ae("source");pt.src=this._url[ft],V.appendChild(pt)}}});function pr(r,V,et){return new Vi(r,V,et)}var Xi=Sn.extend({_initImage:function(){var r=this._image=this._url;ne(r,"leaflet-image-layer"),this._zoomAnimated&&ne(r,"leaflet-zoom-animated"),this.options.className&&ne(r,this.options.className),r.onselectstart=ct,r.onmousemove=ct}});function mr(r,V,et){return new Xi(r,V,et)}var Pe=xe.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(r,V){r&&(r instanceof Ft||Ot(r))?(this._latlng=te(r),_t(this,V)):(_t(this,r),this._source=V),this.options.content&&(this._content=this.options.content)},openOn:function(r){return r=arguments.length?r:this._source._map,r.hasLayer(this)||r.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(r){return this._map?this.close():(arguments.length?this._source=r:r=this._source,this._prepareOpen(),this.openOn(r._map)),this},onAdd:function(r){this._zoomAnimated=r._zoomAnimated,this._container||this._initLayout(),r._fadeAnimated&&ge(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),r._fadeAnimated&&ge(this._container,1),this.bringToFront(),this.options.interactive&&(ne(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(r){r._fadeAnimated?(ge(this._container,0),this._removeTimeout=setTimeout(nt(ce,void 0,this._container),200)):ce(this._container),this.options.interactive&&(he(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(r){return this._latlng=te(r),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(r){return this._content=r,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var r={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ue(this._container),this},bringToBack:function(){return this._map&&qe(this._container),this},_prepareOpen:function(r){var V=this._source;if(!V._map)return!1;if(V instanceof Te){V=null;var et=this._source._layers;for(var ot in et)if(et[ot]._map){V=et[ot];break}if(!V)return!1;this._source=V}if(!r)if(V.getCenter)r=V.getCenter();else if(V.getLatLng)r=V.getLatLng();else if(V.getBounds)r=V.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(r),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var r=this._contentNode,V=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof V=="string")r.innerHTML=V;else{for(;r.hasChildNodes();)r.removeChild(r.firstChild);r.appendChild(V)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var r=this._map.latLngToLayerPoint(this._latlng),V=Mt(this.options.offset),et=this._getAnchor();this._zoomAnimated?fe(this._container,r.add(et)):V=V.add(r).add(et);var ot=this._containerBottom=-V.y,lt=this._containerLeft=-Math.round(this._containerWidth/2)+V.x;this._container.style.bottom=ot+"px",this._container.style.left=lt+"px"}},_getAnchor:function(){return[0,0]}});re.include({_initOverlay:function(r,V,et,ot){var lt=V;return lt instanceof r||(lt=new r(ot).setContent(V)),et&&lt.setLatLng(et),lt}}),xe.include({_initOverlay:function(r,V,et,ot){var lt=et;return lt instanceof r?(_t(lt,ot),lt._source=this):(lt=V&&!ot?V:new r(ot,this),lt.setContent(et)),lt}});var Cn=Pe.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(r){return r=arguments.length?r:this._source._map,!r.hasLayer(this)&&r._popup&&r._popup.options.autoClose&&r.removeLayer(r._popup),r._popup=this,Pe.prototype.openOn.call(this,r)},onAdd:function(r){Pe.prototype.onAdd.call(this,r),r.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ne||this._source.on("preclick",Ze))},onRemove:function(r){Pe.prototype.onRemove.call(this,r),r.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ne||this._source.off("preclick",Ze))},getEvents:function(){var r=Pe.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(r.preclick=this.close),this.options.keepInView&&(r.moveend=this._adjustPan),r},_initLayout:function(){var r="leaflet-popup",V=this._container=ae("div",r+" "+(this.options.className||"")+" leaflet-zoom-animated"),et=this._wrapper=ae("div",r+"-content-wrapper",V);if(this._contentNode=ae("div",r+"-content",et),on(V),Yn(this._contentNode),$t(V,"contextmenu",Ze),this._tipContainer=ae("div",r+"-tip-container",V),this._tip=ae("div",r+"-tip",this._tipContainer),this.options.closeButton){var ot=this._closeButton=ae("a",r+"-close-button",V);ot.setAttribute("role","button"),ot.setAttribute("aria-label","Close popup"),ot.href="#close",ot.innerHTML='<span aria-hidden="true">&#215;</span>',$t(ot,"click",function(lt){pe(lt),this.close()},this)}},_updateLayout:function(){var r=this._contentNode,V=r.style;V.width="",V.whiteSpace="nowrap";var et=r.offsetWidth;et=Math.min(et,this.options.maxWidth),et=Math.max(et,this.options.minWidth),V.width=et+1+"px",V.whiteSpace="",V.height="";var ot=r.offsetHeight,lt=this.options.maxHeight,ft="leaflet-popup-scrolled";lt&&ot>lt?(V.height=lt+"px",ne(r,ft)):he(r,ft),this._containerWidth=this._container.offsetWidth},_animateZoom:function(r){var V=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center),et=this._getAnchor();fe(this._container,V.add(et))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var r=this._map,V=parseInt($e(this._container,"marginBottom"),10)||0,et=this._container.offsetHeight+V,ot=this._containerWidth,lt=new Et(this._containerLeft,-et-this._containerBottom);lt._add(Re(this._container));var ft=r.layerPointToContainerPoint(lt),pt=Mt(this.options.autoPanPadding),yt=Mt(this.options.autoPanPaddingTopLeft||pt),xt=Mt(this.options.autoPanPaddingBottomRight||pt),Nt=r.getSize(),Ht=0,Kt=0;ft.x+ot+xt.x>Nt.x&&(Ht=ft.x+ot-Nt.x+xt.x),ft.x-Ht-yt.x<0&&(Ht=ft.x-yt.x),ft.y+et+xt.y>Nt.y&&(Kt=ft.y+et-Nt.y+xt.y),ft.y-Kt-yt.y<0&&(Kt=ft.y-yt.y),(Ht||Kt)&&(this.options.keepInView&&(this._autopanning=!0),r.fire("autopanstart").panBy([Ht,Kt]))}},_getAnchor:function(){return Mt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),gr=function(r,V){return new Cn(r,V)};re.mergeOptions({closePopupOnClick:!0}),re.include({openPopup:function(r,V,et){return this._initOverlay(Cn,r,V,et).openOn(this),this},closePopup:function(r){return r=arguments.length?r:this._popup,r&&r.close(),this}}),xe.include({bindPopup:function(r,V){return this._popup=this._initOverlay(Cn,this._popup,r,V),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(r){return this._popup&&(this instanceof Te||(this._popup._source=this),this._popup._prepareOpen(r||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(r){return this._popup&&this._popup.setContent(r),this},getPopup:function(){return this._popup},_openPopup:function(r){if(!(!this._popup||!this._map)){De(r);var V=r.layer||r.target;if(this._popup._source===V&&!(V instanceof Ne)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(r.latlng);return}this._popup._source=V,this.openPopup(r.latlng)}},_movePopup:function(r){this._popup.setLatLng(r.latlng)},_onKeyPress:function(r){r.originalEvent.keyCode===13&&this._openPopup(r)}});var Pn=Pe.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(r){Pe.prototype.onAdd.call(this,r),this.setOpacity(this.options.opacity),r.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(r){Pe.prototype.onRemove.call(this,r),r.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var r=Pe.prototype.getEvents.call(this);return this.options.permanent||(r.preclick=this.close),r},_initLayout:function(){var r="leaflet-tooltip",V=r+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ae("div",V),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+rt(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(r){var V,et,ot=this._map,lt=this._container,ft=ot.latLngToContainerPoint(ot.getCenter()),pt=ot.layerPointToContainerPoint(r),yt=this.options.direction,xt=lt.offsetWidth,Nt=lt.offsetHeight,Ht=Mt(this.options.offset),Kt=this._getAnchor();yt==="top"?(V=xt/2,et=Nt):yt==="bottom"?(V=xt/2,et=0):yt==="center"?(V=xt/2,et=Nt/2):yt==="right"?(V=0,et=Nt/2):yt==="left"?(V=xt,et=Nt/2):pt.x<ft.x?(yt="right",V=0,et=Nt/2):(yt="left",V=xt+(Ht.x+Kt.x)*2,et=Nt/2),r=r.subtract(Mt(V,et,!0)).add(Ht).add(Kt),he(lt,"leaflet-tooltip-right"),he(lt,"leaflet-tooltip-left"),he(lt,"leaflet-tooltip-top"),he(lt,"leaflet-tooltip-bottom"),ne(lt,"leaflet-tooltip-"+yt),fe(lt,r)},_updatePosition:function(){var r=this._map.latLngToLayerPoint(this._latlng);this._setPosition(r)},setOpacity:function(r){this.options.opacity=r,this._container&&ge(this._container,r)},_animateZoom:function(r){var V=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center);this._setPosition(V)},_getAnchor:function(){return Mt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),vr=function(r,V){return new Pn(r,V)};re.include({openTooltip:function(r,V,et){return this._initOverlay(Pn,r,V,et).openOn(this),this},closeTooltip:function(r){return r.close(),this}}),xe.include({bindTooltip:function(r,V){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Pn,this._tooltip,r,V),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(r){if(!(!r&&this._tooltipHandlersAdded)){var V=r?"off":"on",et={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?et.add=this._openTooltip:(et.mouseover=this._openTooltip,et.mouseout=this.closeTooltip,et.click=this._openTooltip,this._map?this._addFocusListeners():et.add=this._addFocusListeners),this._tooltip.options.sticky&&(et.mousemove=this._moveTooltip),this[V](et),this._tooltipHandlersAdded=!r}},openTooltip:function(r){return this._tooltip&&(this instanceof Te||(this._tooltip._source=this),this._tooltip._prepareOpen(r)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(r){return this._tooltip&&this._tooltip.setContent(r),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(r){var V=r.getElement();V&&($t(V,"focus",function(){this._tooltip._source=r,this.openTooltip()},this),$t(V,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(r){var V=r.getElement();V&&V.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(r){!this._tooltip||!this._map||this._map.dragging&&this._map.dragging.moving()||(this._tooltip._source=r.layer||r.target,this.openTooltip(this._tooltip.options.sticky?r.latlng:void 0))},_moveTooltip:function(r){var V=r.latlng,et,ot;this._tooltip.options.sticky&&r.originalEvent&&(et=this._map.mouseEventToContainerPoint(r.originalEvent),ot=this._map.containerPointToLayerPoint(et),V=this._map.layerPointToLatLng(ot)),this._tooltip.setLatLng(V)}});var Yi=Ve.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(r){var V=r&&r.tagName==="DIV"?r:document.createElement("div"),et=this.options;if(et.html instanceof Element?(dn(V),V.appendChild(et.html)):V.innerHTML=et.html!==!1?et.html:"",et.bgPos){var ot=Mt(et.bgPos);V.style.backgroundPosition=-ot.x+"px "+-ot.y+"px"}return this._setIconStyles(V,"icon"),V},createShadow:function(){return null}});function yr(r){return new Yi(r)}Ve.Default=an;var ln=xe.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Wt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(r){_t(this,r)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(r){r._addZoomLimit(this)},onRemove:function(r){this._removeAllTiles(),ce(this._container),r._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ue(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(qe(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(r){return this.options.opacity=r,this._updateOpacity(),this},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var r=this._clampZoom(this._map.getZoom());r!==this._tileZoom&&(this._tileZoom=r,this._updateLevels()),this._update()}return this},getEvents:function(){var r={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=st(this._onMoveEnd,this.options.updateInterval,this)),r.move=this._onMove),this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},createTile:function(){return document.createElement("div")},getTileSize:function(){var r=this.options.tileSize;return r instanceof Et?r:new Et(r,r)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(r){for(var V=this.getPane().children,et=-r(-1/0,1/0),ot=0,lt=V.length,ft;ot<lt;ot++)ft=V[ot].style.zIndex,V[ot]!==this._container&&ft&&(et=r(et,+ft));isFinite(et)&&(this.options.zIndex=et+r(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Wt.ielt9){ge(this._container,this.options.opacity);var r=+new Date,V=!1,et=!1;for(var ot in this._tiles){var lt=this._tiles[ot];if(!(!lt.current||!lt.loaded)){var ft=Math.min(1,(r-lt.loaded)/200);ge(lt.el,ft),ft<1?V=!0:(lt.active?et=!0:this._onOpaqueTile(lt),lt.active=!0)}}et&&!this._noPrune&&this._pruneTiles(),V&&(Ut(this._fadeFrame),this._fadeFrame=Vt(this._updateOpacity,this))}},_onOpaqueTile:ct,_initContainer:function(){this._container||(this._container=ae("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var r=this._tileZoom,V=this.options.maxZoom;if(r!==void 0){for(var et in this._levels)et=Number(et),this._levels[et].el.children.length||et===r?(this._levels[et].el.style.zIndex=V-Math.abs(r-et),this._onUpdateLevel(et)):(ce(this._levels[et].el),this._removeTilesAtZoom(et),this._onRemoveLevel(et),delete this._levels[et]);var ot=this._levels[r],lt=this._map;return ot||(ot=this._levels[r]={},ot.el=ae("div","leaflet-tile-container leaflet-zoom-animated",this._container),ot.el.style.zIndex=V,ot.origin=lt.project(lt.unproject(lt.getPixelOrigin()),r).round(),ot.zoom=r,this._setZoomTransform(ot,lt.getCenter(),lt.getZoom()),ct(ot.el.offsetWidth),this._onCreateLevel(ot)),this._level=ot,ot}},_onUpdateLevel:ct,_onRemoveLevel:ct,_onCreateLevel:ct,_pruneTiles:function(){if(this._map){var r,V,et=this._map.getZoom();if(et>this.options.maxZoom||et<this.options.minZoom){this._removeAllTiles();return}for(r in this._tiles)V=this._tiles[r],V.retain=V.current;for(r in this._tiles)if(V=this._tiles[r],V.current&&!V.active){var ot=V.coords;this._retainParent(ot.x,ot.y,ot.z,ot.z-5)||this._retainChildren(ot.x,ot.y,ot.z,ot.z+2)}for(r in this._tiles)this._tiles[r].retain||this._removeTile(r)}},_removeTilesAtZoom:function(r){for(var V in this._tiles)this._tiles[V].coords.z===r&&this._removeTile(V)},_removeAllTiles:function(){for(var r in this._tiles)this._removeTile(r)},_invalidateAll:function(){for(var r in this._levels)ce(this._levels[r].el),this._onRemoveLevel(Number(r)),delete this._levels[r];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(r,V,et,ot){var lt=Math.floor(r/2),ft=Math.floor(V/2),pt=et-1,yt=new Et(+lt,+ft);yt.z=+pt;var xt=this._tileCoordsToKey(yt),Nt=this._tiles[xt];return Nt&&Nt.active?(Nt.retain=!0,!0):(Nt&&Nt.loaded&&(Nt.retain=!0),pt>ot?this._retainParent(lt,ft,pt,ot):!1)},_retainChildren:function(r,V,et,ot){for(var lt=2*r;lt<2*r+2;lt++)for(var ft=2*V;ft<2*V+2;ft++){var pt=new Et(lt,ft);pt.z=et+1;var yt=this._tileCoordsToKey(pt),xt=this._tiles[yt];if(xt&&xt.active){xt.retain=!0;continue}else xt&&xt.loaded&&(xt.retain=!0);et+1<ot&&this._retainChildren(lt,ft,et+1,ot)}},_resetView:function(r){var V=r&&(r.pinch||r.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),V,V)},_animateZoom:function(r){this._setView(r.center,r.zoom,!0,r.noUpdate)},_clampZoom:function(r){var V=this.options;return V.minNativeZoom!==void 0&&r<V.minNativeZoom?V.minNativeZoom:V.maxNativeZoom!==void 0&&V.maxNativeZoom<r?V.maxNativeZoom:r},_setView:function(r,V,et,ot){var lt=Math.round(V);this.options.maxZoom!==void 0&&lt>this.options.maxZoom||this.options.minZoom!==void 0&&lt<this.options.minZoom?lt=void 0:lt=this._clampZoom(lt);var ft=this.options.updateWhenZooming&&lt!==this._tileZoom;(!ot||ft)&&(this._tileZoom=lt,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),lt!==void 0&&this._update(r),et||this._pruneTiles(),this._noPrune=!!et),this._setZoomTransforms(r,V)},_setZoomTransforms:function(r,V){for(var et in this._levels)this._setZoomTransform(this._levels[et],r,V)},_setZoomTransform:function(r,V,et){var ot=this._map.getZoomScale(et,r.zoom),lt=r.origin.multiplyBy(ot).subtract(this._map._getNewPixelOrigin(V,et)).round();Wt.any3d?Be(r.el,lt,ot):fe(r.el,lt)},_resetGrid:function(){var r=this._map,V=r.options.crs,et=this._tileSize=this.getTileSize(),ot=this._tileZoom,lt=this._map.getPixelWorldBounds(this._tileZoom);lt&&(this._globalTileRange=this._pxBoundsToTileRange(lt)),this._wrapX=V.wrapLng&&!this.options.noWrap&&[Math.floor(r.project([0,V.wrapLng[0]],ot).x/et.x),Math.ceil(r.project([0,V.wrapLng[1]],ot).x/et.y)],this._wrapY=V.wrapLat&&!this.options.noWrap&&[Math.floor(r.project([V.wrapLat[0],0],ot).y/et.x),Math.ceil(r.project([V.wrapLat[1],0],ot).y/et.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(r){var V=this._map,et=V._animatingZoom?Math.max(V._animateToZoom,V.getZoom()):V.getZoom(),ot=V.getZoomScale(et,this._tileZoom),lt=V.project(r,this._tileZoom).floor(),ft=V.getSize().divideBy(ot*2);return new Zt(lt.subtract(ft),lt.add(ft))},_update:function(r){var V=this._map;if(V){var et=this._clampZoom(V.getZoom());if(r===void 0&&(r=V.getCenter()),this._tileZoom!==void 0){var ot=this._getTiledPixelBounds(r),lt=this._pxBoundsToTileRange(ot),ft=lt.getCenter(),pt=[],yt=this.options.keepBuffer,xt=new Zt(lt.getBottomLeft().subtract([yt,-yt]),lt.getTopRight().add([yt,-yt]));if(!(isFinite(lt.min.x)&&isFinite(lt.min.y)&&isFinite(lt.max.x)&&isFinite(lt.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Nt in this._tiles){var Ht=this._tiles[Nt].coords;(Ht.z!==this._tileZoom||!xt.contains(new Et(Ht.x,Ht.y)))&&(this._tiles[Nt].current=!1)}if(Math.abs(et-this._tileZoom)>1){this._setView(r,et);return}for(var Kt=lt.min.y;Kt<=lt.max.y;Kt++)for(var ie=lt.min.x;ie<=lt.max.x;ie++){var ye=new Et(ie,Kt);if(ye.z=this._tileZoom,!!this._isValidTile(ye)){var He=this._tiles[this._tileCoordsToKey(ye)];He?He.current=!0:pt.push(ye)}}if(pt.sort(function(Oe,ri){return Oe.distanceTo(ft)-ri.distanceTo(ft)}),pt.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Mn=document.createDocumentFragment();for(ie=0;ie<pt.length;ie++)this._addTile(pt[ie],Mn);this._level.el.appendChild(Mn)}}}},_isValidTile:function(r){var V=this._map.options.crs;if(!V.infinite){var et=this._globalTileRange;if(!V.wrapLng&&(r.x<et.min.x||r.x>et.max.x)||!V.wrapLat&&(r.y<et.min.y||r.y>et.max.y))return!1}if(!this.options.bounds)return!0;var ot=this._tileCoordsToBounds(r);return qt(this.options.bounds).overlaps(ot)},_keyToBounds:function(r){return this._tileCoordsToBounds(this._keyToTileCoords(r))},_tileCoordsToNwSe:function(r){var V=this._map,et=this.getTileSize(),ot=r.scaleBy(et),lt=ot.add(et),ft=V.unproject(ot,r.z),pt=V.unproject(lt,r.z);return[ft,pt]},_tileCoordsToBounds:function(r){var V=this._tileCoordsToNwSe(r),et=new Yt(V[0],V[1]);return this.options.noWrap||(et=this._map.wrapLatLngBounds(et)),et},_tileCoordsToKey:function(r){return r.x+":"+r.y+":"+r.z},_keyToTileCoords:function(r){var V=r.split(":"),et=new Et(+V[0],+V[1]);return et.z=+V[2],et},_removeTile:function(r){var V=this._tiles[r];V&&(ce(V.el),delete this._tiles[r],this.fire("tileunload",{tile:V.el,coords:this._keyToTileCoords(r)}))},_initTile:function(r){ne(r,"leaflet-tile");var V=this.getTileSize();r.style.width=V.x+"px",r.style.height=V.y+"px",r.onselectstart=ct,r.onmousemove=ct,Wt.ielt9&&this.options.opacity<1&&ge(r,this.options.opacity)},_addTile:function(r,V){var et=this._getTilePos(r),ot=this._tileCoordsToKey(r),lt=this.createTile(this._wrapCoords(r),nt(this._tileReady,this,r));this._initTile(lt),this.createTile.length<2&&Vt(nt(this._tileReady,this,r,null,lt)),fe(lt,et),this._tiles[ot]={el:lt,coords:r,current:!0},V.appendChild(lt),this.fire("tileloadstart",{tile:lt,coords:r})},_tileReady:function(r,V,et){V&&this.fire("tileerror",{error:V,tile:et,coords:r});var ot=this._tileCoordsToKey(r);et=this._tiles[ot],et&&(et.loaded=+new Date,this._map._fadeAnimated?(ge(et.el,0),Ut(this._fadeFrame),this._fadeFrame=Vt(this._updateOpacity,this)):(et.active=!0,this._pruneTiles()),V||(ne(et.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:et.el,coords:r})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Wt.ielt9||!this._map._fadeAnimated?Vt(this._pruneTiles,this):setTimeout(nt(this._pruneTiles,this),250)))},_getTilePos:function(r){return r.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(r){var V=new Et(this._wrapX?at(r.x,this._wrapX):r.x,this._wrapY?at(r.y,this._wrapY):r.y);return V.z=r.z,V},_pxBoundsToTileRange:function(r){var V=this.getTileSize();return new Zt(r.min.unscaleBy(V).floor(),r.max.unscaleBy(V).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var r in this._tiles)if(!this._tiles[r].loaded)return!1;return!0}});function br(r){return new ln(r)}var je=ln.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(r,V){this._url=r,V=_t(this,V),V.detectRetina&&Wt.retina&&V.maxZoom>0?(V.tileSize=Math.floor(V.tileSize/2),V.zoomReverse?(V.zoomOffset--,V.minZoom=Math.min(V.maxZoom,V.minZoom+1)):(V.zoomOffset++,V.maxZoom=Math.max(V.minZoom,V.maxZoom-1)),V.minZoom=Math.max(0,V.minZoom)):V.zoomReverse?V.minZoom=Math.min(V.maxZoom,V.minZoom):V.maxZoom=Math.max(V.minZoom,V.maxZoom),typeof V.subdomains=="string"&&(V.subdomains=V.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(r,V){return this._url===r&&V===void 0&&(V=!0),this._url=r,V||this.redraw(),this},createTile:function(r,V){var et=document.createElement("img");return $t(et,"load",nt(this._tileOnLoad,this,V,et)),$t(et,"error",nt(this._tileOnError,this,V,et)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(et.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(et.referrerPolicy=this.options.referrerPolicy),et.alt="",et.src=this.getTileUrl(r),et},getTileUrl:function(r){var V={r:Wt.retina?"@2x":"",s:this._getSubdomain(r),x:r.x,y:r.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var et=this._globalTileRange.max.y-r.y;this.options.tms&&(V.y=et),V["-y"]=et}return Tt(this._url,tt(V,this.options))},_tileOnLoad:function(r,V){Wt.ielt9?setTimeout(nt(r,this,null,V),0):r(null,V)},_tileOnError:function(r,V,et){var ot=this.options.errorTileUrl;ot&&V.getAttribute("src")!==ot&&(V.src=ot),r(et,V)},_onTileRemove:function(r){r.tile.onload=null},_getZoomForUrl:function(){var r=this._tileZoom,V=this.options.maxZoom,et=this.options.zoomReverse,ot=this.options.zoomOffset;return et&&(r=V-r),r+ot},_getSubdomain:function(r){var V=Math.abs(r.x+r.y)%this.options.subdomains.length;return this.options.subdomains[V]},_abortLoading:function(){var r,V;for(r in this._tiles)if(this._tiles[r].coords.z!==this._tileZoom&&(V=this._tiles[r].el,V.onload=ct,V.onerror=ct,!V.complete)){V.src=vt;var et=this._tiles[r].coords;ce(V),delete this._tiles[r],this.fire("tileabort",{tile:V,coords:et})}},_removeTile:function(r){var V=this._tiles[r];if(V)return V.el.setAttribute("src",vt),ln.prototype._removeTile.call(this,r)},_tileReady:function(r,V,et){if(!(!this._map||et&&et.getAttribute("src")===vt))return ln.prototype._tileReady.call(this,r,V,et)}});function ji(r,V){return new je(r,V)}var Ki=je.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(r,V){this._url=r;var et=tt({},this.defaultWmsParams);for(var ot in V)ot in this.options||(et[ot]=V[ot]);V=_t(this,V);var lt=V.detectRetina&&Wt.retina?2:1,ft=this.getTileSize();et.width=ft.x*lt,et.height=ft.y*lt,this.wmsParams=et},onAdd:function(r){this._crs=this.options.crs||r.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var V=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[V]=this._crs.code,je.prototype.onAdd.call(this,r)},getTileUrl:function(r){var V=this._tileCoordsToNwSe(r),et=this._crs,ot=Xt(et.project(V[0]),et.project(V[1])),lt=ot.min,ft=ot.max,pt=(this._wmsVersion>=1.3&&this._crs===Gi?[lt.y,lt.x,ft.y,ft.x]:[lt.x,lt.y,ft.x,ft.y]).join(","),yt=je.prototype.getTileUrl.call(this,r);return yt+kt(this.wmsParams,yt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+pt},setParams:function(r,V){return tt(this.wmsParams,r),V||this.redraw(),this}});function wr(r,V){return new Ki(r,V)}je.WMS=Ki,ji.wms=wr;var Ee=xe.extend({options:{padding:.1},initialize:function(r){_t(this,r),rt(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&ne(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var r={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(r.zoomanim=this._onAnimZoom),r},_onAnimZoom:function(r){this._updateTransform(r.center,r.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(r,V){var et=this._map.getZoomScale(V,this._zoom),ot=this._map.getSize().multiplyBy(.5+this.options.padding),lt=this._map.project(this._center,V),ft=ot.multiplyBy(-et).add(lt).subtract(this._map._getNewPixelOrigin(r,V));Wt.any3d?Be(this._container,ft,et):fe(this._container,ft)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var r in this._layers)this._layers[r]._reset()},_onZoomEnd:function(){for(var r in this._layers)this._layers[r]._project()},_updatePaths:function(){for(var r in this._layers)this._layers[r]._update()},_update:function(){var r=this.options.padding,V=this._map.getSize(),et=this._map.containerPointToLayerPoint(V.multiplyBy(-r)).round();this._bounds=new Zt(et,et.add(V.multiplyBy(1+r*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ji=Ee.extend({options:{tolerance:0},getEvents:function(){var r=Ee.prototype.getEvents.call(this);return r.viewprereset=this._onViewPreReset,r},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ee.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var r=this._container=document.createElement("canvas");$t(r,"mousemove",this._onMouseMove,this),$t(r,"click dblclick mousedown mouseup contextmenu",this._onClick,this),$t(r,"mouseout",this._handleMouseOut,this),r._leaflet_disable_events=!0,this._ctx=r.getContext("2d")},_destroyContainer:function(){Ut(this._redrawRequest),delete this._ctx,ce(this._container),le(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var r;this._redrawBounds=null;for(var V in this._layers)r=this._layers[V],r._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ee.prototype._update.call(this);var r=this._bounds,V=this._container,et=r.getSize(),ot=Wt.retina?2:1;fe(V,r.min),V.width=ot*et.x,V.height=ot*et.y,V.style.width=et.x+"px",V.style.height=et.y+"px",Wt.retina&&this._ctx.scale(2,2),this._ctx.translate(-r.min.x,-r.min.y),this.fire("update")}},_reset:function(){Ee.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(r){this._updateDashArray(r),this._layers[rt(r)]=r;var V=r._order={layer:r,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=V),this._drawLast=V,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(r){this._requestRedraw(r)},_removePath:function(r){var V=r._order,et=V.next,ot=V.prev;et?et.prev=ot:this._drawLast=ot,ot?ot.next=et:this._drawFirst=et,delete r._order,delete this._layers[rt(r)],this._requestRedraw(r)},_updatePath:function(r){this._extendRedrawBounds(r),r._project(),r._update(),this._requestRedraw(r)},_updateStyle:function(r){this._updateDashArray(r),this._requestRedraw(r)},_updateDashArray:function(r){if(typeof r.options.dashArray=="string"){var V=r.options.dashArray.split(/[, ]+/),et=[],ot,lt;for(lt=0;lt<V.length;lt++){if(ot=Number(V[lt]),isNaN(ot))return;et.push(ot)}r.options._dashArray=et}else r.options._dashArray=r.options.dashArray},_requestRedraw:function(r){this._map&&(this._extendRedrawBounds(r),this._redrawRequest=this._redrawRequest||Vt(this._redraw,this))},_extendRedrawBounds:function(r){if(r._pxBounds){var V=(r.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Zt,this._redrawBounds.extend(r._pxBounds.min.subtract([V,V])),this._redrawBounds.extend(r._pxBounds.max.add([V,V]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var r=this._redrawBounds;if(r){var V=r.getSize();this._ctx.clearRect(r.min.x,r.min.y,V.x,V.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var r,V=this._redrawBounds;if(this._ctx.save(),V){var et=V.getSize();this._ctx.beginPath(),this._ctx.rect(V.min.x,V.min.y,et.x,et.y),this._ctx.clip()}this._drawing=!0;for(var ot=this._drawFirst;ot;ot=ot.next)r=ot.layer,(!V||r._pxBounds&&r._pxBounds.intersects(V))&&r._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(r,V){if(this._drawing){var et,ot,lt,ft,pt=r._parts,yt=pt.length,xt=this._ctx;if(yt){for(xt.beginPath(),et=0;et<yt;et++){for(ot=0,lt=pt[et].length;ot<lt;ot++)ft=pt[et][ot],xt[ot?"lineTo":"moveTo"](ft.x,ft.y);V&&xt.closePath()}this._fillStroke(xt,r)}}},_updateCircle:function(r){if(!(!this._drawing||r._empty())){var V=r._point,et=this._ctx,ot=Math.max(Math.round(r._radius),1),lt=(Math.max(Math.round(r._radiusY),1)||ot)/ot;lt!==1&&(et.save(),et.scale(1,lt)),et.beginPath(),et.arc(V.x,V.y/lt,ot,0,Math.PI*2,!1),lt!==1&&et.restore(),this._fillStroke(et,r)}},_fillStroke:function(r,V){var et=V.options;et.fill&&(r.globalAlpha=et.fillOpacity,r.fillStyle=et.fillColor||et.color,r.fill(et.fillRule||"evenodd")),et.stroke&&et.weight!==0&&(r.setLineDash&&r.setLineDash(V.options&&V.options._dashArray||[]),r.globalAlpha=et.opacity,r.lineWidth=et.weight,r.strokeStyle=et.color,r.lineCap=et.lineCap,r.lineJoin=et.lineJoin,r.stroke())},_onClick:function(r){for(var V=this._map.mouseEventToLayerPoint(r),et,ot,lt=this._drawFirst;lt;lt=lt.next)et=lt.layer,et.options.interactive&&et._containsPoint(V)&&(!(r.type==="click"||r.type==="preclick")||!this._map._draggableMoved(et))&&(ot=et);this._fireEvent(ot?[ot]:!1,r)},_onMouseMove:function(r){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var V=this._map.mouseEventToLayerPoint(r);this._handleMouseHover(r,V)}},_handleMouseOut:function(r){var V=this._hoveredLayer;V&&(he(this._container,"leaflet-interactive"),this._fireEvent([V],r,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(r,V){if(!this._mouseHoverThrottled){for(var et,ot,lt=this._drawFirst;lt;lt=lt.next)et=lt.layer,et.options.interactive&&et._containsPoint(V)&&(ot=et);ot!==this._hoveredLayer&&(this._handleMouseOut(r),ot&&(ne(this._container,"leaflet-interactive"),this._fireEvent([ot],r,"mouseover"),this._hoveredLayer=ot)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,r),this._mouseHoverThrottled=!0,setTimeout(nt(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(r,V,et){this._map._fireDOMEvent(V,et||V.type,r)},_bringToFront:function(r){var V=r._order;if(V){var et=V.next,ot=V.prev;if(et)et.prev=ot;else return;ot?ot.next=et:et&&(this._drawFirst=et),V.prev=this._drawLast,this._drawLast.next=V,V.next=null,this._drawLast=V,this._requestRedraw(r)}},_bringToBack:function(r){var V=r._order;if(V){var et=V.next,ot=V.prev;if(ot)ot.next=et;else return;et?et.prev=ot:ot&&(this._drawLast=ot),V.prev=null,V.next=this._drawFirst,this._drawFirst.prev=V,this._drawFirst=V,this._requestRedraw(r)}}});function Qi(r){return Wt.canvas?new Ji(r):null}var un=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(r){return document.createElement("<lvml:"+r+' class="lvml">')}}catch{}return function(r){return document.createElement("<"+r+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),xr={_initContainer:function(){this._container=ae("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ee.prototype._update.call(this),this.fire("update"))},_initPath:function(r){var V=r._container=un("shape");ne(V,"leaflet-vml-shape "+(this.options.className||"")),V.coordsize="1 1",r._path=un("path"),V.appendChild(r._path),this._updateStyle(r),this._layers[rt(r)]=r},_addPath:function(r){var V=r._container;this._container.appendChild(V),r.options.interactive&&r.addInteractiveTarget(V)},_removePath:function(r){var V=r._container;ce(V),r.removeInteractiveTarget(V),delete this._layers[rt(r)]},_updateStyle:function(r){var V=r._stroke,et=r._fill,ot=r.options,lt=r._container;lt.stroked=!!ot.stroke,lt.filled=!!ot.fill,ot.stroke?(V||(V=r._stroke=un("stroke")),lt.appendChild(V),V.weight=ot.weight+"px",V.color=ot.color,V.opacity=ot.opacity,ot.dashArray?V.dashStyle=Ot(ot.dashArray)?ot.dashArray.join(" "):ot.dashArray.replace(/( *, *)/g," "):V.dashStyle="",V.endcap=ot.lineCap.replace("butt","flat"),V.joinstyle=ot.lineJoin):V&&(lt.removeChild(V),r._stroke=null),ot.fill?(et||(et=r._fill=un("fill")),lt.appendChild(et),et.color=ot.fillColor||ot.color,et.opacity=ot.fillOpacity):et&&(lt.removeChild(et),r._fill=null)},_updateCircle:function(r){var V=r._point.round(),et=Math.round(r._radius),ot=Math.round(r._radiusY||et);this._setPath(r,r._empty()?"M0 0":"AL "+V.x+","+V.y+" "+et+","+ot+" 0,"+65535*360)},_setPath:function(r,V){r._path.v=V},_bringToFront:function(r){Ue(r._container)},_bringToBack:function(r){qe(r._container)}},Tn=Wt.vml?un:ee,cn=Ee.extend({_initContainer:function(){this._container=Tn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Tn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ce(this._container),le(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ee.prototype._update.call(this);var r=this._bounds,V=r.getSize(),et=this._container;(!this._svgSize||!this._svgSize.equals(V))&&(this._svgSize=V,et.setAttribute("width",V.x),et.setAttribute("height",V.y)),fe(et,r.min),et.setAttribute("viewBox",[r.min.x,r.min.y,V.x,V.y].join(" ")),this.fire("update")}},_initPath:function(r){var V=r._path=Tn("path");r.options.className&&ne(V,r.options.className),r.options.interactive&&ne(V,"leaflet-interactive"),this._updateStyle(r),this._layers[rt(r)]=r},_addPath:function(r){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(r._path),r.addInteractiveTarget(r._path)},_removePath:function(r){ce(r._path),r.removeInteractiveTarget(r._path),delete this._layers[rt(r)]},_updatePath:function(r){r._project(),r._update()},_updateStyle:function(r){var V=r._path,et=r.options;V&&(et.stroke?(V.setAttribute("stroke",et.color),V.setAttribute("stroke-opacity",et.opacity),V.setAttribute("stroke-width",et.weight),V.setAttribute("stroke-linecap",et.lineCap),V.setAttribute("stroke-linejoin",et.lineJoin),et.dashArray?V.setAttribute("stroke-dasharray",et.dashArray):V.removeAttribute("stroke-dasharray"),et.dashOffset?V.setAttribute("stroke-dashoffset",et.dashOffset):V.removeAttribute("stroke-dashoffset")):V.setAttribute("stroke","none"),et.fill?(V.setAttribute("fill",et.fillColor||et.color),V.setAttribute("fill-opacity",et.fillOpacity),V.setAttribute("fill-rule",et.fillRule||"evenodd")):V.setAttribute("fill","none"))},_updatePoly:function(r,V){this._setPath(r,Rt(r._parts,V))},_updateCircle:function(r){var V=r._point,et=Math.max(Math.round(r._radius),1),ot=Math.max(Math.round(r._radiusY),1)||et,lt="a"+et+","+ot+" 0 1,0 ",ft=r._empty()?"M0 0":"M"+(V.x-et)+","+V.y+lt+et*2+",0 "+lt+-et*2+",0 ";this._setPath(r,ft)},_setPath:function(r,V){r._path.setAttribute("d",V)},_bringToFront:function(r){Ue(r._path)},_bringToBack:function(r){qe(r._path)}});Wt.vml&&cn.include(xr);function $i(r){return Wt.svg||Wt.vml?new cn(r):null}re.include({getRenderer:function(r){var V=r.options.renderer||this._getPaneRenderer(r.options.pane)||this.options.renderer||this._renderer;return V||(V=this._renderer=this._createRenderer()),this.hasLayer(V)||this.addLayer(V),V},_getPaneRenderer:function(r){if(r==="overlayPane"||r===void 0)return!1;var V=this._paneRenderers[r];return V===void 0&&(V=this._createRenderer({pane:r}),this._paneRenderers[r]=V),V},_createRenderer:function(r){return this.options.preferCanvas&&Qi(r)||$i(r)}});var to=Xe.extend({initialize:function(r,V){Xe.prototype.initialize.call(this,this._boundsToLatLngs(r),V)},setBounds:function(r){return this.setLatLngs(this._boundsToLatLngs(r))},_boundsToLatLngs:function(r){return r=qt(r),[r.getSouthWest(),r.getNorthWest(),r.getNorthEast(),r.getSouthEast()]}});function Lr(r,V){return new to(r,V)}cn.create=Tn,cn.pointsToPath=Rt,Ie.geometryToLayer=wn,Ie.coordsToLatLng=ni,Ie.coordsToLatLngs=xn,Ie.latLngToCoords=ii,Ie.latLngsToCoords=Ln,Ie.getFeature=Ye,Ie.asFeature=kn,re.mergeOptions({boxZoom:!0});var eo=Ce.extend({initialize:function(r){this._map=r,this._container=r._container,this._pane=r._panes.overlayPane,this._resetStateTimeout=0,r.on("unload",this._destroy,this)},addHooks:function(){$t(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){le(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ce(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(r){if(!r.shiftKey||r.which!==1&&r.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),tn(),Fn(),this._startPoint=this._map.mouseEventToContainerPoint(r),$t(document,{contextmenu:De,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(r){this._moved||(this._moved=!0,this._box=ae("div","leaflet-zoom-box",this._container),ne(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(r);var V=new Zt(this._point,this._startPoint),et=V.getSize();fe(this._box,V.min),this._box.style.width=et.x+"px",this._box.style.height=et.y+"px"},_finish:function(){this._moved&&(ce(this._box),he(this._container,"leaflet-crosshair")),en(),Hn(),le(document,{contextmenu:De,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(r){if(!(r.which!==1&&r.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(nt(this._resetState,this),0);var V=new Yt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(V).fire("boxzoomend",{boxZoomBounds:V})}},_onKeyDown:function(r){r.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});re.addInitHook("addHandler","boxZoom",eo),re.mergeOptions({doubleClickZoom:!0});var no=Ce.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(r){var V=this._map,et=V.getZoom(),ot=V.options.zoomDelta,lt=r.originalEvent.shiftKey?et-ot:et+ot;V.options.doubleClickZoom==="center"?V.setZoom(lt):V.setZoomAround(r.containerPoint,lt)}});re.addInitHook("addHandler","doubleClickZoom",no),re.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var io=Ce.extend({addHooks:function(){if(!this._draggable){var r=this._map;this._draggable=new ze(r._mapPane,r._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),r.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),r.on("zoomend",this._onZoomEnd,this),r.whenReady(this._onZoomEnd,this))}ne(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){he(this._map._container,"leaflet-grab"),he(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var r=this._map;if(r._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var V=qt(this._map.options.maxBounds);this._offsetLimit=Xt(this._map.latLngToContainerPoint(V.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(V.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;r.fire("movestart").fire("dragstart"),r.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(r){if(this._map.options.inertia){var V=this._lastTime=+new Date,et=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(et),this._times.push(V),this._prunePositions(V)}this._map.fire("move",r).fire("drag",r)},_prunePositions:function(r){for(;this._positions.length>1&&r-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var r=this._map.getSize().divideBy(2),V=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=V.subtract(r).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(r,V){return r-(r-V)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var r=this._draggable._newPos.subtract(this._draggable._startPos),V=this._offsetLimit;r.x<V.min.x&&(r.x=this._viscousLimit(r.x,V.min.x)),r.y<V.min.y&&(r.y=this._viscousLimit(r.y,V.min.y)),r.x>V.max.x&&(r.x=this._viscousLimit(r.x,V.max.x)),r.y>V.max.y&&(r.y=this._viscousLimit(r.y,V.max.y)),this._draggable._newPos=this._draggable._startPos.add(r)}},_onPreDragWrap:function(){var r=this._worldWidth,V=Math.round(r/2),et=this._initialWorldOffset,ot=this._draggable._newPos.x,lt=(ot-V+et)%r+V-et,ft=(ot+V+et)%r-V-et,pt=Math.abs(lt+et)<Math.abs(ft+et)?lt:ft;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=pt},_onDragEnd:function(r){var V=this._map,et=V.options,ot=!et.inertia||r.noInertia||this._times.length<2;if(V.fire("dragend",r),ot)V.fire("moveend");else{this._prunePositions(+new Date);var lt=this._lastPos.subtract(this._positions[0]),ft=(this._lastTime-this._times[0])/1e3,pt=et.easeLinearity,yt=lt.multiplyBy(pt/ft),xt=yt.distanceTo([0,0]),Nt=Math.min(et.inertiaMaxSpeed,xt),Ht=yt.multiplyBy(Nt/xt),Kt=Nt/(et.inertiaDeceleration*pt),ie=Ht.multiplyBy(-Kt/2).round();!ie.x&&!ie.y?V.fire("moveend"):(ie=V._limitOffset(ie,V.options.maxBounds),Vt(function(){V.panBy(ie,{duration:Kt,easeLinearity:pt,noMoveStart:!0,animate:!0})}))}}});re.addInitHook("addHandler","dragging",io),re.mergeOptions({keyboard:!0,keyboardPanDelta:80});var oo=Ce.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(r){this._map=r,this._setPanDelta(r.options.keyboardPanDelta),this._setZoomDelta(r.options.zoomDelta)},addHooks:function(){var r=this._map._container;r.tabIndex<=0&&(r.tabIndex="0"),$t(r,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),le(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var r=document.body,V=document.documentElement,et=r.scrollTop||V.scrollTop,ot=r.scrollLeft||V.scrollLeft;this._map._container.focus(),window.scrollTo(ot,et)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(r){var V=this._panKeys={},et=this.keyCodes,ot,lt;for(ot=0,lt=et.left.length;ot<lt;ot++)V[et.left[ot]]=[-1*r,0];for(ot=0,lt=et.right.length;ot<lt;ot++)V[et.right[ot]]=[r,0];for(ot=0,lt=et.down.length;ot<lt;ot++)V[et.down[ot]]=[0,r];for(ot=0,lt=et.up.length;ot<lt;ot++)V[et.up[ot]]=[0,-1*r]},_setZoomDelta:function(r){var V=this._zoomKeys={},et=this.keyCodes,ot,lt;for(ot=0,lt=et.zoomIn.length;ot<lt;ot++)V[et.zoomIn[ot]]=r;for(ot=0,lt=et.zoomOut.length;ot<lt;ot++)V[et.zoomOut[ot]]=-r},_addHooks:function(){$t(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){le(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(r){if(!(r.altKey||r.ctrlKey||r.metaKey)){var V=r.keyCode,et=this._map,ot;if(V in this._panKeys){if(!et._panAnim||!et._panAnim._inProgress)if(ot=this._panKeys[V],r.shiftKey&&(ot=Mt(ot).multiplyBy(3)),et.options.maxBounds&&(ot=et._limitOffset(Mt(ot),et.options.maxBounds)),et.options.worldCopyJump){var lt=et.wrapLatLng(et.unproject(et.project(et.getCenter()).add(ot)));et.panTo(lt)}else et.panBy(ot)}else if(V in this._zoomKeys)et.setZoom(et.getZoom()+(r.shiftKey?3:1)*this._zoomKeys[V]);else if(V===27&&et._popup&&et._popup.options.closeOnEscapeKey)et.closePopup();else return;De(r)}}});re.addInitHook("addHandler","keyboard",oo),re.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ro=Ce.extend({addHooks:function(){$t(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){le(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(r){var V=Mi(r),et=this._map.options.wheelDebounceTime;this._delta+=V,this._lastMousePos=this._map.mouseEventToContainerPoint(r),this._startTime||(this._startTime=+new Date);var ot=Math.max(et-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(nt(this._performZoom,this),ot),De(r)},_performZoom:function(){var r=this._map,V=r.getZoom(),et=this._map.options.zoomSnap||0;r._stop();var ot=this._delta/(this._map.options.wheelPxPerZoomLevel*4),lt=4*Math.log(2/(1+Math.exp(-Math.abs(ot))))/Math.LN2,ft=et?Math.ceil(lt/et)*et:lt,pt=r._limitZoom(V+(this._delta>0?ft:-ft))-V;this._delta=0,this._startTime=null,pt&&(r.options.scrollWheelZoom==="center"?r.setZoom(V+pt):r.setZoomAround(this._lastMousePos,V+pt))}});re.addInitHook("addHandler","scrollWheelZoom",ro);var kr=600;re.mergeOptions({tapHold:Wt.touchNative&&Wt.safari&&Wt.mobile,tapTolerance:15});var so=Ce.extend({addHooks:function(){$t(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){le(this._map._container,"touchstart",this._onDown,this)},_onDown:function(r){if(clearTimeout(this._holdTimeout),r.touches.length===1){var V=r.touches[0];this._startPos=this._newPos=new Et(V.clientX,V.clientY),this._holdTimeout=setTimeout(nt(function(){this._cancel(),this._isTapValid()&&($t(document,"touchend",pe),$t(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",V))},this),kr),$t(document,"touchend touchcancel contextmenu",this._cancel,this),$t(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function r(){le(document,"touchend",pe),le(document,"touchend touchcancel",r)},_cancel:function(){clearTimeout(this._holdTimeout),le(document,"touchend touchcancel contextmenu",this._cancel,this),le(document,"touchmove",this._onMove,this)},_onMove:function(r){var V=r.touches[0];this._newPos=new Et(V.clientX,V.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(r,V){var et=new MouseEvent(r,{bubbles:!0,cancelable:!0,view:window,screenX:V.screenX,screenY:V.screenY,clientX:V.clientX,clientY:V.clientY});et._simulated=!0,V.target.dispatchEvent(et)}});re.addInitHook("addHandler","tapHold",so),re.mergeOptions({touchZoom:Wt.touch,bounceAtZoomLimits:!0});var ao=Ce.extend({addHooks:function(){ne(this._map._container,"leaflet-touch-zoom"),$t(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){he(this._map._container,"leaflet-touch-zoom"),le(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(r){var V=this._map;if(!(!r.touches||r.touches.length!==2||V._animatingZoom||this._zooming)){var et=V.mouseEventToContainerPoint(r.touches[0]),ot=V.mouseEventToContainerPoint(r.touches[1]);this._centerPoint=V.getSize()._divideBy(2),this._startLatLng=V.containerPointToLatLng(this._centerPoint),V.options.touchZoom!=="center"&&(this._pinchStartLatLng=V.containerPointToLatLng(et.add(ot)._divideBy(2))),this._startDist=et.distanceTo(ot),this._startZoom=V.getZoom(),this._moved=!1,this._zooming=!0,V._stop(),$t(document,"touchmove",this._onTouchMove,this),$t(document,"touchend touchcancel",this._onTouchEnd,this),pe(r)}},_onTouchMove:function(r){if(!(!r.touches||r.touches.length!==2||!this._zooming)){var V=this._map,et=V.mouseEventToContainerPoint(r.touches[0]),ot=V.mouseEventToContainerPoint(r.touches[1]),lt=et.distanceTo(ot)/this._startDist;if(this._zoom=V.getScaleZoom(lt,this._startZoom),!V.options.bounceAtZoomLimits&&(this._zoom<V.getMinZoom()&&lt<1||this._zoom>V.getMaxZoom()&&lt>1)&&(this._zoom=V._limitZoom(this._zoom)),V.options.touchZoom==="center"){if(this._center=this._startLatLng,lt===1)return}else{var ft=et._add(ot)._divideBy(2)._subtract(this._centerPoint);if(lt===1&&ft.x===0&&ft.y===0)return;this._center=V.unproject(V.project(this._pinchStartLatLng,this._zoom).subtract(ft),this._zoom)}this._moved||(V._moveStart(!0,!1),this._moved=!0),Ut(this._animRequest);var pt=nt(V._move,V,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Vt(pt,this,!0),pe(r)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Ut(this._animRequest),le(document,"touchmove",this._onTouchMove,this),le(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});re.addInitHook("addHandler","touchZoom",ao),re.BoxZoom=eo,re.DoubleClickZoom=no,re.Drag=io,re.Keyboard=oo,re.ScrollWheelZoom=ro,re.TapHold=so,re.TouchZoom=ao,W.Bounds=Zt,W.Browser=Wt,W.CRS=se,W.Canvas=Ji,W.Circle=ei,W.CircleMarker=bn,W.Class=mt,W.Control=we,W.DivIcon=Yi,W.DivOverlay=Pe,W.DomEvent=Go,W.DomUtil=Fo,W.Draggable=ze,W.Evented=At,W.FeatureGroup=Te,W.GeoJSON=Ie,W.GridLayer=ln,W.Handler=Ce,W.Icon=Ve,W.ImageOverlay=Sn,W.LatLng=Ft,W.LatLngBounds=Yt,W.Layer=xe,W.LayerGroup=We,W.LineUtil=tr,W.Map=re,W.Marker=yn,W.Mixin=jo,W.Path=Ne,W.Point=Et,W.PolyUtil=er,W.Polygon=Xe,W.Polyline=Me,W.Popup=Cn,W.PosAnimation=Ii,W.Projection=nr,W.Rectangle=to,W.Renderer=Ee,W.SVG=cn,W.SVGOverlay=Xi,W.TileLayer=je,W.Tooltip=Pn,W.Transformation=Qt,W.Util=oe,W.VideoOverlay=Vi,W.bind=nt,W.bounds=Xt,W.canvas=Qi,W.circle=cr,W.circleMarker=ur,W.control=rn,W.divIcon=yr,W.extend=tt,W.featureGroup=sr,W.geoJSON=Wi,W.geoJson=dr,W.gridLayer=br,W.icon=ar,W.imageOverlay=_r,W.latLng=te,W.latLngBounds=qt,W.layerGroup=rr,W.map=Uo,W.marker=lr,W.point=Mt,W.polygon=fr,W.polyline=hr,W.popup=gr,W.rectangle=Lr,W.setOptions=_t,W.stamp=rt,W.svg=$i,W.svgOverlay=mr,W.tileLayer=ji,W.tooltip=vr,W.transformation=_e,W.version=X,W.videoOverlay=pr;var Sr=window.L;W.noConflict=function(){return window.L=Sr,this},window.L=W})})(leafletSrc,leafletSrcExports);var leaflet_markerclusterSrcExports={},leaflet_markerclusterSrc={get exports(){return leaflet_markerclusterSrcExports},set exports(Z){leaflet_markerclusterSrcExports=Z}};(function(Z,U){(function(W,X){X(U)})(commonjsGlobal,function(W){var X=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(Y){L.Util.setOptions(this,Y),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var nt=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,nt?this._withAnimation:this._noAnimation),this._markerCluster=nt?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(Y){if(Y instanceof L.LayerGroup)return this.addLayers([Y]);if(!Y.getLatLng)return this._nonPointGroup.addLayer(Y),this.fire("layeradd",{layer:Y}),this;if(!this._map)return this._needsClustering.push(Y),this.fire("layeradd",{layer:Y}),this;if(this.hasLayer(Y))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(Y,this._maxZoom),this.fire("layeradd",{layer:Y}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var nt=Y,it=this._zoom;if(Y.__parent)for(;nt.__parent._zoom>=it;)nt=nt.__parent;return this._currentShownBounds.contains(nt.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(Y,nt):this._animationAddLayerNonAnimated(Y,nt)),this},removeLayer:function(Y){return Y instanceof L.LayerGroup?this.removeLayers([Y]):Y.getLatLng?this._map?Y.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(Y)),this._removeLayer(Y,!0),this.fire("layerremove",{layer:Y}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),Y.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(Y)&&(this._featureGroup.removeLayer(Y),Y.clusterShow&&Y.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,Y)&&this.hasLayer(Y)&&this._needsRemoving.push({layer:Y,latlng:Y._latlng}),this.fire("layerremove",{layer:Y}),this):(this._nonPointGroup.removeLayer(Y),this.fire("layerremove",{layer:Y}),this)},addLayers:function(Y,nt){if(!L.Util.isArray(Y))return this.addLayer(Y);var it=this._featureGroup,rt=this._nonPointGroup,st=this.options.chunkedLoading,at=this.options.chunkInterval,ct=this.options.chunkProgress,ht=Y.length,ut=0,dt=!0,_t;if(this._map){var kt=new Date().getTime(),gt=L.bind(function(){var Ot=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();ut<ht;ut++){if(st&&ut%200===0){var Lt=new Date().getTime()-Ot;if(Lt>at)break}if(_t=Y[ut],_t instanceof L.LayerGroup){dt&&(Y=Y.slice(),dt=!1),this._extractNonGroupLayers(_t,Y),ht=Y.length;continue}if(!_t.getLatLng){rt.addLayer(_t),nt||this.fire("layeradd",{layer:_t});continue}if(!this.hasLayer(_t)&&(this._addLayer(_t,this._maxZoom),nt||this.fire("layeradd",{layer:_t}),_t.__parent&&_t.__parent.getChildCount()===2)){var vt=_t.__parent.getAllChildMarkers(),bt=vt[0]===_t?vt[1]:vt[0];it.removeLayer(bt)}}ct&&ct(ut,ht,new Date().getTime()-kt),ut===ht?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(gt,this.options.chunkDelay)},this);gt()}else for(var Tt=this._needsClustering;ut<ht;ut++){if(_t=Y[ut],_t instanceof L.LayerGroup){dt&&(Y=Y.slice(),dt=!1),this._extractNonGroupLayers(_t,Y),ht=Y.length;continue}if(!_t.getLatLng){rt.addLayer(_t);continue}this.hasLayer(_t)||Tt.push(_t)}return this},removeLayers:function(Y){var nt,it,rt=Y.length,st=this._featureGroup,at=this._nonPointGroup,ct=!0;if(!this._map){for(nt=0;nt<rt;nt++){if(it=Y[nt],it instanceof L.LayerGroup){ct&&(Y=Y.slice(),ct=!1),this._extractNonGroupLayers(it,Y),rt=Y.length;continue}this._arraySplice(this._needsClustering,it),at.removeLayer(it),this.hasLayer(it)&&this._needsRemoving.push({layer:it,latlng:it._latlng}),this.fire("layerremove",{layer:it})}return this}if(this._unspiderfy){this._unspiderfy();var ht=Y.slice(),ut=rt;for(nt=0;nt<ut;nt++){if(it=ht[nt],it instanceof L.LayerGroup){this._extractNonGroupLayers(it,ht),ut=ht.length;continue}this._unspiderfyLayer(it)}}for(nt=0;nt<rt;nt++){if(it=Y[nt],it instanceof L.LayerGroup){ct&&(Y=Y.slice(),ct=!1),this._extractNonGroupLayers(it,Y),rt=Y.length;continue}if(!it.__parent){at.removeLayer(it),this.fire("layerremove",{layer:it});continue}this._removeLayer(it,!0,!0),this.fire("layerremove",{layer:it}),st.hasLayer(it)&&(st.removeLayer(it),it.clusterShow&&it.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(Y){Y.off(this._childMarkerEventHandlers,this),delete Y.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var Y=new L.LatLngBounds;this._topClusterLevel&&Y.extend(this._topClusterLevel._bounds);for(var nt=this._needsClustering.length-1;nt>=0;nt--)Y.extend(this._needsClustering[nt].getLatLng());return Y.extend(this._nonPointGroup.getBounds()),Y},eachLayer:function(Y,nt){var it=this._needsClustering.slice(),rt=this._needsRemoving,st,at,ct;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(it),at=it.length-1;at>=0;at--){for(st=!0,ct=rt.length-1;ct>=0;ct--)if(rt[ct].layer===it[at]){st=!1;break}st&&Y.call(nt,it[at])}this._nonPointGroup.eachLayer(Y,nt)},getLayers:function(){var Y=[];return this.eachLayer(function(nt){Y.push(nt)}),Y},getLayer:function(Y){var nt=null;return Y=parseInt(Y,10),this.eachLayer(function(it){L.stamp(it)===Y&&(nt=it)}),nt},hasLayer:function(Y){if(!Y)return!1;var nt,it=this._needsClustering;for(nt=it.length-1;nt>=0;nt--)if(it[nt]===Y)return!0;for(it=this._needsRemoving,nt=it.length-1;nt>=0;nt--)if(it[nt].layer===Y)return!1;return!!(Y.__parent&&Y.__parent._group===this)||this._nonPointGroup.hasLayer(Y)},zoomToShowLayer:function(Y,nt){var it=this._map;typeof nt!="function"&&(nt=function(){});var rt=function(){(it.hasLayer(Y)||it.hasLayer(Y.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",rt,this),this.off("animationend",rt,this),it.hasLayer(Y)?nt():Y.__parent._icon&&(this.once("spiderfied",nt,this),Y.__parent.spiderfy()))};Y._icon&&this._map.getBounds().contains(Y.getLatLng())?nt():Y.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",rt,this),this._map.panTo(Y.getLatLng())):(this._map.on("moveend",rt,this),this.on("animationend",rt,this),Y.__parent.zoomToBounds())},onAdd:function(Y){this._map=Y;var nt,it,rt;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(Y),this._nonPointGroup.addTo(Y),this._gridClusters||this._generateInitialClusters(),this._maxLat=Y.options.crs.projection.MAX_LATITUDE,nt=0,it=this._needsRemoving.length;nt<it;nt++)rt=this._needsRemoving[nt],rt.newlatlng=rt.layer._latlng,rt.layer._latlng=rt.latlng;for(nt=0,it=this._needsRemoving.length;nt<it;nt++)rt=this._needsRemoving[nt],this._removeLayer(rt.layer,!0),rt.layer._latlng=rt.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),it=this._needsClustering,this._needsClustering=[],this.addLayers(it,!0)},onRemove:function(Y){Y.off("zoomend",this._zoomEnd,this),Y.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(Y){for(var nt=Y;nt&&!nt._icon;)nt=nt.__parent;return nt||null},_arraySplice:function(Y,nt){for(var it=Y.length-1;it>=0;it--)if(Y[it]===nt)return Y.splice(it,1),!0},_removeFromGridUnclustered:function(Y,nt){for(var it=this._map,rt=this._gridUnclustered,st=Math.floor(this._map.getMinZoom());nt>=st&&rt[nt].removeObject(Y,it.project(Y.getLatLng(),nt));nt--);},_childMarkerDragStart:function(Y){Y.target.__dragStart=Y.target._latlng},_childMarkerMoved:function(Y){if(!this._ignoreMove&&!Y.target.__dragStart){var nt=Y.target._popup&&Y.target._popup.isOpen();this._moveChild(Y.target,Y.oldLatLng,Y.latlng),nt&&Y.target.openPopup()}},_moveChild:function(Y,nt,it){Y._latlng=nt,this.removeLayer(Y),Y._latlng=it,this.addLayer(Y)},_childMarkerDragEnd:function(Y){var nt=Y.target.__dragStart;delete Y.target.__dragStart,nt&&this._moveChild(Y.target,nt,Y.target._latlng)},_removeLayer:function(Y,nt,it){var rt=this._gridClusters,st=this._gridUnclustered,at=this._featureGroup,ct=this._map,ht=Math.floor(this._map.getMinZoom());nt&&this._removeFromGridUnclustered(Y,this._maxZoom);var ut=Y.__parent,dt=ut._markers,_t;for(this._arraySplice(dt,Y);ut&&(ut._childCount--,ut._boundsNeedUpdate=!0,!(ut._zoom<ht));)nt&&ut._childCount<=1?(_t=ut._markers[0]===Y?ut._markers[1]:ut._markers[0],rt[ut._zoom].removeObject(ut,ct.project(ut._cLatLng,ut._zoom)),st[ut._zoom].addObject(_t,ct.project(_t.getLatLng(),ut._zoom)),this._arraySplice(ut.__parent._childClusters,ut),ut.__parent._markers.push(_t),_t.__parent=ut.__parent,ut._icon&&(at.removeLayer(ut),it||at.addLayer(_t))):ut._iconNeedsUpdate=!0,ut=ut.__parent;delete Y.__parent},_isOrIsParent:function(Y,nt){for(;nt;){if(Y===nt)return!0;nt=nt.parentNode}return!1},fire:function(Y,nt,it){if(nt&&nt.layer instanceof L.MarkerCluster){if(nt.originalEvent&&this._isOrIsParent(nt.layer._icon,nt.originalEvent.relatedTarget))return;Y="cluster"+Y}L.FeatureGroup.prototype.fire.call(this,Y,nt,it)},listens:function(Y,nt){return L.FeatureGroup.prototype.listens.call(this,Y,nt)||L.FeatureGroup.prototype.listens.call(this,"cluster"+Y,nt)},_defaultIconCreateFunction:function(Y){var nt=Y.getChildCount(),it=" marker-cluster-";return nt<10?it+="small":nt<100?it+="medium":it+="large",new L.DivIcon({html:"<div><span>"+nt+"</span></div>",className:"marker-cluster"+it,iconSize:new L.Point(40,40)})},_bindEvents:function(){var Y=this._map,nt=this.options.spiderfyOnMaxZoom,it=this.options.showCoverageOnHover,rt=this.options.zoomToBoundsOnClick,st=this.options.spiderfyOnEveryZoom;(nt||rt||st)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),it&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),Y.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(Y){var nt=Y.layer,it=nt;if(!(Y.type==="clusterkeypress"&&Y.originalEvent&&Y.originalEvent.keyCode!==13)){for(;it._childClusters.length===1;)it=it._childClusters[0];it._zoom===this._maxZoom&&it._childCount===nt._childCount&&this.options.spiderfyOnMaxZoom?nt.spiderfy():this.options.zoomToBoundsOnClick&&nt.zoomToBounds(),this.options.spiderfyOnEveryZoom&&nt.spiderfy(),Y.originalEvent&&Y.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(Y){var nt=this._map;this._inZoomAnimation||(this._shownPolygon&&nt.removeLayer(this._shownPolygon),Y.layer.getChildCount()>2&&Y.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(Y.layer.getConvexHull(),this.options.polygonOptions),nt.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var Y=this.options.spiderfyOnMaxZoom,nt=this.options.showCoverageOnHover,it=this.options.zoomToBoundsOnClick,rt=this.options.spiderfyOnEveryZoom,st=this._map;(Y||it||rt)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),nt&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),st.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var Y=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,Y),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),Y),this._currentShownBounds=Y}},_generateInitialClusters:function(){var Y=Math.ceil(this._map.getMaxZoom()),nt=Math.floor(this._map.getMinZoom()),it=this.options.maxClusterRadius,rt=it;typeof it!="function"&&(rt=function(){return it}),this.options.disableClusteringAtZoom!==null&&(Y=this.options.disableClusteringAtZoom-1),this._maxZoom=Y,this._gridClusters={},this._gridUnclustered={};for(var st=Y;st>=nt;st--)this._gridClusters[st]=new L.DistanceGrid(rt(st)),this._gridUnclustered[st]=new L.DistanceGrid(rt(st));this._topClusterLevel=new this._markerCluster(this,nt-1)},_addLayer:function(Y,nt){var it=this._gridClusters,rt=this._gridUnclustered,st=Math.floor(this._map.getMinZoom()),at,ct;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(Y),Y.on(this._childMarkerEventHandlers,this);nt>=st;nt--){at=this._map.project(Y.getLatLng(),nt);var ht=it[nt].getNearObject(at);if(ht){ht._addChild(Y),Y.__parent=ht;return}if(ht=rt[nt].getNearObject(at),ht){var ut=ht.__parent;ut&&this._removeLayer(ht,!1);var dt=new this._markerCluster(this,nt,ht,Y);it[nt].addObject(dt,this._map.project(dt._cLatLng,nt)),ht.__parent=dt,Y.__parent=dt;var _t=dt;for(ct=nt-1;ct>ut._zoom;ct--)_t=new this._markerCluster(this,ct,_t),it[ct].addObject(_t,this._map.project(ht.getLatLng(),ct));ut._addChild(_t),this._removeFromGridUnclustered(ht,nt);return}rt[nt].addObject(Y,at)}this._topClusterLevel._addChild(Y),Y.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(Y){Y instanceof L.MarkerCluster&&Y._iconNeedsUpdate&&Y._updateIcon()})},_enqueue:function(Y){this._queue.push(Y),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var Y=0;Y<this._queue.length;Y++)this._queue[Y].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var Y=Math.round(this._map._zoom);this._processQueue(),this._zoom<Y&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,Y)):this._zoom>Y?(this._animationStart(),this._animationZoomOut(this._zoom,Y)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(Y){var nt=this._maxLat;return nt!==void 0&&(Y.getNorth()>=nt&&(Y._northEast.lat=1/0),Y.getSouth()<=-nt&&(Y._southWest.lat=-1/0)),Y},_animationAddLayerNonAnimated:function(Y,nt){if(nt===Y)this._featureGroup.addLayer(Y);else if(nt._childCount===2){nt._addToMap();var it=nt.getAllChildMarkers();this._featureGroup.removeLayer(it[0]),this._featureGroup.removeLayer(it[1])}else nt._updateIcon()},_extractNonGroupLayers:function(Y,nt){var it=Y.getLayers(),rt=0,st;for(nt=nt||[];rt<it.length;rt++){if(st=it[rt],st instanceof L.LayerGroup){this._extractNonGroupLayers(st,nt);continue}nt.push(st)}return nt},_overrideMarkerIcon:function(Y){var nt=Y.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[Y]}});return nt}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(Y,nt){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),Y),this._topClusterLevel._recursivelyAddChildrenToMap(null,nt,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(Y,nt){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),Y),this._topClusterLevel._recursivelyAddChildrenToMap(null,nt,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(Y,nt){this._animationAddLayerNonAnimated(Y,nt)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(Y,nt){var it=this._getExpandedVisibleBounds(),rt=this._featureGroup,st=Math.floor(this._map.getMinZoom()),at;this._ignoreMove=!0,this._topClusterLevel._recursively(it,Y,st,function(ct){var ht=ct._latlng,ut=ct._markers,dt;for(it.contains(ht)||(ht=null),ct._isSingleParent()&&Y+1===nt?(rt.removeLayer(ct),ct._recursivelyAddChildrenToMap(null,nt,it)):(ct.clusterHide(),ct._recursivelyAddChildrenToMap(ht,nt,it)),at=ut.length-1;at>=0;at--)dt=ut[at],it.contains(dt._latlng)||rt.removeLayer(dt)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(it,nt),rt.eachLayer(function(ct){!(ct instanceof L.MarkerCluster)&&ct._icon&&ct.clusterShow()}),this._topClusterLevel._recursively(it,Y,nt,function(ct){ct._recursivelyRestoreChildPositions(nt)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(it,Y,st,function(ct){rt.removeLayer(ct),ct.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(Y,nt){this._animationZoomOutSingle(this._topClusterLevel,Y-1,nt),this._topClusterLevel._recursivelyAddChildrenToMap(null,nt,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),Y,this._getExpandedVisibleBounds())},_animationAddLayer:function(Y,nt){var it=this,rt=this._featureGroup;rt.addLayer(Y),nt!==Y&&(nt._childCount>2?(nt._updateIcon(),this._forceLayout(),this._animationStart(),Y._setPos(this._map.latLngToLayerPoint(nt.getLatLng())),Y.clusterHide(),this._enqueue(function(){rt.removeLayer(Y),Y.clusterShow(),it._animationEnd()})):(this._forceLayout(),it._animationStart(),it._animationZoomOutSingle(nt,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(Y,nt,it){var rt=this._getExpandedVisibleBounds(),st=Math.floor(this._map.getMinZoom());Y._recursivelyAnimateChildrenInAndAddSelfToMap(rt,st,nt+1,it);var at=this;this._forceLayout(),Y._recursivelyBecomeVisible(rt,it),this._enqueue(function(){if(Y._childCount===1){var ct=Y._markers[0];this._ignoreMove=!0,ct.setLatLng(ct.getLatLng()),this._ignoreMove=!1,ct.clusterShow&&ct.clusterShow()}else Y._recursively(rt,it,st,function(ht){ht._recursivelyRemoveChildrenFromMap(rt,st,nt+1)});at._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(Y){return new L.MarkerClusterGroup(Y)};var tt=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(Y,nt,it,rt){L.Marker.prototype.initialize.call(this,it?it._cLatLng||it.getLatLng():new L.LatLng(0,0),{icon:this,pane:Y.options.clusterPane}),this._group=Y,this._zoom=nt,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,it&&this._addChild(it),rt&&this._addChild(rt)},getAllChildMarkers:function(Y,nt){Y=Y||[];for(var it=this._childClusters.length-1;it>=0;it--)this._childClusters[it].getAllChildMarkers(Y,nt);for(var rt=this._markers.length-1;rt>=0;rt--)nt&&this._markers[rt].__dragStart||Y.push(this._markers[rt]);return Y},getChildCount:function(){return this._childCount},zoomToBounds:function(Y){for(var nt=this._childClusters.slice(),it=this._group._map,rt=it.getBoundsZoom(this._bounds),st=this._zoom+1,at=it.getZoom(),ct;nt.length>0&&rt>st;){st++;var ht=[];for(ct=0;ct<nt.length;ct++)ht=ht.concat(nt[ct]._childClusters);nt=ht}rt>st?this._group._map.setView(this._latlng,st):rt<=at?this._group._map.setView(this._latlng,at+1):this._group._map.fitBounds(this._bounds,Y)},getBounds:function(){var Y=new L.LatLngBounds;return Y.extend(this._bounds),Y},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(Y,nt){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(Y),Y instanceof L.MarkerCluster?(nt||(this._childClusters.push(Y),Y.__parent=this),this._childCount+=Y._childCount):(nt||this._markers.push(Y),this._childCount++),this.__parent&&this.__parent._addChild(Y,!0)},_setClusterCenter:function(Y){this._cLatLng||(this._cLatLng=Y._cLatLng||Y._latlng)},_resetBounds:function(){var Y=this._bounds;Y._southWest&&(Y._southWest.lat=1/0,Y._southWest.lng=1/0),Y._northEast&&(Y._northEast.lat=-1/0,Y._northEast.lng=-1/0)},_recalculateBounds:function(){var Y=this._markers,nt=this._childClusters,it=0,rt=0,st=this._childCount,at,ct,ht,ut;if(st!==0){for(this._resetBounds(),at=0;at<Y.length;at++)ht=Y[at]._latlng,this._bounds.extend(ht),it+=ht.lat,rt+=ht.lng;for(at=0;at<nt.length;at++)ct=nt[at],ct._boundsNeedUpdate&&ct._recalculateBounds(),this._bounds.extend(ct._bounds),ht=ct._wLatLng,ut=ct._childCount,it+=ht.lat*ut,rt+=ht.lng*ut;this._latlng=this._wLatLng=new L.LatLng(it/st,rt/st),this._boundsNeedUpdate=!1}},_addToMap:function(Y){Y&&(this._backupLatlng=this._latlng,this.setLatLng(Y)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(Y,nt,it){this._recursively(Y,this._group._map.getMinZoom(),it-1,function(rt){var st=rt._markers,at,ct;for(at=st.length-1;at>=0;at--)ct=st[at],ct._icon&&(ct._setPos(nt),ct.clusterHide())},function(rt){var st=rt._childClusters,at,ct;for(at=st.length-1;at>=0;at--)ct=st[at],ct._icon&&(ct._setPos(nt),ct.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(Y,nt,it,rt){this._recursively(Y,rt,nt,function(st){st._recursivelyAnimateChildrenIn(Y,st._group._map.latLngToLayerPoint(st.getLatLng()).round(),it),st._isSingleParent()&&it-1===rt?(st.clusterShow(),st._recursivelyRemoveChildrenFromMap(Y,nt,it)):st.clusterHide(),st._addToMap()})},_recursivelyBecomeVisible:function(Y,nt){this._recursively(Y,this._group._map.getMinZoom(),nt,null,function(it){it.clusterShow()})},_recursivelyAddChildrenToMap:function(Y,nt,it){this._recursively(it,this._group._map.getMinZoom()-1,nt,function(rt){if(nt!==rt._zoom)for(var st=rt._markers.length-1;st>=0;st--){var at=rt._markers[st];it.contains(at._latlng)&&(Y&&(at._backupLatlng=at.getLatLng(),at.setLatLng(Y),at.clusterHide&&at.clusterHide()),rt._group._featureGroup.addLayer(at))}},function(rt){rt._addToMap(Y)})},_recursivelyRestoreChildPositions:function(Y){for(var nt=this._markers.length-1;nt>=0;nt--){var it=this._markers[nt];it._backupLatlng&&(it.setLatLng(it._backupLatlng),delete it._backupLatlng)}if(Y-1===this._zoom)for(var rt=this._childClusters.length-1;rt>=0;rt--)this._childClusters[rt]._restorePosition();else for(var st=this._childClusters.length-1;st>=0;st--)this._childClusters[st]._recursivelyRestoreChildPositions(Y)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(Y,nt,it,rt){var st,at;this._recursively(Y,nt-1,it-1,function(ct){for(at=ct._markers.length-1;at>=0;at--)st=ct._markers[at],(!rt||!rt.contains(st._latlng))&&(ct._group._featureGroup.removeLayer(st),st.clusterShow&&st.clusterShow())},function(ct){for(at=ct._childClusters.length-1;at>=0;at--)st=ct._childClusters[at],(!rt||!rt.contains(st._latlng))&&(ct._group._featureGroup.removeLayer(st),st.clusterShow&&st.clusterShow())})},_recursively:function(Y,nt,it,rt,st){var at=this._childClusters,ct=this._zoom,ht,ut;if(nt<=ct&&(rt&&rt(this),st&&ct===it&&st(this)),ct<nt||ct<it)for(ht=at.length-1;ht>=0;ht--)ut=at[ht],ut._boundsNeedUpdate&&ut._recalculateBounds(),Y.intersects(ut._bounds)&&ut._recursively(Y,nt,it,rt,st)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var Y=this.options.opacity;return this.setOpacity(0),this.options.opacity=Y,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(Y){this._cellSize=Y,this._sqCellSize=Y*Y,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(Y,nt){var it=this._getCoord(nt.x),rt=this._getCoord(nt.y),st=this._grid,at=st[rt]=st[rt]||{},ct=at[it]=at[it]||[],ht=L.Util.stamp(Y);this._objectPoint[ht]=nt,ct.push(Y)},updateObject:function(Y,nt){this.removeObject(Y),this.addObject(Y,nt)},removeObject:function(Y,nt){var it=this._getCoord(nt.x),rt=this._getCoord(nt.y),st=this._grid,at=st[rt]=st[rt]||{},ct=at[it]=at[it]||[],ht,ut;for(delete this._objectPoint[L.Util.stamp(Y)],ht=0,ut=ct.length;ht<ut;ht++)if(ct[ht]===Y)return ct.splice(ht,1),ut===1&&delete at[it],!0},eachObject:function(Y,nt){var it,rt,st,at,ct,ht,ut,dt=this._grid;for(it in dt){ct=dt[it];for(rt in ct)for(ht=ct[rt],st=0,at=ht.length;st<at;st++)ut=Y.call(nt,ht[st]),ut&&(st--,at--)}},getNearObject:function(Y){var nt=this._getCoord(Y.x),it=this._getCoord(Y.y),rt,st,at,ct,ht,ut,dt,_t,kt=this._objectPoint,gt=this._sqCellSize,Tt=null;for(rt=it-1;rt<=it+1;rt++)if(ct=this._grid[rt],ct){for(st=nt-1;st<=nt+1;st++)if(ht=ct[st],ht)for(at=0,ut=ht.length;at<ut;at++)dt=ht[at],_t=this._sqDist(kt[L.Util.stamp(dt)],Y),(_t<gt||_t<=gt&&Tt===null)&&(gt=_t,Tt=dt)}return Tt},_getCoord:function(Y){var nt=Math.floor(Y/this._cellSize);return isFinite(nt)?nt:Y},_sqDist:function(Y,nt){var it=nt.x-Y.x,rt=nt.y-Y.y;return it*it+rt*rt}},function(){L.QuickHull={getDistant:function(Y,nt){var it=nt[1].lat-nt[0].lat,rt=nt[0].lng-nt[1].lng;return rt*(Y.lat-nt[0].lat)+it*(Y.lng-nt[0].lng)},findMostDistantPointFromBaseLine:function(Y,nt){var it=0,rt=null,st=[],at,ct,ht;for(at=nt.length-1;at>=0;at--){if(ct=nt[at],ht=this.getDistant(ct,Y),ht>0)st.push(ct);else continue;ht>it&&(it=ht,rt=ct)}return{maxPoint:rt,newPoints:st}},buildConvexHull:function(Y,nt){var it=[],rt=this.findMostDistantPointFromBaseLine(Y,nt);return rt.maxPoint?(it=it.concat(this.buildConvexHull([Y[0],rt.maxPoint],rt.newPoints)),it=it.concat(this.buildConvexHull([rt.maxPoint,Y[1]],rt.newPoints)),it):[Y[0]]},getConvexHull:function(Y){var nt=!1,it=!1,rt=!1,st=!1,at=null,ct=null,ht=null,ut=null,dt=null,_t=null,kt;for(kt=Y.length-1;kt>=0;kt--){var gt=Y[kt];(nt===!1||gt.lat>nt)&&(at=gt,nt=gt.lat),(it===!1||gt.lat<it)&&(ct=gt,it=gt.lat),(rt===!1||gt.lng>rt)&&(ht=gt,rt=gt.lng),(st===!1||gt.lng<st)&&(ut=gt,st=gt.lng)}it!==nt?(_t=ct,dt=at):(_t=ut,dt=ht);var Tt=[].concat(this.buildConvexHull([_t,dt],Y),this.buildConvexHull([dt,_t],Y));return Tt}}}(),L.MarkerCluster.include({getConvexHull:function(){var Y=this.getAllChildMarkers(),nt=[],it,rt;for(rt=Y.length-1;rt>=0;rt--)it=Y[rt].getLatLng(),nt.push(it);return L.QuickHull.getConvexHull(nt)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var Y=this.getAllChildMarkers(null,!0),nt=this._group,it=nt._map,rt=it.latLngToLayerPoint(this._latlng),st;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?st=this._group.options.spiderfyShapePositions(Y.length,rt):Y.length>=this._circleSpiralSwitchover?st=this._generatePointsSpiral(Y.length,rt):(rt.y+=10,st=this._generatePointsCircle(Y.length,rt)),this._animationSpiderfy(Y,st)}},unspiderfy:function(Y){this._group._inZoomAnimation||(this._animationUnspiderfy(Y),this._group._spiderfied=null)},_generatePointsCircle:function(Y,nt){var it=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+Y),rt=it/this._2PI,st=this._2PI/Y,at=[],ct,ht;for(rt=Math.max(rt,35),at.length=Y,ct=0;ct<Y;ct++)ht=this._circleStartAngle+ct*st,at[ct]=new L.Point(nt.x+rt*Math.cos(ht),nt.y+rt*Math.sin(ht))._round();return at},_generatePointsSpiral:function(Y,nt){var it=this._group.options.spiderfyDistanceMultiplier,rt=it*this._spiralLengthStart,st=it*this._spiralFootSeparation,at=it*this._spiralLengthFactor*this._2PI,ct=0,ht=[],ut;for(ht.length=Y,ut=Y;ut>=0;ut--)ut<Y&&(ht[ut]=new L.Point(nt.x+rt*Math.cos(ct),nt.y+rt*Math.sin(ct))._round()),ct+=st/rt+ut*5e-4,rt+=at/ct;return ht},_noanimationUnspiderfy:function(){var Y=this._group,nt=Y._map,it=Y._featureGroup,rt=this.getAllChildMarkers(null,!0),st,at;for(Y._ignoreMove=!0,this.setOpacity(1),at=rt.length-1;at>=0;at--)st=rt[at],it.removeLayer(st),st._preSpiderfyLatlng&&(st.setLatLng(st._preSpiderfyLatlng),delete st._preSpiderfyLatlng),st.setZIndexOffset&&st.setZIndexOffset(0),st._spiderLeg&&(nt.removeLayer(st._spiderLeg),delete st._spiderLeg);Y.fire("unspiderfied",{cluster:this,markers:rt}),Y._ignoreMove=!1,Y._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(Y,nt){var it=this._group,rt=it._map,st=it._featureGroup,at=this._group.options.spiderLegPolylineOptions,ct,ht,ut,dt;for(it._ignoreMove=!0,ct=0;ct<Y.length;ct++)dt=rt.layerPointToLatLng(nt[ct]),ht=Y[ct],ut=new L.Polyline([this._latlng,dt],at),rt.addLayer(ut),ht._spiderLeg=ut,ht._preSpiderfyLatlng=ht._latlng,ht.setLatLng(dt),ht.setZIndexOffset&&ht.setZIndexOffset(1e6),st.addLayer(ht);this.setOpacity(.3),it._ignoreMove=!1,it.fire("spiderfied",{cluster:this,markers:Y})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(Y,nt){var it=this,rt=this._group,st=rt._map,at=rt._featureGroup,ct=this._latlng,ht=st.latLngToLayerPoint(ct),ut=L.Path.SVG,dt=L.extend({},this._group.options.spiderLegPolylineOptions),_t=dt.opacity,kt,gt,Tt,Ot,Lt,vt;for(_t===void 0&&(_t=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),ut?(dt.opacity=0,dt.className=(dt.className||"")+" leaflet-cluster-spider-leg"):dt.opacity=_t,rt._ignoreMove=!0,kt=0;kt<Y.length;kt++)gt=Y[kt],vt=st.layerPointToLatLng(nt[kt]),Tt=new L.Polyline([ct,vt],dt),st.addLayer(Tt),gt._spiderLeg=Tt,ut&&(Ot=Tt._path,Lt=Ot.getTotalLength()+.1,Ot.style.strokeDasharray=Lt,Ot.style.strokeDashoffset=Lt),gt.setZIndexOffset&&gt.setZIndexOffset(1e6),gt.clusterHide&&gt.clusterHide(),at.addLayer(gt),gt._setPos&&gt._setPos(ht);for(rt._forceLayout(),rt._animationStart(),kt=Y.length-1;kt>=0;kt--)vt=st.layerPointToLatLng(nt[kt]),gt=Y[kt],gt._preSpiderfyLatlng=gt._latlng,gt.setLatLng(vt),gt.clusterShow&&gt.clusterShow(),ut&&(Tt=gt._spiderLeg,Ot=Tt._path,Ot.style.strokeDashoffset=0,Tt.setStyle({opacity:_t}));this.setOpacity(.3),rt._ignoreMove=!1,setTimeout(function(){rt._animationEnd(),rt.fire("spiderfied",{cluster:it,markers:Y})},200)},_animationUnspiderfy:function(Y){var nt=this,it=this._group,rt=it._map,st=it._featureGroup,at=Y?rt._latLngToNewLayerPoint(this._latlng,Y.zoom,Y.center):rt.latLngToLayerPoint(this._latlng),ct=this.getAllChildMarkers(null,!0),ht=L.Path.SVG,ut,dt,_t,kt,gt,Tt;for(it._ignoreMove=!0,it._animationStart(),this.setOpacity(1),dt=ct.length-1;dt>=0;dt--)ut=ct[dt],ut._preSpiderfyLatlng&&(ut.closePopup(),ut.setLatLng(ut._preSpiderfyLatlng),delete ut._preSpiderfyLatlng,Tt=!0,ut._setPos&&(ut._setPos(at),Tt=!1),ut.clusterHide&&(ut.clusterHide(),Tt=!1),Tt&&st.removeLayer(ut),ht&&(_t=ut._spiderLeg,kt=_t._path,gt=kt.getTotalLength()+.1,kt.style.strokeDashoffset=gt,_t.setStyle({opacity:0})));it._ignoreMove=!1,setTimeout(function(){var Ot=0;for(dt=ct.length-1;dt>=0;dt--)ut=ct[dt],ut._spiderLeg&&Ot++;for(dt=ct.length-1;dt>=0;dt--)ut=ct[dt],ut._spiderLeg&&(ut.clusterShow&&ut.clusterShow(),ut.setZIndexOffset&&ut.setZIndexOffset(0),Ot>1&&st.removeLayer(ut),rt.removeLayer(ut._spiderLeg),delete ut._spiderLeg);it._animationEnd(),it.fire("unspiderfied",{cluster:nt,markers:ct})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(Y){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(Y))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(Y){this._spiderfied&&this._spiderfied.unspiderfy(Y)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(Y){Y._spiderLeg&&(this._featureGroup.removeLayer(Y),Y.clusterShow&&Y.clusterShow(),Y.setZIndexOffset&&Y.setZIndexOffset(0),this._map.removeLayer(Y._spiderLeg),delete Y._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(Y){return Y?Y instanceof L.MarkerClusterGroup?Y=Y._topClusterLevel.getAllChildMarkers():Y instanceof L.LayerGroup?Y=Y._layers:Y instanceof L.MarkerCluster?Y=Y.getAllChildMarkers():Y instanceof L.Marker&&(Y=[Y]):Y=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(Y),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(Y),this},_flagParentsIconsNeedUpdate:function(Y){var nt,it;for(nt in Y)for(it=Y[nt].__parent;it;)it._iconNeedsUpdate=!0,it=it.__parent},_refreshSingleMarkerModeMarkers:function(Y){var nt,it;for(nt in Y)it=Y[nt],this.hasLayer(it)&&it.setIcon(this._overrideMarkerIcon(it))}}),L.Marker.include({refreshIconOptions:function(Y,nt){var it=this.options.icon;return L.setOptions(it,Y),this.setIcon(it),nt&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),W.MarkerClusterGroup=X,W.MarkerCluster=tt,Object.defineProperty(W,"__esModule",{value:!0})})})(leaflet_markerclusterSrc,leaflet_markerclusterSrcExports);const MarkerCluster="",MarkerCluster_Default="",subscriber_queue=[];function writable(Z,U=noop$1){let W;const X=new Set;function tt(it){if(safe_not_equal(Z,it)&&(Z=it,W)){const rt=!subscriber_queue.length;for(const st of X)st[1](),subscriber_queue.push(st,Z);if(rt){for(let st=0;st<subscriber_queue.length;st+=2)subscriber_queue[st][0](subscriber_queue[st+1]);subscriber_queue.length=0}}}function Y(it){tt(it(Z))}function nt(it,rt=noop$1){const st=[it,rt];return X.add(st),X.size===1&&(W=U(tt)||noop$1),it(Z),()=>{X.delete(st),X.size===0&&W&&(W(),W=null)}}return{set:tt,update:Y,subscribe:nt}}const retrieved=localStorage.getItem("storedFeatures"),parsed=JSON.parse(retrieved),selectedFeatures=writable(parsed===null?[]:parsed);selectedFeatures.subscribe(Z=>{localStorage.setItem("storedFeatures",JSON.stringify(Z))});function create_fragment$o(Z){let U,W,X,tt,Y,nt,it,rt,st,at,ct,ht,ut,dt,_t,kt;return{c(){U=element("div"),W=element("h3"),X=space(),tt=element("p"),Y=text(Z[1]),nt=space(),it=element("a"),rt=text("Link to article"),st=space(),at=element("p"),ct=space(),ht=element("br"),ut=space(),dt=element("button"),dt.textContent="Add to list",attr(it,"href",Z[2]),attr(dt,"class","bg-slate-700"),attr(dt,"id","addToList"),attr(U,"class","popup")},m(gt,Tt){insert(gt,U,Tt),append(U,W),W.innerHTML=Z[0],append(U,X),append(U,tt),append(tt,Y),append(U,nt),append(U,it),append(it,rt),append(U,st),append(U,at),at.innerHTML=Z[3],append(U,ct),append(U,ht),append(U,ut),append(U,dt),_t||(kt=listen(dt,"click",Z[6]),_t=!0)},p(gt,[Tt]){Tt&1&&(W.innerHTML=gt[0]),Tt&2&&set_data(Y,gt[1]),Tt&4&&attr(it,"href",gt[2]),Tt&8&&(at.innerHTML=gt[3])},i:noop$1,o:noop$1,d(gt){gt&&detach(U),_t=!1,kt()}}}function instance$o(Z,U,W){let{title:X}=U,{date:tt}=U,{link:Y}=U,{excerpt:nt}=U,{feature:it}=U;async function rt(){selectedFeatures.update(at=>{const ct={title:X,date:tt,link:Y,excerpt:nt,feature:it};return[...at,ct]}),console.log("Clicked")}const st=()=>rt();return Z.$$set=at=>{"title"in at&&W(0,X=at.title),"date"in at&&W(1,tt=at.date),"link"in at&&W(2,Y=at.link),"excerpt"in at&&W(3,nt=at.excerpt),"feature"in at&&W(5,it=at.feature)},[X,tt,Y,nt,rt,it,st]}class MarkerPopup extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$o,create_fragment$o,safe_not_equal,{title:0,date:1,link:2,excerpt:3,feature:5})}}const Map_svelte_svelte_type_style_lang="";function create_fragment$n(Z){let U;return{c(){U=element("main"),U.innerHTML='<div id="map" class="svelte-1hq6thp"></div>'},m(W,X){insert(W,U,X)},p:noop$1,i:noop$1,o:noop$1,d(W){W&&detach(U)}}}let map,dbLayer;function instance$n(Z,U,W){var X={mapIconUrl:'<?xml version="1.0" encoding="UTF-8"?><svg id="d" xmlns="http://www.w3.org/2000/svg" width="30" height="auto" viewBox="0 0 179.368 176.383"><path d="m179.02,106.984l-.667-6.639c-2.492-12.952-9.617-24.553-20.042-32.633-11.702-9.702-26.937-14.051-41.997-11.987-15.144,1.066-29.174,8.34-38.774,20.1-10.451,12.785-14.65,26.618-12.485,42.606l2.788,50.013c.667,6.639,3.711,9.127,9.741,7.963l54.603-7.161c13.775-1.942,25.39-8.697,34.846-20.264,9.953-12.176,13.543-26.507,11.987-41.997Z" fill="#303030"/><path d="m247.058,187.759l-3.985-4.352c-8.553-7.795-19.413-11.921-30.549-11.605-12.838-.098-25.125,5.691-33.869,15.957-9.332,9.602-6.996,20.498-6.987,34.502,0,15.232,8.038,25.845,18,36l17.543,38.298c3.985,4.352,7.305,4.352,10.626,0l16.831-38.298c7.969-9.429,27-31.219,27-45,0-14.507-5.313-15.347-14.61-25.502Z" fill="#2d84cb"/><path d="m125.895,21.883l-6-6C107.016,5.135,90.664-.552,73.895-.117c-19.331-.135-37.832,7.846-51,22C8.843,35.122.882,53.576.895,72.883c0,21,7,38,22,52l43,47c6,6,11,6,16,0l48-51c12-13,18-29,18-48,0-20-8-37-22-51Z" fill="#3184c6"/><circle cx="75.129" cy="69.872" r="37.619" fill="#fff"/><circle cx="73.895" cy="73.883" r="2" fill="#fff"/></svg>',mapIconColor:"#cc756b",mapIconColorInnerCircle:"#fff",pinInnerCircleRadius:28},tt=L.divIcon({className:"leaflet-data-marker",html:L.Util.template(X.mapIconUrl,X),iconAnchor:[12,32],iconSize:[25,30],popupAnchor:[0,-28]});onMount(()=>{map=L.map("map",{renderer:L.canvas()}).setView([13.086066,77.609997],7);var nt=L.tileLayer("https://api.mapbox.com/styles/v1/rungdung/clftq8tyw001r01nwuzgk0gic/tiles/256/{z}/{x}/{y}@2x?access_token=pk.eyJ1IjoicnVuZ2R1bmciLCJhIjoiY2tqeWh6cXF4MDgzMjJvbWVmbGQzYjAwMyJ9.U-aJyoqyKvTXlhVk43jV1A",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, Mapbox Imagery',maxZoom:20,minZoom:3,maxBounds:[[12.846638,77.125397],[13.283409,78.016663]],renderer:L.canvas()});nt.addTo(map),dbLayer=L.markerClusterGroup().addTo(map),Y()});async function Y(){var it=await(await fetch("HWdb_geocoded.geojson")).json();L.geoJSON(it,{onEachFeature:(rt,st)=>{st.setIcon(tt);let at=document.createElement("div");new MarkerPopup({target:at,props:{title:rt.properties.title,date:rt.properties.date,link:rt.properties.link,excerpt:rt.properties.excerpt,feature:rt}}),st.bindPopup(at)}}).addTo(dbLayer)}return[Y]}let Map$1=class extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$n,create_fragment$n,safe_not_equal,{loadSavedData:0})}get loadSavedData(){return this.$$.ctx[0]}};const stores={},rightCb=(Z,U,W,X)=>{const tt=Z+W,Y=U+X/2;return[tt,Y,0]},leftCb=(Z,U,W,X)=>{const tt=Z,Y=U+X/2;return[tt,Y,180]},topCb=(Z,U,W,X)=>[Z+W/2,U,90],bottomCb=(Z,U,W,X)=>{const tt=Z+W/2,Y=U+X;return[tt,Y,270]};function getPotentialAnchorById(Z,U){const X=get_store_value(Z.potentialAnchorsStore)[U];if(X===void 0)throw"potential anchor not found";return X}function getPotentialAnchors(Z,U){let W=Object.values(get_store_value(Z.potentialAnchorsStore));return U!==void 0&&(W=W.filter(X=>{for(let tt in U){const Y=U[tt];if(X[tt]!==Y)return!1}return!0})),W}function getNodeById(Z,U){return get_store_value(Z.nodesStore)[U]}function getAnchors(Z,U){let W=Object.values(get_store_value(Z.anchorsStore));return U!==void 0&&(W=W.filter(X=>{for(let tt in U){const Y=U[tt];if(X[tt]!==Y)return!1}return!0})),W}function getAnchorFromEdge(Z,U,W){getEdgeById(Z,U);const X=getAnchors(Z,{edgeId:U});if(X.length!==2)throw`there should be two anchors for a given edge, there are ${X.length}`;const tt=X.filter(Y=>Y.sourceOrTarget===W);if(tt.length!==1)throw"there should only be one source/target anchor";return tt[0]}function getEdgeById(Z,U){const X=get_store_value(Z.edgesStore)[U];if(X===void 0)throw"edge not found";return X}function getAnchorById(Z,U){return get_store_value(Z.anchorsStore)[U]}function fixedCbCreator(Z,U,W,X,tt){const Y=nt;return Y.type="fixed",Y;function nt(){const it=getAnchors(Z,{edgeId:U});if(it.length!==2)throw`there should be two anchors per edge, have: ${it.length}`;let[rt,st]=it;rt.id!==W&&([rt,st]=[st,rt]);const at=getNodeById(Z,X),{positionX:ct,positionY:ht,width:ut,height:dt}=at,[_t,kt,gt]=tt(ct,ht,ut,dt);rt.positionX=_t,rt.positionY=kt,rt.angle=gt,st.callback.type==="dynamic"&&st.callback()}}function dynamicCbCreator(Z,U,W){const X=tt;return X.type="dynamic",X;function tt(){const Y=getAnchors(Z,{edgeId:U});if(Y.length!==2)throw`there should be two anchors per edge, have: ${Y.length}`;let[nt,it]=Y;nt.id!==W&&([nt,it]=[it,nt]);const rt=getNodeById(Z,nt.nodeId),st=getNodeById(Z,it.nodeId),[at,ct,ht,ut]=[rt.positionX+rt.width/2,rt.positionY+rt.height/2,st.positionX+st.width/2,st.positionY+st.height/2];let dt=nt.angle;const _t=(ct-ut)/(at-ht);if(Math.abs(_t)<1)if(rt.positionX<st.positionX){const[kt,gt]=rightCb(rt.positionX,rt.positionY,rt.width,rt.height);leftCb(st.positionX,st.positionY,st.width,st.height),nt.setPosition(kt,gt),nt.angle=0}else{const[kt,gt]=leftCb(rt.positionX,rt.positionY,rt.width,rt.height);rightCb(st.positionX,st.positionY,st.width,st.height),nt.setPosition(kt,gt),nt.angle=180}else if(rt.positionY<st.positionY){const[kt,gt]=bottomCb(rt.positionX,rt.positionY,rt.width,rt.height);topCb(st.positionX,st.positionY,st.width,st.height),nt.setPosition(kt,gt),nt.angle=270}else{const[kt,gt]=topCb(rt.positionX,rt.positionY,rt.width,rt.height);bottomCb(st.positionX,st.positionY,st.width,st.height),nt.setPosition(kt,gt),nt.angle=90}dt!==nt.angle&&it.callback()}}function potentialAnchorCbCreator(Z,U,W,X){return tt;function tt(){const Y=getPotentialAnchorById(Z,U),nt=getNodeById(Z,W),{positionX:it,positionY:rt,width:st,height:at}=nt,[ct,ht,ut]=X(it,rt,st,at);Y.positionX=ct,Y.positionY=ht,Y.angle=ut}}let ResizeNode$1=class{constructor(U,W,X,tt,Y){this.id=U,this.canvasId=W,this.nodeId=X,this.positionX=tt,this.positionY=Y}setPosition(U,W){this.positionX+=U,this.positionY+=W}setPositionAndCascade(U,W){const X=this.nodeId,{nodesStore:tt}=stores[this.canvasId];tt.update(Y=>{const nt=Y[X];return nt.width+U>20&&nt.height+W>20&&(this.positionX+=U,this.positionY+=W,nt.setSizeFromMovement(U,W)),{...Y}})}delete(){stores[this.canvasId];const{resizeNodesStore:U}=stores[this.canvasId];U.update(W=>{for(const X in W)W[X].id===this.id&&delete W[X];return{...W}})}};class Anchor{constructor(U,W,X,tt,Y,nt,it,rt,st){this.id=U,this.nodeId=W,this.edgeId=X,this.sourceOrTarget=tt,this.positionX=Y,this.positionY=nt,this.callback=it,this.canvasId=rt,this.angle=st}getOtherAnchorId(){const U=stores[this.canvasId],W=getAnchors(U,{edgeId:this.edgeId});if(W.length!==2)throw"something is wrong, every anchor should have exactly one other associated anchor";return W.filter(tt=>tt.id!==this.id)[0].id}setPositionFromNode(){this.callback();const{edgesStore:U}=stores[this.canvasId];U.update(W=>{const X=W[this.edgeId];return this.sourceOrTarget==="source"?(X.sourceX=this.positionX,X.sourceY=this.positionY):(X.targetX=this.positionX,X.targetY=this.positionY),{...W}})}updateEdges(){const{edgesStore:U}=stores[this.canvasId];U.update(W=>{const X=W[this.edgeId];return X===void 0?{...W}:(this.sourceOrTarget==="source"?(X.sourceX=this.positionX,X.sourceY=this.positionY):(X.targetX=this.positionX,X.targetY=this.positionY),{...W})})}setPosition(U,W){this.positionX=U,this.positionY=W,this.updateEdges()}setPositionFromMovement(U,W){this.positionX+=U,this.positionY+=W;const{edgesStore:X}=stores[this.canvasId];X.update(tt=>{const Y=tt[this.edgeId];return this.sourceOrTarget==="source"?(Y.sourceX+=U,Y.sourceY+=W):(Y.targetX+=U,Y.targetY+=W),{...tt}})}}function getResizeNodes(Z,U){let W=Object.values(get_store_value(Z.resizeNodesStore));return U!==void 0&&(W=W.filter(X=>{for(let tt in U){const Y=U[tt];if(X[tt]!==Y)return!1}return!0})),W}let Node$1=class{constructor(U,W,X,tt,Y,nt,it,rt,st,at,ct,ht,ut,dt,_t,kt){this.id=U,this.positionX=W,this.positionY=X,this.width=tt,this.height=Y,this.bgColor=nt,this.data=it,this.canvasId=rt,this.borderColor=st,this.image=at,this.src=ct,this.textColor=ht,this.borderRadius=ut,this.childNodes=dt,this.className=_t,this.clickCallback=kt}setPositionFromMovement(U,W){const{nodesStore:X,anchorsStore:tt,resizeNodesStore:Y,potentialAnchorsStore:nt,boundary:it,lockedOption:rt}=stores[this.canvasId];if(get_store_value(rt))return;const st=get_store_value(it);typeof st=="object"&&(this.positionX+this.width+U>=st.x||this.positionY+this.height+W>=st.y||this.positionY+W<=0||this.positionX+U<=0)||(this.positionX+=U,this.positionY+=W,X.update(at=>{if(this.childNodes)for(const ct of this.childNodes)at[ct].setPositionFromMovement(U,W);return{...at}}),tt.update(at=>{for(const ct in at)at[ct].nodeId===this.id&&at[ct].setPositionFromNode();return{...at}}),nt.update(at=>{for(const ct in at)at[ct].nodeId===this.id&&at[ct].callback();return{...at}}),Y.update(at=>{for(const ct in at)at[ct].nodeId===this.id&&at[ct].setPosition(U,W);return{...at}}))}setSizeFromMovement(U,W){this.width+=U,this.height+=W;const{anchorsStore:X,potentialAnchorsStore:tt}=stores[this.canvasId];X.update(Y=>{for(const nt in Y)Y[nt].nodeId===this.id&&Y[nt].setPositionFromNode();return{...Y}}),tt.update(Y=>{for(const nt in Y)Y[nt].nodeId===this.id&&Y[nt].callback();return{...Y}})}delete(){const U=stores[this.canvasId],{nodesStore:W,anchorsStore:X,edgesStore:tt}=stores[this.canvasId];W.update(rt=>{for(const st in rt)rt[st].id===this.id&&delete rt[st];return{...rt}});const Y=getAnchors(U,{nodeId:this.id});for(let rt of Y){const st=rt.edgeId;getEdgeById(U,st).delete()}const nt=getResizeNodes(U,{nodeId:this.id});for(const rt of nt)rt.delete();const it=getPotentialAnchors(U,{nodeId:this.id});for(const rt of it)rt.delete()}setExportableData(){return{id:this.id,width:this.width,height:this.height,position:{x:this.positionX,y:this.positionY},data:this.data,bgColor:this.bgColor,borderColor:this.borderColor,textColor:this.textColor,borderRadius:this.borderRadius,image:this.image,src:this.src,childNodes:this.childNodes,customClassName:this.className}}};class Edge{constructor(U,W,X,tt,Y,nt,it,rt,st,at,ct,ht,ut,dt,_t,kt){this.id=U,this.sourceX=W,this.sourceY=X,this.targetX=tt,this.targetY=Y,this.canvasId=nt,this.label=it,this.type=rt,this.labelBgColor=st,this.labelTextColor=at,this.edgeColor=ct,this.animate=ht,this.noHandle=ut,this.arrow=dt,this.clickCallback=_t,this.className=kt}delete(){const U=stores[this.canvasId],{nodesStore:W,anchorsStore:X,edgesStore:tt}=U,Y=getAnchorFromEdge(U,this.id,"source"),nt=getAnchorFromEdge(U,this.id,"target");X.update(it=>{for(const rt in it)(rt===Y.id||rt==nt.id)&&delete it[rt];return{...it}}),tt.update(it=>(delete it[this.id],{...it}))}setExportableData(){const U={id:this.id,label:this.label,type:this.type,labelBgColor:this.labelBgColor,labelTextColor:this.labelTextColor,edgeColor:this.edgeColor,animate:this.animate,noHandle:this.noHandle,arrow:this.arrow,source:"dummy",target:"dummy"},W=findStore(this.canvasId),X=getAnchors(W,{edgeId:this.id});if(X.length!==2)throw"there should be two anchors per edge";for(const tt of X)tt.sourceOrTarget==="target"&&(U.target=tt.nodeId),tt.sourceOrTarget==="source"&&(U.source=tt.nodeId);return U}}let PotentialAnchor$1=class{constructor(U,W,X,tt,Y,nt,it){this.id=U,this.nodeId=W,this.callback=X,this.positionX=tt,this.positionY=Y,this.angle=nt,this.canvasId=it}delete(){const{potentialAnchorsStore:U}=stores[this.canvasId];U.update(W=>{for(const X in W)W[X].id===this.id&&delete W[X];return{...W}})}};const pkStringGenerator$3=()=>(Math.random()+1).toString(36).substring(7);function createResizeNode(Z,U,W,X){const tt=pkStringGenerator$3();return new ResizeNode$1(tt,Z,U,W,X)}function createAnchor(Z,U,W,X,tt){if(U===null)throw"you cannot create an anchor without a user node (for now)";const Y=tt.id,nt=pkStringGenerator$3();let it;W==="target"?it=tt.targetAnchorCb:it=tt.sourceAnchorCb;let rt;return it===void 0?rt=dynamicCbCreator(Z,Y,nt):rt=fixedCbCreator(Z,Y,nt,U.id,it),new Anchor(nt,U.id,Y,W,-1,-1,rt,X,0)}function populateEdgesStore(Z,U,W){const X={};for(let tt=0;tt<U.length;tt++){const Y=U[tt],{source:nt,target:it,id:rt,type:st,label:at,labelBgColor:ct,labelTextColor:ht,edgeColor:ut,animate:dt,noHandle:_t,arrow:kt,clickCallback:gt,className:Tt}=Y,Ot=getAnchors(Z,{edgeId:rt});if(Ot.length!==2)throw"We should have two anchors for every node";if(new Set(Ot.map(bt=>bt.sourceOrTarget)).size!==2)throw"we should have one source and one target anchor";let Lt,vt;Ot[0].sourceOrTarget==="source"?(Lt=Ot[0],vt=Ot[1]):(Lt=Ot[1],vt=Ot[0]),X[rt]=new Edge(rt,Lt.positionX,Lt.positionY,vt.positionX,vt.positionY,W,Y.label===void 0?"":Y.label,Y.type===void 0?"bezier":Y.type,Y.labelBgColor===void 0?"white":Y.labelBgColor,Y.labelTextColor===void 0?"black":Y.labelTextColor,Y.edgeColor===void 0?"black":Y.edgeColor,Y.animate===void 0?!1:Y.animate,Y.noHandle===void 0?!1:Y.noHandle,Y.arrow===void 0?!1:Y.arrow,Y.clickCallback===void 0?()=>{}:Y.clickCallback,Y.className===void 0?"":Y.className)}Z.edgesStore.set(X)}function findUserNodeById(Z,U){for(let W=0;W<U.length;W++){const X=U[W];if(X.id===Z)return X}return null}function createPotentialAnchor(Z,U,W,X){const tt=pkStringGenerator$3(),Y=potentialAnchorCbCreator(U,tt,W,Z);return new PotentialAnchor$1(tt,W,Y,-1,-1,0,X)}function populatePotentialAnchorStore(Z,U,W){const X={};for(let Y=0;Y<U.length;Y++){const nt=U[Y];for(let it of[topCb,bottomCb,rightCb,leftCb]){const rt=createPotentialAnchor(it,Z,nt.id,W);X[rt.id]=rt}}Z.potentialAnchorsStore.set(X);const tt=Object.values(get_store_value(Z.potentialAnchorsStore));for(const Y of tt)Y.callback()}function populateAnchorsStore(Z,U,W,X){const tt={};for(let nt=0;nt<W.length;nt++){const it=W[nt],{source:rt,target:st}=it,at=findUserNodeById(rt,U),ct=findUserNodeById(st,U),ht=createAnchor(Z,at,"source",X,it),ut=createAnchor(Z,ct,"target",X,it);tt[ht.id]=ht,tt[ut.id]=ut}Z.anchorsStore.set(tt);const Y=getAnchors(Z);for(const nt of Y)nt.callback()}function populateNodesStore(Z,U,W){const X={};for(let tt=0;tt<U.length;tt++){const Y=U[tt],nt=Y.id,it=new Node$1(nt.toString(),Y.position.x,Y.position.y,Y.width,Y.height,Y.bgColor,Y.data,W,Y.borderColor===void 0?"black":Y.borderColor,Y.image===void 0?!1:Y.image,Y.src===void 0?"":Y.src,Y.textColor===void 0?"":Y.textColor,Y.borderRadius===void 0?0:Y.borderRadius,Y.childNodes===void 0?[]:Y.childNodes,Y.className===void 0?"":Y.className,Y.clickCallback===void 0?()=>{}:Y.clickCallback);X[nt]=it}Z.nodesStore.set(X)}function populateResizeNodeStore(Z,U,W){const X={};for(let tt=0;tt<U.length;tt++){const Y=U[tt],{id:nt,width:it,height:rt,position:st}=Y,at=createResizeNode(W,nt,st.x+it,st.y+rt);X[at.id]=at}Z.resizeNodesStore.set(X)}class Collapsible{constructor(U,W,X,tt){this.id=U,this.nodeId=W,this.hideCount=X,this.state=tt}isHidden(){return this.hideCount>0}toggleState(){this.state=this.state==="expanded"?"collapsed":"expanded"}}const pkStringGenerator$2=()=>(Math.random()+1).toString(36).substring(7);function populateCollapsibleStore(Z,U,W,X){const tt=[];for(let Y of U){const nt=new Collapsible(pkStringGenerator$2(),Y.id,0,"expanded");tt.push(nt)}Z.collapsibleStore.set(tt)}function findTargets(Z,U){const W=getAnchors(Z,{nodeId:U,sourceOrTarget:"source"}),X=[];for(const tt of W){const Y=tt.getOtherAnchorId(),nt=getAnchorById(Z,Y);X.push(nt.nodeId)}return X}function traverseAndIncrement(Z,U,W){const X=get_store_value(Z.collapsibleStore);tt(U),Z.collapsibleStore.set(X);function tt(Y){for(const nt of X)if(nt.nodeId===Y){W==="increment"?nt.hideCount++:nt.hideCount--;const it=findTargets(Z,Y);for(const rt of it)tt(rt)}}}function collapse(Z,U){const W=findTargets(Z,U);for(const X of W)traverseAndIncrement(Z,X,"increment")}function expand(Z,U){const W=findTargets(Z,U);for(const X of W)traverseAndIncrement(Z,X,"decrement")}function toggleExpandAndCollapse(Z,U){const W=getCollapsibles(Z,{nodeId:U});if(W.length===0)return;if(W.length>1)throw"there should only be one collapsible object per node";const X=W[0];X.state==="expanded"?collapse(Z,U):expand(Z,U),Z.collapsibleStore.update(tt=>{for(const Y of tt)Y.id===X.id&&Y.toggleState();return[...tt]})}function getCollapsibles(Z,U){let W=Object.values(get_store_value(Z.collapsibleStore));return U!==void 0&&(W=W.filter(X=>{for(let tt in U){const Y=U[tt];if(X[tt]!==Y)return!1}return!0})),W}function filterByCollapsible(Z,U,W,X,tt){const Y=U.filter(ct=>{const ht=ct.id,ut=get_store_value(Z.collapsibleStore).find(dt=>dt.nodeId===ht);return ut===void 0?!0:ut.isHidden()===!1}),nt=Y.map(ct=>ct.id),it=W.filter(ct=>nt.includes(ct.nodeId)),rt=X.filter(ct=>{const ht=ct.getOtherAnchorId(),ut=get_store_value(Z.anchorsStore)[ht];return!!(nt.includes(ct.nodeId)&&nt.includes(ut.nodeId))}),st=new Set(rt.map(ct=>ct.edgeId)),at=tt.filter(ct=>st.has(ct.id));return{filteredNodes:Y,filteredResizeNodes:it,filteredAnchors:rt,filteredEdges:at}}function findStore(Z){return stores[Z]}function createStoreEmpty(Z){return stores[Z]={nodesStore:writable({}),edgesStore:writable({}),anchorsStore:writable({}),resizeNodesStore:writable({}),potentialAnchorsStore:writable({}),widthStore:writable(600),heightStore:writable(600),backgroundStore:writable(!1),movementStore:writable(!0),nodeSelected:writable(!1),nodeIdSelected:writable(-1),d3Scale:writable(1),options:writable({}),temporaryEdgeStore:writable([]),nodeCreate:writable(!1),boundary:writable(!1),edgeEditModal:writable(null),collapsibleStore:writable([]),collapsibleOption:writable(!1),lockedOption:writable(!1),editableOption:writable(!1),d3ZoomParameters:writable({}),resizableOption:writable(!0),highlightEdgesOption:writable(!0)},stores[Z]}function populateSvelvetStoreFromUserInput(Z,U,W){const X=findStore(Z);populateNodesStore(X,U,Z),populateAnchorsStore(X,U,W,Z),populateEdgesStore(X,W,Z),get_store_value(X.resizableOption)&&populateResizeNodeStore(X,U,Z),get_store_value(X.nodeCreate)&&populatePotentialAnchorStore(X,U,Z),get_store_value(X.collapsibleOption)&&populateCollapsibleStore(X,U)}var noop={value:()=>{}};function dispatch(){for(var Z=0,U=arguments.length,W={},X;Z<U;++Z){if(!(X=arguments[Z]+"")||X in W||/[\s.]/.test(X))throw new Error("illegal type: "+X);W[X]=[]}return new Dispatch(W)}function Dispatch(Z){this._=Z}function parseTypenames$1(Z,U){return Z.trim().split(/^|\s+/).map(function(W){var X="",tt=W.indexOf(".");if(tt>=0&&(X=W.slice(tt+1),W=W.slice(0,tt)),W&&!U.hasOwnProperty(W))throw new Error("unknown type: "+W);return{type:W,name:X}})}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(Z,U){var W=this._,X=parseTypenames$1(Z+"",W),tt,Y=-1,nt=X.length;if(arguments.length<2){for(;++Y<nt;)if((tt=(Z=X[Y]).type)&&(tt=get$1(W[tt],Z.name)))return tt;return}if(U!=null&&typeof U!="function")throw new Error("invalid callback: "+U);for(;++Y<nt;)if(tt=(Z=X[Y]).type)W[tt]=set$1(W[tt],Z.name,U);else if(U==null)for(tt in W)W[tt]=set$1(W[tt],Z.name,null);return this},copy:function(){var Z={},U=this._;for(var W in U)Z[W]=U[W].slice();return new Dispatch(Z)},call:function(Z,U){if((tt=arguments.length-2)>0)for(var W=new Array(tt),X=0,tt,Y;X<tt;++X)W[X]=arguments[X+2];if(!this._.hasOwnProperty(Z))throw new Error("unknown type: "+Z);for(Y=this._[Z],X=0,tt=Y.length;X<tt;++X)Y[X].value.apply(U,W)},apply:function(Z,U,W){if(!this._.hasOwnProperty(Z))throw new Error("unknown type: "+Z);for(var X=this._[Z],tt=0,Y=X.length;tt<Y;++tt)X[tt].value.apply(U,W)}};function get$1(Z,U){for(var W=0,X=Z.length,tt;W<X;++W)if((tt=Z[W]).name===U)return tt.value}function set$1(Z,U,W){for(var X=0,tt=Z.length;X<tt;++X)if(Z[X].name===U){Z[X]=noop,Z=Z.slice(0,X).concat(Z.slice(X+1));break}return W!=null&&Z.push({name:U,value:W}),Z}var xhtml="http://www.w3.org/1999/xhtml";const namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(Z){var U=Z+="",W=U.indexOf(":");return W>=0&&(U=Z.slice(0,W))!=="xmlns"&&(Z=Z.slice(W+1)),namespaces.hasOwnProperty(U)?{space:namespaces[U],local:Z}:Z}function creatorInherit(Z){return function(){var U=this.ownerDocument,W=this.namespaceURI;return W===xhtml&&U.documentElement.namespaceURI===xhtml?U.createElement(Z):U.createElementNS(W,Z)}}function creatorFixed(Z){return function(){return this.ownerDocument.createElementNS(Z.space,Z.local)}}function creator(Z){var U=namespace(Z);return(U.local?creatorFixed:creatorInherit)(U)}function none(){}function selector(Z){return Z==null?none:function(){return this.querySelector(Z)}}function selection_select(Z){typeof Z!="function"&&(Z=selector(Z));for(var U=this._groups,W=U.length,X=new Array(W),tt=0;tt<W;++tt)for(var Y=U[tt],nt=Y.length,it=X[tt]=new Array(nt),rt,st,at=0;at<nt;++at)(rt=Y[at])&&(st=Z.call(rt,rt.__data__,at,Y))&&("__data__"in rt&&(st.__data__=rt.__data__),it[at]=st);return new Selection$1(X,this._parents)}function array(Z){return Z==null?[]:Array.isArray(Z)?Z:Array.from(Z)}function empty(){return[]}function selectorAll(Z){return Z==null?empty:function(){return this.querySelectorAll(Z)}}function arrayAll(Z){return function(){return array(Z.apply(this,arguments))}}function selection_selectAll(Z){typeof Z=="function"?Z=arrayAll(Z):Z=selectorAll(Z);for(var U=this._groups,W=U.length,X=[],tt=[],Y=0;Y<W;++Y)for(var nt=U[Y],it=nt.length,rt,st=0;st<it;++st)(rt=nt[st])&&(X.push(Z.call(rt,rt.__data__,st,nt)),tt.push(rt));return new Selection$1(X,tt)}function matcher(Z){return function(){return this.matches(Z)}}function childMatcher(Z){return function(U){return U.matches(Z)}}var find=Array.prototype.find;function childFind(Z){return function(){return find.call(this.children,Z)}}function childFirst(){return this.firstElementChild}function selection_selectChild(Z){return this.select(Z==null?childFirst:childFind(typeof Z=="function"?Z:childMatcher(Z)))}var filter=Array.prototype.filter;function children(){return Array.from(this.children)}function childrenFilter(Z){return function(){return filter.call(this.children,Z)}}function selection_selectChildren(Z){return this.selectAll(Z==null?children:childrenFilter(typeof Z=="function"?Z:childMatcher(Z)))}function selection_filter(Z){typeof Z!="function"&&(Z=matcher(Z));for(var U=this._groups,W=U.length,X=new Array(W),tt=0;tt<W;++tt)for(var Y=U[tt],nt=Y.length,it=X[tt]=[],rt,st=0;st<nt;++st)(rt=Y[st])&&Z.call(rt,rt.__data__,st,Y)&&it.push(rt);return new Selection$1(X,this._parents)}function sparse(Z){return new Array(Z.length)}function selection_enter(){return new Selection$1(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(Z,U){this.ownerDocument=Z.ownerDocument,this.namespaceURI=Z.namespaceURI,this._next=null,this._parent=Z,this.__data__=U}EnterNode.prototype={constructor:EnterNode,appendChild:function(Z){return this._parent.insertBefore(Z,this._next)},insertBefore:function(Z,U){return this._parent.insertBefore(Z,U)},querySelector:function(Z){return this._parent.querySelector(Z)},querySelectorAll:function(Z){return this._parent.querySelectorAll(Z)}};function constant$2(Z){return function(){return Z}}function bindIndex(Z,U,W,X,tt,Y){for(var nt=0,it,rt=U.length,st=Y.length;nt<st;++nt)(it=U[nt])?(it.__data__=Y[nt],X[nt]=it):W[nt]=new EnterNode(Z,Y[nt]);for(;nt<rt;++nt)(it=U[nt])&&(tt[nt]=it)}function bindKey(Z,U,W,X,tt,Y,nt){var it,rt,st=new Map,at=U.length,ct=Y.length,ht=new Array(at),ut;for(it=0;it<at;++it)(rt=U[it])&&(ht[it]=ut=nt.call(rt,rt.__data__,it,U)+"",st.has(ut)?tt[it]=rt:st.set(ut,rt));for(it=0;it<ct;++it)ut=nt.call(Z,Y[it],it,Y)+"",(rt=st.get(ut))?(X[it]=rt,rt.__data__=Y[it],st.delete(ut)):W[it]=new EnterNode(Z,Y[it]);for(it=0;it<at;++it)(rt=U[it])&&st.get(ht[it])===rt&&(tt[it]=rt)}function datum(Z){return Z.__data__}function selection_data(Z,U){if(!arguments.length)return Array.from(this,datum);var W=U?bindKey:bindIndex,X=this._parents,tt=this._groups;typeof Z!="function"&&(Z=constant$2(Z));for(var Y=tt.length,nt=new Array(Y),it=new Array(Y),rt=new Array(Y),st=0;st<Y;++st){var at=X[st],ct=tt[st],ht=ct.length,ut=arraylike(Z.call(at,at&&at.__data__,st,X)),dt=ut.length,_t=it[st]=new Array(dt),kt=nt[st]=new Array(dt),gt=rt[st]=new Array(ht);W(at,ct,_t,kt,gt,ut,U);for(var Tt=0,Ot=0,Lt,vt;Tt<dt;++Tt)if(Lt=_t[Tt]){for(Tt>=Ot&&(Ot=Tt+1);!(vt=kt[Ot])&&++Ot<dt;);Lt._next=vt||null}}return nt=new Selection$1(nt,X),nt._enter=it,nt._exit=rt,nt}function arraylike(Z){return typeof Z=="object"&&"length"in Z?Z:Array.from(Z)}function selection_exit(){return new Selection$1(this._exit||this._groups.map(sparse),this._parents)}function selection_join(Z,U,W){var X=this.enter(),tt=this,Y=this.exit();return typeof Z=="function"?(X=Z(X),X&&(X=X.selection())):X=X.append(Z+""),U!=null&&(tt=U(tt),tt&&(tt=tt.selection())),W==null?Y.remove():W(Y),X&&tt?X.merge(tt).order():tt}function selection_merge(Z){for(var U=Z.selection?Z.selection():Z,W=this._groups,X=U._groups,tt=W.length,Y=X.length,nt=Math.min(tt,Y),it=new Array(tt),rt=0;rt<nt;++rt)for(var st=W[rt],at=X[rt],ct=st.length,ht=it[rt]=new Array(ct),ut,dt=0;dt<ct;++dt)(ut=st[dt]||at[dt])&&(ht[dt]=ut);for(;rt<tt;++rt)it[rt]=W[rt];return new Selection$1(it,this._parents)}function selection_order(){for(var Z=this._groups,U=-1,W=Z.length;++U<W;)for(var X=Z[U],tt=X.length-1,Y=X[tt],nt;--tt>=0;)(nt=X[tt])&&(Y&&nt.compareDocumentPosition(Y)^4&&Y.parentNode.insertBefore(nt,Y),Y=nt);return this}function selection_sort(Z){Z||(Z=ascending);function U(ct,ht){return ct&&ht?Z(ct.__data__,ht.__data__):!ct-!ht}for(var W=this._groups,X=W.length,tt=new Array(X),Y=0;Y<X;++Y){for(var nt=W[Y],it=nt.length,rt=tt[Y]=new Array(it),st,at=0;at<it;++at)(st=nt[at])&&(rt[at]=st);rt.sort(U)}return new Selection$1(tt,this._parents).order()}function ascending(Z,U){return Z<U?-1:Z>U?1:Z>=U?0:NaN}function selection_call(){var Z=arguments[0];return arguments[0]=this,Z.apply(null,arguments),this}function selection_nodes(){return Array.from(this)}function selection_node(){for(var Z=this._groups,U=0,W=Z.length;U<W;++U)for(var X=Z[U],tt=0,Y=X.length;tt<Y;++tt){var nt=X[tt];if(nt)return nt}return null}function selection_size(){let Z=0;for(const U of this)++Z;return Z}function selection_empty(){return!this.node()}function selection_each(Z){for(var U=this._groups,W=0,X=U.length;W<X;++W)for(var tt=U[W],Y=0,nt=tt.length,it;Y<nt;++Y)(it=tt[Y])&&Z.call(it,it.__data__,Y,tt);return this}function attrRemove$1(Z){return function(){this.removeAttribute(Z)}}function attrRemoveNS$1(Z){return function(){this.removeAttributeNS(Z.space,Z.local)}}function attrConstant$1(Z,U){return function(){this.setAttribute(Z,U)}}function attrConstantNS$1(Z,U){return function(){this.setAttributeNS(Z.space,Z.local,U)}}function attrFunction$1(Z,U){return function(){var W=U.apply(this,arguments);W==null?this.removeAttribute(Z):this.setAttribute(Z,W)}}function attrFunctionNS$1(Z,U){return function(){var W=U.apply(this,arguments);W==null?this.removeAttributeNS(Z.space,Z.local):this.setAttributeNS(Z.space,Z.local,W)}}function selection_attr(Z,U){var W=namespace(Z);if(arguments.length<2){var X=this.node();return W.local?X.getAttributeNS(W.space,W.local):X.getAttribute(W)}return this.each((U==null?W.local?attrRemoveNS$1:attrRemove$1:typeof U=="function"?W.local?attrFunctionNS$1:attrFunction$1:W.local?attrConstantNS$1:attrConstant$1)(W,U))}function defaultView(Z){return Z.ownerDocument&&Z.ownerDocument.defaultView||Z.document&&Z||Z.defaultView}function styleRemove$1(Z){return function(){this.style.removeProperty(Z)}}function styleConstant$1(Z,U,W){return function(){this.style.setProperty(Z,U,W)}}function styleFunction$1(Z,U,W){return function(){var X=U.apply(this,arguments);X==null?this.style.removeProperty(Z):this.style.setProperty(Z,X,W)}}function selection_style(Z,U,W){return arguments.length>1?this.each((U==null?styleRemove$1:typeof U=="function"?styleFunction$1:styleConstant$1)(Z,U,W??"")):styleValue(this.node(),Z)}function styleValue(Z,U){return Z.style.getPropertyValue(U)||defaultView(Z).getComputedStyle(Z,null).getPropertyValue(U)}function propertyRemove(Z){return function(){delete this[Z]}}function propertyConstant(Z,U){return function(){this[Z]=U}}function propertyFunction(Z,U){return function(){var W=U.apply(this,arguments);W==null?delete this[Z]:this[Z]=W}}function selection_property(Z,U){return arguments.length>1?this.each((U==null?propertyRemove:typeof U=="function"?propertyFunction:propertyConstant)(Z,U)):this.node()[Z]}function classArray(Z){return Z.trim().split(/^|\s+/)}function classList(Z){return Z.classList||new ClassList(Z)}function ClassList(Z){this._node=Z,this._names=classArray(Z.getAttribute("class")||"")}ClassList.prototype={add:function(Z){var U=this._names.indexOf(Z);U<0&&(this._names.push(Z),this._node.setAttribute("class",this._names.join(" ")))},remove:function(Z){var U=this._names.indexOf(Z);U>=0&&(this._names.splice(U,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(Z){return this._names.indexOf(Z)>=0}};function classedAdd(Z,U){for(var W=classList(Z),X=-1,tt=U.length;++X<tt;)W.add(U[X])}function classedRemove(Z,U){for(var W=classList(Z),X=-1,tt=U.length;++X<tt;)W.remove(U[X])}function classedTrue(Z){return function(){classedAdd(this,Z)}}function classedFalse(Z){return function(){classedRemove(this,Z)}}function classedFunction(Z,U){return function(){(U.apply(this,arguments)?classedAdd:classedRemove)(this,Z)}}function selection_classed(Z,U){var W=classArray(Z+"");if(arguments.length<2){for(var X=classList(this.node()),tt=-1,Y=W.length;++tt<Y;)if(!X.contains(W[tt]))return!1;return!0}return this.each((typeof U=="function"?classedFunction:U?classedTrue:classedFalse)(W,U))}function textRemove(){this.textContent=""}function textConstant$1(Z){return function(){this.textContent=Z}}function textFunction$1(Z){return function(){var U=Z.apply(this,arguments);this.textContent=U??""}}function selection_text(Z){return arguments.length?this.each(Z==null?textRemove:(typeof Z=="function"?textFunction$1:textConstant$1)(Z)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(Z){return function(){this.innerHTML=Z}}function htmlFunction(Z){return function(){var U=Z.apply(this,arguments);this.innerHTML=U??""}}function selection_html(Z){return arguments.length?this.each(Z==null?htmlRemove:(typeof Z=="function"?htmlFunction:htmlConstant)(Z)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(Z){var U=typeof Z=="function"?Z:creator(Z);return this.select(function(){return this.appendChild(U.apply(this,arguments))})}function constantNull(){return null}function selection_insert(Z,U){var W=typeof Z=="function"?Z:creator(Z),X=U==null?constantNull:typeof U=="function"?U:selector(U);return this.select(function(){return this.insertBefore(W.apply(this,arguments),X.apply(this,arguments)||null)})}function remove(){var Z=this.parentNode;Z&&Z.removeChild(this)}function selection_remove(){return this.each(remove)}function selection_cloneShallow(){var Z=this.cloneNode(!1),U=this.parentNode;return U?U.insertBefore(Z,this.nextSibling):Z}function selection_cloneDeep(){var Z=this.cloneNode(!0),U=this.parentNode;return U?U.insertBefore(Z,this.nextSibling):Z}function selection_clone(Z){return this.select(Z?selection_cloneDeep:selection_cloneShallow)}function selection_datum(Z){return arguments.length?this.property("__data__",Z):this.node().__data__}function contextListener(Z){return function(U){Z.call(this,U,this.__data__)}}function parseTypenames(Z){return Z.trim().split(/^|\s+/).map(function(U){var W="",X=U.indexOf(".");return X>=0&&(W=U.slice(X+1),U=U.slice(0,X)),{type:U,name:W}})}function onRemove(Z){return function(){var U=this.__on;if(U){for(var W=0,X=-1,tt=U.length,Y;W<tt;++W)Y=U[W],(!Z.type||Y.type===Z.type)&&Y.name===Z.name?this.removeEventListener(Y.type,Y.listener,Y.options):U[++X]=Y;++X?U.length=X:delete this.__on}}}function onAdd(Z,U,W){return function(){var X=this.__on,tt,Y=contextListener(U);if(X){for(var nt=0,it=X.length;nt<it;++nt)if((tt=X[nt]).type===Z.type&&tt.name===Z.name){this.removeEventListener(tt.type,tt.listener,tt.options),this.addEventListener(tt.type,tt.listener=Y,tt.options=W),tt.value=U;return}}this.addEventListener(Z.type,Y,W),tt={type:Z.type,name:Z.name,value:U,listener:Y,options:W},X?X.push(tt):this.__on=[tt]}}function selection_on(Z,U,W){var X=parseTypenames(Z+""),tt,Y=X.length,nt;if(arguments.length<2){var it=this.node().__on;if(it){for(var rt=0,st=it.length,at;rt<st;++rt)for(tt=0,at=it[rt];tt<Y;++tt)if((nt=X[tt]).type===at.type&&nt.name===at.name)return at.value}return}for(it=U?onAdd:onRemove,tt=0;tt<Y;++tt)this.each(it(X[tt],U,W));return this}function dispatchEvent(Z,U,W){var X=defaultView(Z),tt=X.CustomEvent;typeof tt=="function"?tt=new tt(U,W):(tt=X.document.createEvent("Event"),W?(tt.initEvent(U,W.bubbles,W.cancelable),tt.detail=W.detail):tt.initEvent(U,!1,!1)),Z.dispatchEvent(tt)}function dispatchConstant(Z,U){return function(){return dispatchEvent(this,Z,U)}}function dispatchFunction(Z,U){return function(){return dispatchEvent(this,Z,U.apply(this,arguments))}}function selection_dispatch(Z,U){return this.each((typeof U=="function"?dispatchFunction:dispatchConstant)(Z,U))}function*selection_iterator(){for(var Z=this._groups,U=0,W=Z.length;U<W;++U)for(var X=Z[U],tt=0,Y=X.length,nt;tt<Y;++tt)(nt=X[tt])&&(yield nt)}var root=[null];function Selection$1(Z,U){this._groups=Z,this._parents=U}function selection(){return new Selection$1([[document.documentElement]],root)}function selection_selection(){return this}Selection$1.prototype=selection.prototype={constructor:Selection$1,select:selection_select,selectAll:selection_selectAll,selectChild:selection_selectChild,selectChildren:selection_selectChildren,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,join:selection_join,merge:selection_merge,selection:selection_selection,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,clone:selection_clone,datum:selection_datum,on:selection_on,dispatch:selection_dispatch,[Symbol.iterator]:selection_iterator};function select(Z){return typeof Z=="string"?new Selection$1([[document.querySelector(Z)]],[document.documentElement]):new Selection$1([[Z]],root)}function sourceEvent(Z){let U;for(;U=Z.sourceEvent;)Z=U;return Z}function pointer(Z,U){if(Z=sourceEvent(Z),U===void 0&&(U=Z.currentTarget),U){var W=U.ownerSVGElement||U;if(W.createSVGPoint){var X=W.createSVGPoint();return X.x=Z.clientX,X.y=Z.clientY,X=X.matrixTransform(U.getScreenCTM().inverse()),[X.x,X.y]}if(U.getBoundingClientRect){var tt=U.getBoundingClientRect();return[Z.clientX-tt.left-U.clientLeft,Z.clientY-tt.top-U.clientTop]}}return[Z.pageX,Z.pageY]}function selectAll(Z){return typeof Z=="string"?new Selection$1([document.querySelectorAll(Z)],[document.documentElement]):new Selection$1([array(Z)],root)}const nonpassivecapture={capture:!0,passive:!1};function noevent$1(Z){Z.preventDefault(),Z.stopImmediatePropagation()}function dragDisable(Z){var U=Z.document.documentElement,W=select(Z).on("dragstart.drag",noevent$1,nonpassivecapture);"onselectstart"in U?W.on("selectstart.drag",noevent$1,nonpassivecapture):(U.__noselect=U.style.MozUserSelect,U.style.MozUserSelect="none")}function yesdrag(Z,U){var W=Z.document.documentElement,X=select(Z).on("dragstart.drag",null);U&&(X.on("click.drag",noevent$1,nonpassivecapture),setTimeout(function(){X.on("click.drag",null)},0)),"onselectstart"in W?X.on("selectstart.drag",null):(W.style.MozUserSelect=W.__noselect,delete W.__noselect)}function define(Z,U,W){Z.prototype=U.prototype=W,W.constructor=Z}function extend(Z,U){var W=Object.create(Z.prototype);for(var X in U)W[X]=U[X];return W}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{copy(Z){return Object.assign(new this.constructor,this,Z)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(Z){var U,W;return Z=(Z+"").trim().toLowerCase(),(U=reHex.exec(Z))?(W=U[1].length,U=parseInt(U[1],16),W===6?rgbn(U):W===3?new Rgb(U>>8&15|U>>4&240,U>>4&15|U&240,(U&15)<<4|U&15,1):W===8?rgba(U>>24&255,U>>16&255,U>>8&255,(U&255)/255):W===4?rgba(U>>12&15|U>>8&240,U>>8&15|U>>4&240,U>>4&15|U&240,((U&15)<<4|U&15)/255):null):(U=reRgbInteger.exec(Z))?new Rgb(U[1],U[2],U[3],1):(U=reRgbPercent.exec(Z))?new Rgb(U[1]*255/100,U[2]*255/100,U[3]*255/100,1):(U=reRgbaInteger.exec(Z))?rgba(U[1],U[2],U[3],U[4]):(U=reRgbaPercent.exec(Z))?rgba(U[1]*255/100,U[2]*255/100,U[3]*255/100,U[4]):(U=reHslPercent.exec(Z))?hsla(U[1],U[2]/100,U[3]/100,1):(U=reHslaPercent.exec(Z))?hsla(U[1],U[2]/100,U[3]/100,U[4]):named.hasOwnProperty(Z)?rgbn(named[Z]):Z==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(Z){return new Rgb(Z>>16&255,Z>>8&255,Z&255,1)}function rgba(Z,U,W,X){return X<=0&&(Z=U=W=NaN),new Rgb(Z,U,W,X)}function rgbConvert(Z){return Z instanceof Color||(Z=color(Z)),Z?(Z=Z.rgb(),new Rgb(Z.r,Z.g,Z.b,Z.opacity)):new Rgb}function rgb(Z,U,W,X){return arguments.length===1?rgbConvert(Z):new Rgb(Z,U,W,X??1)}function Rgb(Z,U,W,X){this.r=+Z,this.g=+U,this.b=+W,this.opacity=+X}define(Rgb,rgb,extend(Color,{brighter(Z){return Z=Z==null?brighter:Math.pow(brighter,Z),new Rgb(this.r*Z,this.g*Z,this.b*Z,this.opacity)},darker(Z){return Z=Z==null?darker:Math.pow(darker,Z),new Rgb(this.r*Z,this.g*Z,this.b*Z,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const Z=clampa(this.opacity);return`${Z===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${Z===1?")":`, ${Z})`}`}function clampa(Z){return isNaN(Z)?1:Math.max(0,Math.min(1,Z))}function clampi(Z){return Math.max(0,Math.min(255,Math.round(Z)||0))}function hex(Z){return Z=clampi(Z),(Z<16?"0":"")+Z.toString(16)}function hsla(Z,U,W,X){return X<=0?Z=U=W=NaN:W<=0||W>=1?Z=U=NaN:U<=0&&(Z=NaN),new Hsl(Z,U,W,X)}function hslConvert(Z){if(Z instanceof Hsl)return new Hsl(Z.h,Z.s,Z.l,Z.opacity);if(Z instanceof Color||(Z=color(Z)),!Z)return new Hsl;if(Z instanceof Hsl)return Z;Z=Z.rgb();var U=Z.r/255,W=Z.g/255,X=Z.b/255,tt=Math.min(U,W,X),Y=Math.max(U,W,X),nt=NaN,it=Y-tt,rt=(Y+tt)/2;return it?(U===Y?nt=(W-X)/it+(W<X)*6:W===Y?nt=(X-U)/it+2:nt=(U-W)/it+4,it/=rt<.5?Y+tt:2-Y-tt,nt*=60):it=rt>0&&rt<1?0:nt,new Hsl(nt,it,rt,Z.opacity)}function hsl(Z,U,W,X){return arguments.length===1?hslConvert(Z):new Hsl(Z,U,W,X??1)}function Hsl(Z,U,W,X){this.h=+Z,this.s=+U,this.l=+W,this.opacity=+X}define(Hsl,hsl,extend(Color,{brighter(Z){return Z=Z==null?brighter:Math.pow(brighter,Z),new Hsl(this.h,this.s,this.l*Z,this.opacity)},darker(Z){return Z=Z==null?darker:Math.pow(darker,Z),new Hsl(this.h,this.s,this.l*Z,this.opacity)},rgb(){var Z=this.h%360+(this.h<0)*360,U=isNaN(Z)||isNaN(this.s)?0:this.s,W=this.l,X=W+(W<.5?W:1-W)*U,tt=2*W-X;return new Rgb(hsl2rgb(Z>=240?Z-240:Z+120,tt,X),hsl2rgb(Z,tt,X),hsl2rgb(Z<120?Z+240:Z-120,tt,X),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const Z=clampa(this.opacity);return`${Z===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${Z===1?")":`, ${Z})`}`}}));function clamph(Z){return Z=(Z||0)%360,Z<0?Z+360:Z}function clampt(Z){return Math.max(0,Math.min(1,Z||0))}function hsl2rgb(Z,U,W){return(Z<60?U+(W-U)*Z/60:Z<180?W:Z<240?U+(W-U)*(240-Z)/60:U)*255}const constant$1=Z=>()=>Z;function linear(Z,U){return function(W){return Z+W*U}}function exponential(Z,U,W){return Z=Math.pow(Z,W),U=Math.pow(U,W)-Z,W=1/W,function(X){return Math.pow(Z+X*U,W)}}function gamma(Z){return(Z=+Z)==1?nogamma:function(U,W){return W-U?exponential(U,W,Z):constant$1(isNaN(U)?W:U)}}function nogamma(Z,U){var W=U-Z;return W?linear(Z,W):constant$1(isNaN(Z)?U:Z)}const interpolateRgb=function Z(U){var W=gamma(U);function X(tt,Y){var nt=W((tt=rgb(tt)).r,(Y=rgb(Y)).r),it=W(tt.g,Y.g),rt=W(tt.b,Y.b),st=nogamma(tt.opacity,Y.opacity);return function(at){return tt.r=nt(at),tt.g=it(at),tt.b=rt(at),tt.opacity=st(at),tt+""}}return X.gamma=Z,X}(1);function interpolateNumber(Z,U){return Z=+Z,U=+U,function(W){return Z*(1-W)+U*W}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(Z){return function(){return Z}}function one(Z){return function(U){return Z(U)+""}}function interpolateString(Z,U){var W=reA.lastIndex=reB.lastIndex=0,X,tt,Y,nt=-1,it=[],rt=[];for(Z=Z+"",U=U+"";(X=reA.exec(Z))&&(tt=reB.exec(U));)(Y=tt.index)>W&&(Y=U.slice(W,Y),it[nt]?it[nt]+=Y:it[++nt]=Y),(X=X[0])===(tt=tt[0])?it[nt]?it[nt]+=tt:it[++nt]=tt:(it[++nt]=null,rt.push({i:nt,x:interpolateNumber(X,tt)})),W=reB.lastIndex;return W<U.length&&(Y=U.slice(W),it[nt]?it[nt]+=Y:it[++nt]=Y),it.length<2?rt[0]?one(rt[0].x):zero(U):(U=rt.length,function(st){for(var at=0,ct;at<U;++at)it[(ct=rt[at]).i]=ct.x(st);return it.join("")})}var degrees=180/Math.PI,identity$1={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(Z,U,W,X,tt,Y){var nt,it,rt;return(nt=Math.sqrt(Z*Z+U*U))&&(Z/=nt,U/=nt),(rt=Z*W+U*X)&&(W-=Z*rt,X-=U*rt),(it=Math.sqrt(W*W+X*X))&&(W/=it,X/=it,rt/=it),Z*X<U*W&&(Z=-Z,U=-U,rt=-rt,nt=-nt),{translateX:tt,translateY:Y,rotate:Math.atan2(U,Z)*degrees,skewX:Math.atan(rt)*degrees,scaleX:nt,scaleY:it}}var svgNode;function parseCss(Z){const U=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(Z+"");return U.isIdentity?identity$1:decompose(U.a,U.b,U.c,U.d,U.e,U.f)}function parseSvg(Z){return Z==null||(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",Z),!(Z=svgNode.transform.baseVal.consolidate()))?identity$1:(Z=Z.matrix,decompose(Z.a,Z.b,Z.c,Z.d,Z.e,Z.f))}function interpolateTransform(Z,U,W,X){function tt(st){return st.length?st.pop()+" ":""}function Y(st,at,ct,ht,ut,dt){if(st!==ct||at!==ht){var _t=ut.push("translate(",null,U,null,W);dt.push({i:_t-4,x:interpolateNumber(st,ct)},{i:_t-2,x:interpolateNumber(at,ht)})}else(ct||ht)&&ut.push("translate("+ct+U+ht+W)}function nt(st,at,ct,ht){st!==at?(st-at>180?at+=360:at-st>180&&(st+=360),ht.push({i:ct.push(tt(ct)+"rotate(",null,X)-2,x:interpolateNumber(st,at)})):at&&ct.push(tt(ct)+"rotate("+at+X)}function it(st,at,ct,ht){st!==at?ht.push({i:ct.push(tt(ct)+"skewX(",null,X)-2,x:interpolateNumber(st,at)}):at&&ct.push(tt(ct)+"skewX("+at+X)}function rt(st,at,ct,ht,ut,dt){if(st!==ct||at!==ht){var _t=ut.push(tt(ut)+"scale(",null,",",null,")");dt.push({i:_t-4,x:interpolateNumber(st,ct)},{i:_t-2,x:interpolateNumber(at,ht)})}else(ct!==1||ht!==1)&&ut.push(tt(ut)+"scale("+ct+","+ht+")")}return function(st,at){var ct=[],ht=[];return st=Z(st),at=Z(at),Y(st.translateX,st.translateY,at.translateX,at.translateY,ct,ht),nt(st.rotate,at.rotate,ct,ht),it(st.skewX,at.skewX,ct,ht),rt(st.scaleX,st.scaleY,at.scaleX,at.scaleY,ct,ht),st=at=null,function(ut){for(var dt=-1,_t=ht.length,kt;++dt<_t;)ct[(kt=ht[dt]).i]=kt.x(ut);return ct.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),epsilon2=1e-12;function cosh(Z){return((Z=Math.exp(Z))+1/Z)/2}function sinh(Z){return((Z=Math.exp(Z))-1/Z)/2}function tanh(Z){return((Z=Math.exp(2*Z))-1)/(Z+1)}const interpolateZoom=function Z(U,W,X){function tt(Y,nt){var it=Y[0],rt=Y[1],st=Y[2],at=nt[0],ct=nt[1],ht=nt[2],ut=at-it,dt=ct-rt,_t=ut*ut+dt*dt,kt,gt;if(_t<epsilon2)gt=Math.log(ht/st)/U,kt=function(Pt){return[it+Pt*ut,rt+Pt*dt,st*Math.exp(U*Pt*gt)]};else{var Tt=Math.sqrt(_t),Ot=(ht*ht-st*st+X*_t)/(2*st*W*Tt),Lt=(ht*ht-st*st-X*_t)/(2*ht*W*Tt),vt=Math.log(Math.sqrt(Ot*Ot+1)-Ot),bt=Math.log(Math.sqrt(Lt*Lt+1)-Lt);gt=(bt-vt)/U,kt=function(Pt){var zt=Pt*gt,wt=cosh(vt),Ct=st/(W*Tt)*(wt*tanh(U*zt+vt)-sinh(vt));return[it+Ct*ut,rt+Ct*dt,st*wt/cosh(U*zt+vt)]}}return kt.duration=gt*1e3*U/Math.SQRT2,kt}return tt.rho=function(Y){var nt=Math.max(.001,+Y),it=nt*nt,rt=it*it;return Z(nt,it,rt)},tt}(Math.SQRT2,2,4);var frame=0,timeout$1=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(Z){setTimeout(Z,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}Timer.prototype=timer.prototype={constructor:Timer,restart:function(Z,U,W){if(typeof Z!="function")throw new TypeError("callback is not a function");W=(W==null?now():+W)+(U==null?0:+U),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=Z,this._time=W,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};function timer(Z,U,W){var X=new Timer;return X.restart(Z,U,W),X}function timerFlush(){now(),++frame;for(var Z=taskHead,U;Z;)(U=clockNow-Z._time)>=0&&Z._call.call(void 0,U),Z=Z._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout$1=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var Z=clock.now(),U=Z-clockLast;U>pokeDelay&&(clockSkew-=U,clockLast=Z)}function nap(){for(var Z,U=taskHead,W,X=1/0;U;)U._call?(X>U._time&&(X=U._time),Z=U,U=U._next):(W=U._next,U._next=null,U=Z?Z._next=W:taskHead=W);taskTail=Z,sleep(X)}function sleep(Z){if(!frame){timeout$1&&(timeout$1=clearTimeout(timeout$1));var U=Z-clockNow;U>24?(Z<1/0&&(timeout$1=setTimeout(wake,Z-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}function timeout(Z,U,W){var X=new Timer;return U=U==null?0:+U,X.restart(tt=>{X.stop(),Z(tt+U)},U,W),X}var emptyOn=dispatch("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(Z,U,W,X,tt,Y){var nt=Z.__transition;if(!nt)Z.__transition={};else if(W in nt)return;create(Z,W,{name:U,index:X,group:tt,on:emptyOn,tween:emptyTween,time:Y.time,delay:Y.delay,duration:Y.duration,ease:Y.ease,timer:null,state:CREATED})}function init(Z,U){var W=get(Z,U);if(W.state>CREATED)throw new Error("too late; already scheduled");return W}function set(Z,U){var W=get(Z,U);if(W.state>STARTED)throw new Error("too late; already running");return W}function get(Z,U){var W=Z.__transition;if(!W||!(W=W[U]))throw new Error("transition not found");return W}function create(Z,U,W){var X=Z.__transition,tt;X[U]=W,W.timer=timer(Y,0,W.time);function Y(st){W.state=SCHEDULED,W.timer.restart(nt,W.delay,W.time),W.delay<=st&&nt(st-W.delay)}function nt(st){var at,ct,ht,ut;if(W.state!==SCHEDULED)return rt();for(at in X)if(ut=X[at],ut.name===W.name){if(ut.state===STARTED)return timeout(nt);ut.state===RUNNING?(ut.state=ENDED,ut.timer.stop(),ut.on.call("interrupt",Z,Z.__data__,ut.index,ut.group),delete X[at]):+at<U&&(ut.state=ENDED,ut.timer.stop(),ut.on.call("cancel",Z,Z.__data__,ut.index,ut.group),delete X[at])}if(timeout(function(){W.state===STARTED&&(W.state=RUNNING,W.timer.restart(it,W.delay,W.time),it(st))}),W.state=STARTING,W.on.call("start",Z,Z.__data__,W.index,W.group),W.state===STARTING){for(W.state=STARTED,tt=new Array(ht=W.tween.length),at=0,ct=-1;at<ht;++at)(ut=W.tween[at].value.call(Z,Z.__data__,W.index,W.group))&&(tt[++ct]=ut);tt.length=ct+1}}function it(st){for(var at=st<W.duration?W.ease.call(null,st/W.duration):(W.timer.restart(rt),W.state=ENDING,1),ct=-1,ht=tt.length;++ct<ht;)tt[ct].call(Z,at);W.state===ENDING&&(W.on.call("end",Z,Z.__data__,W.index,W.group),rt())}function rt(){W.state=ENDED,W.timer.stop(),delete X[U];for(var st in X)return;delete Z.__transition}}function interrupt(Z,U){var W=Z.__transition,X,tt,Y=!0,nt;if(W){U=U==null?null:U+"";for(nt in W){if((X=W[nt]).name!==U){Y=!1;continue}tt=X.state>STARTING&&X.state<ENDING,X.state=ENDED,X.timer.stop(),X.on.call(tt?"interrupt":"cancel",Z,Z.__data__,X.index,X.group),delete W[nt]}Y&&delete Z.__transition}}function selection_interrupt(Z){return this.each(function(){interrupt(this,Z)})}function tweenRemove(Z,U){var W,X;return function(){var tt=set(this,Z),Y=tt.tween;if(Y!==W){X=W=Y;for(var nt=0,it=X.length;nt<it;++nt)if(X[nt].name===U){X=X.slice(),X.splice(nt,1);break}}tt.tween=X}}function tweenFunction(Z,U,W){var X,tt;if(typeof W!="function")throw new Error;return function(){var Y=set(this,Z),nt=Y.tween;if(nt!==X){tt=(X=nt).slice();for(var it={name:U,value:W},rt=0,st=tt.length;rt<st;++rt)if(tt[rt].name===U){tt[rt]=it;break}rt===st&&tt.push(it)}Y.tween=tt}}function transition_tween(Z,U){var W=this._id;if(Z+="",arguments.length<2){for(var X=get(this.node(),W).tween,tt=0,Y=X.length,nt;tt<Y;++tt)if((nt=X[tt]).name===Z)return nt.value;return null}return this.each((U==null?tweenRemove:tweenFunction)(W,Z,U))}function tweenValue(Z,U,W){var X=Z._id;return Z.each(function(){var tt=set(this,X);(tt.value||(tt.value={}))[U]=W.apply(this,arguments)}),function(tt){return get(tt,X).value[U]}}function interpolate(Z,U){var W;return(typeof U=="number"?interpolateNumber:U instanceof color?interpolateRgb:(W=color(U))?(U=W,interpolateRgb):interpolateString)(Z,U)}function attrRemove(Z){return function(){this.removeAttribute(Z)}}function attrRemoveNS(Z){return function(){this.removeAttributeNS(Z.space,Z.local)}}function attrConstant(Z,U,W){var X,tt=W+"",Y;return function(){var nt=this.getAttribute(Z);return nt===tt?null:nt===X?Y:Y=U(X=nt,W)}}function attrConstantNS(Z,U,W){var X,tt=W+"",Y;return function(){var nt=this.getAttributeNS(Z.space,Z.local);return nt===tt?null:nt===X?Y:Y=U(X=nt,W)}}function attrFunction(Z,U,W){var X,tt,Y;return function(){var nt,it=W(this),rt;return it==null?void this.removeAttribute(Z):(nt=this.getAttribute(Z),rt=it+"",nt===rt?null:nt===X&&rt===tt?Y:(tt=rt,Y=U(X=nt,it)))}}function attrFunctionNS(Z,U,W){var X,tt,Y;return function(){var nt,it=W(this),rt;return it==null?void this.removeAttributeNS(Z.space,Z.local):(nt=this.getAttributeNS(Z.space,Z.local),rt=it+"",nt===rt?null:nt===X&&rt===tt?Y:(tt=rt,Y=U(X=nt,it)))}}function transition_attr(Z,U){var W=namespace(Z),X=W==="transform"?interpolateTransformSvg:interpolate;return this.attrTween(Z,typeof U=="function"?(W.local?attrFunctionNS:attrFunction)(W,X,tweenValue(this,"attr."+Z,U)):U==null?(W.local?attrRemoveNS:attrRemove)(W):(W.local?attrConstantNS:attrConstant)(W,X,U))}function attrInterpolate(Z,U){return function(W){this.setAttribute(Z,U.call(this,W))}}function attrInterpolateNS(Z,U){return function(W){this.setAttributeNS(Z.space,Z.local,U.call(this,W))}}function attrTweenNS(Z,U){var W,X;function tt(){var Y=U.apply(this,arguments);return Y!==X&&(W=(X=Y)&&attrInterpolateNS(Z,Y)),W}return tt._value=U,tt}function attrTween(Z,U){var W,X;function tt(){var Y=U.apply(this,arguments);return Y!==X&&(W=(X=Y)&&attrInterpolate(Z,Y)),W}return tt._value=U,tt}function transition_attrTween(Z,U){var W="attr."+Z;if(arguments.length<2)return(W=this.tween(W))&&W._value;if(U==null)return this.tween(W,null);if(typeof U!="function")throw new Error;var X=namespace(Z);return this.tween(W,(X.local?attrTweenNS:attrTween)(X,U))}function delayFunction(Z,U){return function(){init(this,Z).delay=+U.apply(this,arguments)}}function delayConstant(Z,U){return U=+U,function(){init(this,Z).delay=U}}function transition_delay(Z){var U=this._id;return arguments.length?this.each((typeof Z=="function"?delayFunction:delayConstant)(U,Z)):get(this.node(),U).delay}function durationFunction(Z,U){return function(){set(this,Z).duration=+U.apply(this,arguments)}}function durationConstant(Z,U){return U=+U,function(){set(this,Z).duration=U}}function transition_duration(Z){var U=this._id;return arguments.length?this.each((typeof Z=="function"?durationFunction:durationConstant)(U,Z)):get(this.node(),U).duration}function easeConstant(Z,U){if(typeof U!="function")throw new Error;return function(){set(this,Z).ease=U}}function transition_ease(Z){var U=this._id;return arguments.length?this.each(easeConstant(U,Z)):get(this.node(),U).ease}function easeVarying(Z,U){return function(){var W=U.apply(this,arguments);if(typeof W!="function")throw new Error;set(this,Z).ease=W}}function transition_easeVarying(Z){if(typeof Z!="function")throw new Error;return this.each(easeVarying(this._id,Z))}function transition_filter(Z){typeof Z!="function"&&(Z=matcher(Z));for(var U=this._groups,W=U.length,X=new Array(W),tt=0;tt<W;++tt)for(var Y=U[tt],nt=Y.length,it=X[tt]=[],rt,st=0;st<nt;++st)(rt=Y[st])&&Z.call(rt,rt.__data__,st,Y)&&it.push(rt);return new Transition(X,this._parents,this._name,this._id)}function transition_merge(Z){if(Z._id!==this._id)throw new Error;for(var U=this._groups,W=Z._groups,X=U.length,tt=W.length,Y=Math.min(X,tt),nt=new Array(X),it=0;it<Y;++it)for(var rt=U[it],st=W[it],at=rt.length,ct=nt[it]=new Array(at),ht,ut=0;ut<at;++ut)(ht=rt[ut]||st[ut])&&(ct[ut]=ht);for(;it<X;++it)nt[it]=U[it];return new Transition(nt,this._parents,this._name,this._id)}function start(Z){return(Z+"").trim().split(/^|\s+/).every(function(U){var W=U.indexOf(".");return W>=0&&(U=U.slice(0,W)),!U||U==="start"})}function onFunction(Z,U,W){var X,tt,Y=start(U)?init:set;return function(){var nt=Y(this,Z),it=nt.on;it!==X&&(tt=(X=it).copy()).on(U,W),nt.on=tt}}function transition_on(Z,U){var W=this._id;return arguments.length<2?get(this.node(),W).on.on(Z):this.each(onFunction(W,Z,U))}function removeFunction(Z){return function(){var U=this.parentNode;for(var W in this.__transition)if(+W!==Z)return;U&&U.removeChild(this)}}function transition_remove(){return this.on("end.remove",removeFunction(this._id))}function transition_select(Z){var U=this._name,W=this._id;typeof Z!="function"&&(Z=selector(Z));for(var X=this._groups,tt=X.length,Y=new Array(tt),nt=0;nt<tt;++nt)for(var it=X[nt],rt=it.length,st=Y[nt]=new Array(rt),at,ct,ht=0;ht<rt;++ht)(at=it[ht])&&(ct=Z.call(at,at.__data__,ht,it))&&("__data__"in at&&(ct.__data__=at.__data__),st[ht]=ct,schedule(st[ht],U,W,ht,st,get(at,W)));return new Transition(Y,this._parents,U,W)}function transition_selectAll(Z){var U=this._name,W=this._id;typeof Z!="function"&&(Z=selectorAll(Z));for(var X=this._groups,tt=X.length,Y=[],nt=[],it=0;it<tt;++it)for(var rt=X[it],st=rt.length,at,ct=0;ct<st;++ct)if(at=rt[ct]){for(var ht=Z.call(at,at.__data__,ct,rt),ut,dt=get(at,W),_t=0,kt=ht.length;_t<kt;++_t)(ut=ht[_t])&&schedule(ut,U,W,_t,ht,dt);Y.push(ht),nt.push(at)}return new Transition(Y,nt,U,W)}var Selection=selection.prototype.constructor;function transition_selection(){return new Selection(this._groups,this._parents)}function styleNull(Z,U){var W,X,tt;return function(){var Y=styleValue(this,Z),nt=(this.style.removeProperty(Z),styleValue(this,Z));return Y===nt?null:Y===W&&nt===X?tt:tt=U(W=Y,X=nt)}}function styleRemove(Z){return function(){this.style.removeProperty(Z)}}function styleConstant(Z,U,W){var X,tt=W+"",Y;return function(){var nt=styleValue(this,Z);return nt===tt?null:nt===X?Y:Y=U(X=nt,W)}}function styleFunction(Z,U,W){var X,tt,Y;return function(){var nt=styleValue(this,Z),it=W(this),rt=it+"";return it==null&&(rt=it=(this.style.removeProperty(Z),styleValue(this,Z))),nt===rt?null:nt===X&&rt===tt?Y:(tt=rt,Y=U(X=nt,it))}}function styleMaybeRemove(Z,U){var W,X,tt,Y="style."+U,nt="end."+Y,it;return function(){var rt=set(this,Z),st=rt.on,at=rt.value[Y]==null?it||(it=styleRemove(U)):void 0;(st!==W||tt!==at)&&(X=(W=st).copy()).on(nt,tt=at),rt.on=X}}function transition_style(Z,U,W){var X=(Z+="")=="transform"?interpolateTransformCss:interpolate;return U==null?this.styleTween(Z,styleNull(Z,X)).on("end.style."+Z,styleRemove(Z)):typeof U=="function"?this.styleTween(Z,styleFunction(Z,X,tweenValue(this,"style."+Z,U))).each(styleMaybeRemove(this._id,Z)):this.styleTween(Z,styleConstant(Z,X,U),W).on("end.style."+Z,null)}function styleInterpolate(Z,U,W){return function(X){this.style.setProperty(Z,U.call(this,X),W)}}function styleTween(Z,U,W){var X,tt;function Y(){var nt=U.apply(this,arguments);return nt!==tt&&(X=(tt=nt)&&styleInterpolate(Z,nt,W)),X}return Y._value=U,Y}function transition_styleTween(Z,U,W){var X="style."+(Z+="");if(arguments.length<2)return(X=this.tween(X))&&X._value;if(U==null)return this.tween(X,null);if(typeof U!="function")throw new Error;return this.tween(X,styleTween(Z,U,W??""))}function textConstant(Z){return function(){this.textContent=Z}}function textFunction(Z){return function(){var U=Z(this);this.textContent=U??""}}function transition_text(Z){return this.tween("text",typeof Z=="function"?textFunction(tweenValue(this,"text",Z)):textConstant(Z==null?"":Z+""))}function textInterpolate(Z){return function(U){this.textContent=Z.call(this,U)}}function textTween(Z){var U,W;function X(){var tt=Z.apply(this,arguments);return tt!==W&&(U=(W=tt)&&textInterpolate(tt)),U}return X._value=Z,X}function transition_textTween(Z){var U="text";if(arguments.length<1)return(U=this.tween(U))&&U._value;if(Z==null)return this.tween(U,null);if(typeof Z!="function")throw new Error;return this.tween(U,textTween(Z))}function transition_transition(){for(var Z=this._name,U=this._id,W=newId(),X=this._groups,tt=X.length,Y=0;Y<tt;++Y)for(var nt=X[Y],it=nt.length,rt,st=0;st<it;++st)if(rt=nt[st]){var at=get(rt,U);schedule(rt,Z,W,st,nt,{time:at.time+at.delay+at.duration,delay:0,duration:at.duration,ease:at.ease})}return new Transition(X,this._parents,Z,W)}function transition_end(){var Z,U,W=this,X=W._id,tt=W.size();return new Promise(function(Y,nt){var it={value:nt},rt={value:function(){--tt===0&&Y()}};W.each(function(){var st=set(this,X),at=st.on;at!==Z&&(U=(Z=at).copy(),U._.cancel.push(it),U._.interrupt.push(it),U._.end.push(rt)),st.on=U}),tt===0&&Y()})}var id=0;function Transition(Z,U,W,X){this._groups=Z,this._parents=U,this._name=W,this._id=X}function newId(){return++id}var selection_prototype=selection.prototype;Transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,selectChild:selection_prototype.selectChild,selectChildren:selection_prototype.selectChildren,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,textTween:transition_textTween,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease,easeVarying:transition_easeVarying,end:transition_end,[Symbol.iterator]:selection_prototype[Symbol.iterator]};function cubicInOut(Z){return((Z*=2)<=1?Z*Z*Z:(Z-=2)*Z*Z+2)/2}var defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit(Z,U){for(var W;!(W=Z.__transition)||!(W=W[U]);)if(!(Z=Z.parentNode))throw new Error(`transition ${U} not found`);return W}function selection_transition(Z){var U,W;Z instanceof Transition?(U=Z._id,Z=Z._name):(U=newId(),(W=defaultTiming).time=now(),Z=Z==null?null:Z+"");for(var X=this._groups,tt=X.length,Y=0;Y<tt;++Y)for(var nt=X[Y],it=nt.length,rt,st=0;st<it;++st)(rt=nt[st])&&schedule(rt,Z,U,st,nt,W||inherit(rt,U));return new Transition(X,this._parents,Z,U)}selection.prototype.interrupt=selection_interrupt;selection.prototype.transition=selection_transition;const constant=Z=>()=>Z;function ZoomEvent(Z,{sourceEvent:U,target:W,transform:X,dispatch:tt}){Object.defineProperties(this,{type:{value:Z,enumerable:!0,configurable:!0},sourceEvent:{value:U,enumerable:!0,configurable:!0},target:{value:W,enumerable:!0,configurable:!0},transform:{value:X,enumerable:!0,configurable:!0},_:{value:tt}})}function Transform(Z,U,W){this.k=Z,this.x=U,this.y=W}Transform.prototype={constructor:Transform,scale:function(Z){return Z===1?this:new Transform(this.k*Z,this.x,this.y)},translate:function(Z,U){return Z===0&U===0?this:new Transform(this.k,this.x+this.k*Z,this.y+this.k*U)},apply:function(Z){return[Z[0]*this.k+this.x,Z[1]*this.k+this.y]},applyX:function(Z){return Z*this.k+this.x},applyY:function(Z){return Z*this.k+this.y},invert:function(Z){return[(Z[0]-this.x)/this.k,(Z[1]-this.y)/this.k]},invertX:function(Z){return(Z-this.x)/this.k},invertY:function(Z){return(Z-this.y)/this.k},rescaleX:function(Z){return Z.copy().domain(Z.range().map(this.invertX,this).map(Z.invert,Z))},rescaleY:function(Z){return Z.copy().domain(Z.range().map(this.invertY,this).map(Z.invert,Z))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var identity=new Transform(1,0,0);transform.prototype=Transform.prototype;function transform(Z){for(;!Z.__zoom;)if(!(Z=Z.parentNode))return identity;return Z.__zoom}function nopropagation(Z){Z.stopImmediatePropagation()}function noevent(Z){Z.preventDefault(),Z.stopImmediatePropagation()}function defaultFilter(Z){return(!Z.ctrlKey||Z.type==="wheel")&&!Z.button}function defaultExtent(){var Z=this;return Z instanceof SVGElement?(Z=Z.ownerSVGElement||Z,Z.hasAttribute("viewBox")?(Z=Z.viewBox.baseVal,[[Z.x,Z.y],[Z.x+Z.width,Z.y+Z.height]]):[[0,0],[Z.width.baseVal.value,Z.height.baseVal.value]]):[[0,0],[Z.clientWidth,Z.clientHeight]]}function defaultTransform(){return this.__zoom||identity}function defaultWheelDelta(Z){return-Z.deltaY*(Z.deltaMode===1?.05:Z.deltaMode?1:.002)*(Z.ctrlKey?10:1)}function defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function defaultConstrain(Z,U,W){var X=Z.invertX(U[0][0])-W[0][0],tt=Z.invertX(U[1][0])-W[1][0],Y=Z.invertY(U[0][1])-W[0][1],nt=Z.invertY(U[1][1])-W[1][1];return Z.translate(tt>X?(X+tt)/2:Math.min(0,X)||Math.max(0,tt),nt>Y?(Y+nt)/2:Math.min(0,Y)||Math.max(0,nt))}function zoom(){var Z=defaultFilter,U=defaultExtent,W=defaultConstrain,X=defaultWheelDelta,tt=defaultTouchable,Y=[0,1/0],nt=[[-1/0,-1/0],[1/0,1/0]],it=250,rt=interpolateZoom,st=dispatch("start","zoom","end"),at,ct,ht,ut=500,dt=150,_t=0,kt=10;function gt(mt){mt.property("__zoom",defaultTransform).on("wheel.zoom",zt,{passive:!1}).on("mousedown.zoom",wt).on("dblclick.zoom",Ct).filter(tt).on("touchstart.zoom",Vt).on("touchmove.zoom",Ut).on("touchend.zoom touchcancel.zoom",oe).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}gt.transform=function(mt,Bt,It,At){var Et=mt.selection?mt.selection():mt;Et.property("__zoom",defaultTransform),mt!==Et?vt(mt,Bt,It,At):Et.interrupt().each(function(){bt(this,arguments).event(At).start().zoom(null,typeof Bt=="function"?Bt.apply(this,arguments):Bt).end()})},gt.scaleBy=function(mt,Bt,It,At){gt.scaleTo(mt,function(){var Et=this.__zoom.k,jt=typeof Bt=="function"?Bt.apply(this,arguments):Bt;return Et*jt},It,At)},gt.scaleTo=function(mt,Bt,It,At){gt.transform(mt,function(){var Et=U.apply(this,arguments),jt=this.__zoom,Mt=It==null?Lt(Et):typeof It=="function"?It.apply(this,arguments):It,Zt=jt.invert(Mt),Xt=typeof Bt=="function"?Bt.apply(this,arguments):Bt;return W(Ot(Tt(jt,Xt),Mt,Zt),Et,nt)},It,At)},gt.translateBy=function(mt,Bt,It,At){gt.transform(mt,function(){return W(this.__zoom.translate(typeof Bt=="function"?Bt.apply(this,arguments):Bt,typeof It=="function"?It.apply(this,arguments):It),U.apply(this,arguments),nt)},null,At)},gt.translateTo=function(mt,Bt,It,At,Et){gt.transform(mt,function(){var jt=U.apply(this,arguments),Mt=this.__zoom,Zt=At==null?Lt(jt):typeof At=="function"?At.apply(this,arguments):At;return W(identity.translate(Zt[0],Zt[1]).scale(Mt.k).translate(typeof Bt=="function"?-Bt.apply(this,arguments):-Bt,typeof It=="function"?-It.apply(this,arguments):-It),jt,nt)},At,Et)};function Tt(mt,Bt){return Bt=Math.max(Y[0],Math.min(Y[1],Bt)),Bt===mt.k?mt:new Transform(Bt,mt.x,mt.y)}function Ot(mt,Bt,It){var At=Bt[0]-It[0]*mt.k,Et=Bt[1]-It[1]*mt.k;return At===mt.x&&Et===mt.y?mt:new Transform(mt.k,At,Et)}function Lt(mt){return[(+mt[0][0]+ +mt[1][0])/2,(+mt[0][1]+ +mt[1][1])/2]}function vt(mt,Bt,It,At){mt.on("start.zoom",function(){bt(this,arguments).event(At).start()}).on("interrupt.zoom end.zoom",function(){bt(this,arguments).event(At).end()}).tween("zoom",function(){var Et=this,jt=arguments,Mt=bt(Et,jt).event(At),Zt=U.apply(Et,jt),Xt=It==null?Lt(Zt):typeof It=="function"?It.apply(Et,jt):It,Yt=Math.max(Zt[1][0]-Zt[0][0],Zt[1][1]-Zt[0][1]),qt=Et.__zoom,Ft=typeof Bt=="function"?Bt.apply(Et,jt):Bt,te=rt(qt.invert(Xt).concat(Yt/qt.k),Ft.invert(Xt).concat(Yt/Ft.k));return function(se){if(se===1)se=Ft;else{var Jt=te(se),be=Yt/Jt[2];se=new Transform(be,Xt[0]-Jt[0]*be,Xt[1]-Jt[1]*be)}Mt.zoom(null,se)}})}function bt(mt,Bt,It){return!It&&mt.__zooming||new Pt(mt,Bt)}function Pt(mt,Bt){this.that=mt,this.args=Bt,this.active=0,this.sourceEvent=null,this.extent=U.apply(mt,Bt),this.taps=0}Pt.prototype={event:function(mt){return mt&&(this.sourceEvent=mt),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(mt,Bt){return this.mouse&&mt!=="mouse"&&(this.mouse[1]=Bt.invert(this.mouse[0])),this.touch0&&mt!=="touch"&&(this.touch0[1]=Bt.invert(this.touch0[0])),this.touch1&&mt!=="touch"&&(this.touch1[1]=Bt.invert(this.touch1[0])),this.that.__zoom=Bt,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(mt){var Bt=select(this.that).datum();st.call(mt,this.that,new ZoomEvent(mt,{sourceEvent:this.sourceEvent,target:gt,type:mt,transform:this.that.__zoom,dispatch:st}),Bt)}};function zt(mt,...Bt){if(!Z.apply(this,arguments))return;var It=bt(this,Bt).event(mt),At=this.__zoom,Et=Math.max(Y[0],Math.min(Y[1],At.k*Math.pow(2,X.apply(this,arguments)))),jt=pointer(mt);if(It.wheel)(It.mouse[0][0]!==jt[0]||It.mouse[0][1]!==jt[1])&&(It.mouse[1]=At.invert(It.mouse[0]=jt)),clearTimeout(It.wheel);else{if(At.k===Et)return;It.mouse=[jt,At.invert(jt)],interrupt(this),It.start()}noevent(mt),It.wheel=setTimeout(Mt,dt),It.zoom("mouse",W(Ot(Tt(At,Et),It.mouse[0],It.mouse[1]),It.extent,nt));function Mt(){It.wheel=null,It.end()}}function wt(mt,...Bt){if(ht||!Z.apply(this,arguments))return;var It=mt.currentTarget,At=bt(this,Bt,!0).event(mt),Et=select(mt.view).on("mousemove.zoom",Xt,!0).on("mouseup.zoom",Yt,!0),jt=pointer(mt,It),Mt=mt.clientX,Zt=mt.clientY;dragDisable(mt.view),nopropagation(mt),At.mouse=[jt,this.__zoom.invert(jt)],interrupt(this),At.start();function Xt(qt){if(noevent(qt),!At.moved){var Ft=qt.clientX-Mt,te=qt.clientY-Zt;At.moved=Ft*Ft+te*te>_t}At.event(qt).zoom("mouse",W(Ot(At.that.__zoom,At.mouse[0]=pointer(qt,It),At.mouse[1]),At.extent,nt))}function Yt(qt){Et.on("mousemove.zoom mouseup.zoom",null),yesdrag(qt.view,At.moved),noevent(qt),At.event(qt).end()}}function Ct(mt,...Bt){if(Z.apply(this,arguments)){var It=this.__zoom,At=pointer(mt.changedTouches?mt.changedTouches[0]:mt,this),Et=It.invert(At),jt=It.k*(mt.shiftKey?.5:2),Mt=W(Ot(Tt(It,jt),At,Et),U.apply(this,Bt),nt);noevent(mt),it>0?select(this).transition().duration(it).call(vt,Mt,At,mt):select(this).call(gt.transform,Mt,At,mt)}}function Vt(mt,...Bt){if(Z.apply(this,arguments)){var It=mt.touches,At=It.length,Et=bt(this,Bt,mt.changedTouches.length===At).event(mt),jt,Mt,Zt,Xt;for(nopropagation(mt),Mt=0;Mt<At;++Mt)Zt=It[Mt],Xt=pointer(Zt,this),Xt=[Xt,this.__zoom.invert(Xt),Zt.identifier],Et.touch0?!Et.touch1&&Et.touch0[2]!==Xt[2]&&(Et.touch1=Xt,Et.taps=0):(Et.touch0=Xt,jt=!0,Et.taps=1+!!at);at&&(at=clearTimeout(at)),jt&&(Et.taps<2&&(ct=Xt[0],at=setTimeout(function(){at=null},ut)),interrupt(this),Et.start())}}function Ut(mt,...Bt){if(this.__zooming){var It=bt(this,Bt).event(mt),At=mt.changedTouches,Et=At.length,jt,Mt,Zt,Xt;for(noevent(mt),jt=0;jt<Et;++jt)Mt=At[jt],Zt=pointer(Mt,this),It.touch0&&It.touch0[2]===Mt.identifier?It.touch0[0]=Zt:It.touch1&&It.touch1[2]===Mt.identifier&&(It.touch1[0]=Zt);if(Mt=It.that.__zoom,It.touch1){var Yt=It.touch0[0],qt=It.touch0[1],Ft=It.touch1[0],te=It.touch1[1],se=(se=Ft[0]-Yt[0])*se+(se=Ft[1]-Yt[1])*se,Jt=(Jt=te[0]-qt[0])*Jt+(Jt=te[1]-qt[1])*Jt;Mt=Tt(Mt,Math.sqrt(se/Jt)),Zt=[(Yt[0]+Ft[0])/2,(Yt[1]+Ft[1])/2],Xt=[(qt[0]+te[0])/2,(qt[1]+te[1])/2]}else if(It.touch0)Zt=It.touch0[0],Xt=It.touch0[1];else return;It.zoom("touch",W(Ot(Mt,Zt,Xt),It.extent,nt))}}function oe(mt,...Bt){if(this.__zooming){var It=bt(this,Bt).event(mt),At=mt.changedTouches,Et=At.length,jt,Mt;for(nopropagation(mt),ht&&clearTimeout(ht),ht=setTimeout(function(){ht=null},ut),jt=0;jt<Et;++jt)Mt=At[jt],It.touch0&&It.touch0[2]===Mt.identifier?delete It.touch0:It.touch1&&It.touch1[2]===Mt.identifier&&delete It.touch1;if(It.touch1&&!It.touch0&&(It.touch0=It.touch1,delete It.touch1),It.touch0)It.touch0[1]=this.__zoom.invert(It.touch0[0]);else if(It.end(),It.taps===2&&(Mt=pointer(Mt,this),Math.hypot(ct[0]-Mt[0],ct[1]-Mt[1])<kt)){var Zt=select(this).on("dblclick.zoom");Zt&&Zt.apply(this,arguments)}}}return gt.wheelDelta=function(mt){return arguments.length?(X=typeof mt=="function"?mt:constant(+mt),gt):X},gt.filter=function(mt){return arguments.length?(Z=typeof mt=="function"?mt:constant(!!mt),gt):Z},gt.touchable=function(mt){return arguments.length?(tt=typeof mt=="function"?mt:constant(!!mt),gt):tt},gt.extent=function(mt){return arguments.length?(U=typeof mt=="function"?mt:constant([[+mt[0][0],+mt[0][1]],[+mt[1][0],+mt[1][1]]]),gt):U},gt.scaleExtent=function(mt){return arguments.length?(Y[0]=+mt[0],Y[1]=+mt[1],gt):[Y[0],Y[1]]},gt.translateExtent=function(mt){return arguments.length?(nt[0][0]=+mt[0][0],nt[1][0]=+mt[1][0],nt[0][1]=+mt[0][1],nt[1][1]=+mt[1][1],gt):[[nt[0][0],nt[0][1]],[nt[1][0],nt[1][1]]]},gt.constrain=function(mt){return arguments.length?(W=mt,gt):W},gt.duration=function(mt){return arguments.length?(it=+mt,gt):it},gt.interpolate=function(mt){return arguments.length?(rt=mt,gt):rt},gt.on=function(){var mt=st.on.apply(st,arguments);return mt===st?gt:mt},gt.clickDistance=function(mt){return arguments.length?(_t=(mt=+mt)*mt,gt):Math.sqrt(_t)},gt.tapDistance=function(mt){return arguments.length?(kt=+mt,gt):kt},gt}function create_else_block$3(Z){let U,W,X,tt,Y,nt,it,rt;return{c(){U=svg_element("g"),W=svg_element("rect"),nt=svg_element("text"),it=text(Z[0]),attr(W,"class","EdgeTextBg"),attr(W,"data-testid","edge-text-bg"),attr(W,"fill",X=Z[5]?Z[5]:"white"),attr(W,"x",tt=Z[3]-Z[1]/2),attr(W,"y",Y=Z[2]-shiftRectY),attr(W,"width",Z[1]),attr(W,"height",16),attr(nt,"class","EdgeText"),attr(nt,"x",Z[3]),attr(nt,"y",Z[2]),attr(nt,"font-size","12px"),attr(nt,"dominant-baseline","central"),attr(nt,"text-anchor","middle"),attr(nt,"fill",rt=Z[4]?Z[4]:"black")},m(st,at){insert(st,U,at),append(U,W),append(U,nt),append(nt,it)},p(st,at){at&32&&X!==(X=st[5]?st[5]:"white")&&attr(W,"fill",X),at&10&&tt!==(tt=st[3]-st[1]/2)&&attr(W,"x",tt),at&4&&Y!==(Y=st[2]-shiftRectY)&&attr(W,"y",Y),at&2&&attr(W,"width",st[1]),at&1&&set_data(it,st[0]),at&8&&attr(nt,"x",st[3]),at&4&&attr(nt,"y",st[2]),at&16&&rt!==(rt=st[4]?st[4]:"black")&&attr(nt,"fill",rt)},d(st){st&&detach(U)}}}function create_if_block$6(Z){let U=null+"",W;return{c(){W=text(U)},m(X,tt){insert(X,W,tt)},p:noop$1,d(X){X&&detach(W)}}}function create_fragment$m(Z){let U;function W(Y,nt){return typeof Y[0]>"u"||!Y[0]?create_if_block$6:create_else_block$3}let X=W(Z),tt=X(Z);return{c(){tt.c(),U=empty$1()},m(Y,nt){tt.m(Y,nt),insert(Y,U,nt)},p(Y,[nt]){X===(X=W(Y))&&tt?tt.p(Y,nt):(tt.d(1),tt=X(Y),tt&&(tt.c(),tt.m(U.parentNode,U)))},i:noop$1,o:noop$1,d(Y){tt.d(Y),Y&&detach(U)}}}const shiftRectY=7;function instance$m(Z,U,W){let X,tt,Y,nt,it,rt,st,at,ct,ht,ut,{edgeTextProps:dt}=U;return Z.$$set=_t=>{"edgeTextProps"in _t&&W(6,dt=_t.edgeTextProps)},Z.$$.update=()=>{Z.$$.dirty&64&&W(0,{label:X,labelBgColor:tt,labelTextColor:Y,centerX:nt,centerY:it}=dt,X,(W(5,tt),W(6,dt)),(W(4,Y),W(6,dt)),(W(11,nt),W(6,dt)),(W(10,it),W(6,dt))),Z.$$.dirty&1&&W(7,rt=X.length<3?9:7),Z.$$.dirty&2048&&W(3,st=nt),Z.$$.dirty&1024&&W(2,at=it),Z.$$.dirty&1&&W(9,ct=X.split(" ").length-1),Z.$$.dirty&513&&W(8,ht=X.length-ct),Z.$$.dirty&384&&W(1,ut=ht*rt)},[X,ut,at,st,Y,tt,dt,rt,ht,ct,it,nt]}class EdgeText extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$m,create_fragment$m,safe_not_equal,{edgeTextProps:6})}}const BaseEdge_svelte_svelte_type_style_lang="";function create_if_block_2$1(Z){let U,W,X;return{c(){U=svg_element("path"),attr(U,"id","edgeSelector"),attr(U,"d",Z[4]),attr(U,"fill","transparent"),attr(U,"stroke","red"),attr(U,"stroke-opacity","0"),attr(U,"stroke-width","20"),attr(U,"class","svelte-7tz672")},m(tt,Y){insert(tt,U,Y),W||(X=[listen(U,"contextmenu",Z[7]),listen(U,"click",Z[8]),listen(U,"keypress",keypress_handler)],W=!0)},p(tt,Y){Y&16&&attr(U,"d",tt[4])},d(tt){tt&&detach(U),W=!1,run_all(X)}}}function create_else_block$2(Z){let U,W,X;return{c(){U=svg_element("path"),attr(U,"class",W=null_to_empty(Z[3]?`animate ${Z[5].className}`:`${Z[5].className}`)+" svelte-7tz672"),attr(U,"d",Z[4]),attr(U,"fill","transparent"),attr(U,"stroke",X=Z[1]?Z[1]:"gray"),attr(U,"aria-label","svg-path")},m(tt,Y){insert(tt,U,Y)},p(tt,Y){Y&8&&W!==(W=null_to_empty(tt[3]?`animate ${tt[5].className}`:`${tt[5].className}`)+" svelte-7tz672")&&attr(U,"class",W),Y&16&&attr(U,"d",tt[4]),Y&2&&X!==(X=tt[1]?tt[1]:"gray")&&attr(U,"stroke",X)},d(tt){tt&&detach(U)}}}function create_if_block_1$2(Z){let U,W,X;return{c(){U=svg_element("path"),attr(U,"class",W=null_to_empty(Z[3]?`animate ${Z[5].className}`:`${Z[5].className}`)+" svelte-7tz672"),attr(U,"d",Z[4]),attr(U,"fill","transparent"),attr(U,"stroke",X=Z[1]?Z[1]:"gray"),attr(U,"marker-end","url(#arrow)"),attr(U,"aria-label","svg-path")},m(tt,Y){insert(tt,U,Y)},p(tt,Y){Y&8&&W!==(W=null_to_empty(tt[3]?`animate ${tt[5].className}`:`${tt[5].className}`)+" svelte-7tz672")&&attr(U,"class",W),Y&16&&attr(U,"d",tt[4]),Y&2&&X!==(X=tt[1]?tt[1]:"gray")&&attr(U,"stroke",X)},d(tt){tt&&detach(U)}}}function create_if_block$5(Z){let U,W;return U=new EdgeText({props:{edgeTextProps:Z[0]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt&1&&(Y.edgeTextProps=X[0]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_fragment$l(Z){let U,W,X,tt,Y,nt,it,rt,st=Z[6]&&create_if_block_2$1(Z);function at(dt,_t){return dt[2]?create_if_block_1$2:create_else_block$2}let ct=at(Z),ht=ct(Z),ut=Z[0].label&&create_if_block$5(Z);return{c(){U=svg_element("defs"),W=svg_element("marker"),X=svg_element("polygon"),tt=space(),st&&st.c(),Y=space(),ht.c(),nt=space(),ut&&ut.c(),it=empty$1(),attr(X,"points",Z[9]),attr(X,"fill","gray"),attr(W,"id","arrow"),attr(W,"markerWidth","9"),attr(W,"markerHeight","9"),attr(W,"refX","8"),attr(W,"refY","4"),attr(W,"orient","auto")},m(dt,_t){insert(dt,U,_t),append(U,W),append(W,X),insert(dt,tt,_t),st&&st.m(dt,_t),insert(dt,Y,_t),ht.m(dt,_t),insert(dt,nt,_t),ut&&ut.m(dt,_t),insert(dt,it,_t),rt=!0},p(dt,[_t]){dt[6]&&st.p(dt,_t),ct===(ct=at(dt))&&ht?ht.p(dt,_t):(ht.d(1),ht=ct(dt),ht&&(ht.c(),ht.m(nt.parentNode,nt))),dt[0].label?ut?(ut.p(dt,_t),_t&1&&transition_in(ut,1)):(ut=create_if_block$5(dt),ut.c(),transition_in(ut,1),ut.m(it.parentNode,it)):ut&&(group_outros(),transition_out(ut,1,1,()=>{ut=null}),check_outros())},i(dt){rt||(transition_in(ut),rt=!0)},o(dt){transition_out(ut),rt=!1},d(dt){dt&&detach(U),dt&&detach(tt),st&&st.d(dt),dt&&detach(Y),ht.d(dt),dt&&detach(nt),ut&&ut.d(dt),dt&&detach(it)}}}const keypress_handler=()=>{};function instance$l(Z,U,W){let X,tt,Y,nt,it,rt,st,at,ct,ht,{baseEdgeProps:ut}=U,{canvasId:dt}=U;const _t=ut.id,kt=findStore(dt),gt=getEdgeById(kt,_t),Tt=get_store_value(kt.highlightEdgesOption),Ot=()=>{const bt=findStore(dt),{editableOption:Pt}=bt;get_store_value(Pt)&&bt.edgeEditModal.set(_t)},Lt=()=>{const bt=findStore(dt),Pt=getEdgeById(bt,_t);Pt.clickCallback&&Pt.clickCallback(Pt),console.log(Pt.className)},vt="0 0, 9 4.5, 0 9";return Z.$$set=bt=>{"baseEdgeProps"in bt&&W(10,ut=bt.baseEdgeProps),"canvasId"in bt&&W(11,dt=bt.canvasId)},Z.$$.update=()=>{Z.$$.dirty&1024&&W(4,{path:X,animate:tt,arrow:Y,label:nt,labelBgColor:it,labelTextColor:rt,edgeColor:st,centerX:at,centerY:ct}=ut,X,(W(3,tt),W(10,ut)),(W(2,Y),W(10,ut)),(W(16,nt),W(10,ut)),(W(15,it),W(10,ut)),(W(14,rt),W(10,ut)),(W(1,st),W(10,ut)),(W(13,at),W(10,ut)),(W(12,ct),W(10,ut))),Z.$$.dirty&126976&&W(0,ht={label:nt,labelBgColor:it,labelTextColor:rt,centerX:at,centerY:ct})},[ht,st,Y,tt,X,gt,Tt,Ot,Lt,vt,ut,dt,ct,at,rt,it,nt]}class BaseEdge extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$l,create_fragment$l,safe_not_equal,{baseEdgeProps:10,canvasId:11})}}function create_fragment$k(Z){let U,W;return U=new BaseEdge({props:{baseEdgeProps:Z[1],canvasId:Z[0]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,[tt]){const Y={};tt&2&&(Y.baseEdgeProps=X[1]),tt&1&&(Y.canvasId=X[0]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function calculateControlOffset(Z,U){return Z>=0?.5*Z:U*25*Math.sqrt(-Z)}function instance$k(Z,U,W){let X,tt,Y,nt,it;const rt={};rt.Left="left",rt.Right="right",rt.Top="top",rt.Bottom="bottom";function st({pos:Lt,x1:vt,y1:bt,x2:Pt,y2:zt,c:wt}){let Ct,Vt;switch(Lt){case rt.Left:Ct=vt-calculateControlOffset(vt-Pt,wt),Vt=bt;break;case rt.Right:Ct=vt+calculateControlOffset(Pt-vt,wt),Vt=bt;break;case rt.Top:Ct=vt,Vt=bt-calculateControlOffset(bt-zt,wt);break;case rt.Bottom:Ct=vt,Vt=bt+calculateControlOffset(zt-bt,wt);break}return[Ct,Vt]}function at({sourceX:Lt,sourceY:vt,sourcePosition:bt=rt.Bottom,targetX:Pt,targetY:zt,targetPosition:wt=rt.Top,curvature:Ct=.25}){const[Vt,Ut]=st({pos:bt,x1:Lt,y1:vt,x2:Pt,y2:zt,c:Ct}),[oe,mt]=st({pos:wt,x1:Pt,y1:zt,x2:Lt,y2:vt,c:Ct});return`M${Lt},${vt} C${Vt},${Ut} ${oe},${mt} ${Pt},${zt}`}function ct({sourceX:Lt,sourceY:vt,sourcePosition:bt=rt.Bottom,targetX:Pt,targetY:zt,targetPosition:wt=rt.Top,curvature:Ct=.25}){const[Vt,Ut]=st({pos:bt,x1:Lt,y1:vt,x2:Pt,y2:zt,c:Ct}),[oe,mt]=st({pos:wt,x1:Pt,y1:zt,x2:Lt,y2:vt,c:Ct}),Bt=Lt*.125+Vt*.375+oe*.375+Pt*.125,It=vt*.125+Ut*.375+mt*.375+zt*.125,At=Math.abs(Bt-Lt),Et=Math.abs(It-vt);return[Bt,It,At,Et]}let{canvasId:ht}=U,{edgeId:ut}=U;const dt=findStore(ht),{nodesStore:_t,edgesStore:kt,anchorsStore:gt}=dt;component_subscribe(Z,kt,Lt=>W(9,it=Lt));let Tt,Ot;return Z.$$set=Lt=>{"canvasId"in Lt&&W(0,ht=Lt.canvasId),"edgeId"in Lt&&W(3,ut=Lt.edgeId)},Z.$$.update=()=>{if(Z.$$.dirty&520&&W(4,Tt=it[ut]),Z.$$.dirty&17){const Lt=findStore(ht),vt=getAnchorFromEdge(Lt,Tt.id,"source"),bt=getAnchorFromEdge(Lt,Tt.id,"target"),Pt={0:"right",90:"top",180:"left",270:"bottom"};W(5,Ot={sourceX:Tt.sourceX,sourceY:Tt.sourceY,sourcePosition:Pt[vt.angle],targetX:Tt.targetX,targetY:Tt.targetY,targetPosition:Pt[bt.angle],curvature:.25})}Z.$$.dirty&32&&W(8,X=at(Ot)),Z.$$.dirty&32&&W(7,[tt,Y]=ct(Ot),tt,(W(6,Y),W(5,Ot),W(0,ht),W(4,Tt),W(9,it),W(3,ut))),Z.$$.dirty&464&&W(1,nt={...Tt,path:X,centerX:tt,centerY:Y})},[ht,nt,kt,ut,Tt,Ot,Y,tt,X,it]}class SimpleBezierEdge extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$k,create_fragment$k,safe_not_equal,{canvasId:0,edgeId:3})}}var Position;(function(Z){Z.Left="left",Z.Right="right",Z.Top="top",Z.Bottom="bottom"})(Position||(Position={}));const LeftOrRight=[Position.Left,Position.Right],getCenter=({sourceX:Z,sourceY:U,targetX:W,targetY:X,sourcePosition:tt=Position.Bottom,targetPosition:Y=Position.Top})=>{const nt=LeftOrRight.includes(tt),it=LeftOrRight.includes(Y);if(nt&&!it||it&&!nt){const ut=nt?Math.abs(W-Z):0,dt=Z>W?Z-ut:Z+ut,_t=nt?0:Math.abs(X-U),kt=U<X?U+_t:U-_t;return[dt,kt,ut,_t]}const st=Math.abs(W-Z)/2,at=W<Z?W+st:W-st,ct=Math.abs(X-U)/2,ht=X<U?X+ct:X-ct;return[at,ht,st,ct]};function create_fragment$j(Z){let U,W;return U=new BaseEdge({props:{baseEdgeProps:Z[1],canvasId:Z[0]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,[tt]){const Y={};tt&2&&(Y.baseEdgeProps=X[1]),tt&1&&(Y.canvasId=X[0]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function instance$j(Z,U,W){let X,tt,Y,nt;const it={};it.Left="left",it.Right="right",it.Top="top",it.Bottom="bottom";const rt=(vt,bt,Pt)=>`L ${vt},${bt-Pt}Q ${vt},${bt} ${vt+Pt},${bt}`,st=(vt,bt,Pt)=>`L ${vt+Pt},${bt}Q ${vt},${bt} ${vt},${bt-Pt}`,at=(vt,bt,Pt)=>`L ${vt},${bt-Pt}Q ${vt},${bt} ${vt-Pt},${bt}`,ct=(vt,bt,Pt)=>`L ${vt-Pt},${bt}Q ${vt},${bt} ${vt},${bt-Pt}`,ht=(vt,bt,Pt)=>`L ${vt+Pt},${bt}Q ${vt},${bt} ${vt},${bt+Pt}`,ut=(vt,bt,Pt)=>`L ${vt},${bt+Pt}Q ${vt},${bt} ${vt+Pt},${bt}`,dt=(vt,bt,Pt)=>`L ${vt},${bt+Pt}Q ${vt},${bt} ${vt-Pt},${bt}`,_t=(vt,bt,Pt)=>`L ${vt-Pt},${bt}Q ${vt},${bt} ${vt},${bt+Pt}`;function kt({sourceX:vt,sourceY:bt,sourcePosition:Pt=it.Bottom,targetX:zt,targetY:wt,targetPosition:Ct=it.Top,borderRadius:Vt=5,centerX:Ut,centerY:oe}){const[mt,Bt,It,At]=getCenter({sourceX:vt,sourceY:bt,targetX:zt,targetY:wt}),Et=Math.min(Vt,Math.abs(zt-vt)),jt=Math.min(Vt,Math.abs(wt-bt)),Mt=Math.min(Et,jt,It,At),Zt=[it.Left,it.Right],Xt=typeof Ut<"u"?Ut:mt,Yt=typeof oe<"u"?oe:Bt;let qt=null,Ft=null;return vt<=zt?(qt=bt<=wt?rt(vt,Yt,Mt):ut(vt,Yt,Mt),Ft=bt<=wt?_t(zt,Yt,Mt):ct(zt,Yt,Mt)):(qt=bt<wt?at(vt,Yt,Mt):dt(vt,Yt,Mt),Ft=bt<wt?ht(zt,Yt,Mt):st(zt,Yt,Mt)),Zt.includes(Pt)&&Zt.includes(Ct)?vt<=zt?(qt=bt<=wt?_t(Xt,bt,Mt):ct(Xt,bt,Mt),Ft=bt<=wt?rt(Xt,wt,Mt):ut(Xt,wt,Mt)):(Pt===it.Right&&Ct===it.Left||Pt===it.Left&&Ct===it.Right||Pt===it.Left&&Ct===it.Left)&&(qt=bt<=wt?ht(Xt,bt,Mt):st(Xt,bt,Mt),Ft=bt<=wt?at(Xt,wt,Mt):dt(Xt,wt,Mt)):Zt.includes(Pt)&&!Zt.includes(Ct)?(vt<=zt?qt=bt<=wt?_t(zt,bt,Mt):ct(zt,bt,Mt):qt=bt<=wt?ht(zt,bt,Mt):st(zt,bt,Mt),Ft=""):!Zt.includes(Pt)&&Zt.includes(Ct)&&(vt<=zt?qt=bt<=wt?rt(vt,wt,Mt):ut(vt,wt,Mt):qt=bt<=wt?at(vt,wt,Mt):dt(vt,wt,Mt),Ft=""),`M ${vt},${bt}${qt}${Ft}L ${zt},${wt}`}let{edge:gt}=U,{borderRadius:Tt=5}=U,{canvasId:Ot}=U,Lt;return Z.$$set=vt=>{"edge"in vt&&W(3,gt=vt.edge),"borderRadius"in vt&&W(4,Tt=vt.borderRadius),"canvasId"in vt&&W(0,Ot=vt.canvasId)},Z.$$.update=()=>{if(Z.$$.dirty&25){const vt=findStore(Ot),bt=getAnchorFromEdge(vt,gt.id,"source"),Pt=getAnchorFromEdge(vt,gt.id,"target"),zt={0:"right",90:"top",180:"left",270:"bottom"};W(5,Lt={sourceX:gt.sourceX,sourceY:gt.sourceY,targetX:gt.targetX,targetY:gt.targetY,sourcePosition:zt[bt.angle],targetPosition:zt[Pt.angle],borderRadius:Tt})}Z.$$.dirty&32&&W(7,[X,tt]=getCenter(Lt),X,(W(6,tt),W(5,Lt),W(0,Ot),W(3,gt),W(4,Tt))),Z.$$.dirty&32&&W(8,Y=kt(Lt)),Z.$$.dirty&456&&W(1,nt={...gt,path:Y,centerX:X,centerY:tt})},[Ot,nt,kt,gt,Tt,Lt,tt,X,Y]}class SmoothStepEdge extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$j,create_fragment$j,safe_not_equal,{getSmoothStepPath:2,edge:3,borderRadius:4,canvasId:0})}get getSmoothStepPath(){return this.$$.ctx[2]}}function create_fragment$i(Z){let U,W;return U=new SmoothStepEdge({props:{edge:Z[0],borderRadius:0,canvasId:Z[1]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,[tt]){const Y={};tt&1&&(Y.edge=X[0]),tt&2&&(Y.canvasId=X[1]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function instance$i(Z,U,W){let{edge:X}=U,{canvasId:tt}=U;return Z.$$set=Y=>{"edge"in Y&&W(0,X=Y.edge),"canvasId"in Y&&W(1,tt=Y.canvasId)},[X,tt]}class StepEdge extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$i,create_fragment$i,safe_not_equal,{edge:0,canvasId:1})}}function create_fragment$h(Z){let U,W;return U=new BaseEdge({props:{baseEdgeProps:Z[1],canvasId:Z[0]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,[tt]){const Y={};tt&2&&(Y.baseEdgeProps=X[1]),tt&1&&(Y.canvasId=X[0]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function instance$h(Z,U,W){let X,tt,Y,nt,it,rt,st,at,{edgeId:ct}=U,{canvasId:ht}=U;const ut=findStore(ht),{nodesStore:dt,edgesStore:_t,anchorsStore:kt}=ut;return component_subscribe(Z,_t,gt=>W(10,at=gt)),Z.$$set=gt=>{"edgeId"in gt&&W(3,ct=gt.edgeId),"canvasId"in gt&&W(0,ht=gt.canvasId)},Z.$$.update=()=>{Z.$$.dirty&1032&&W(7,X=at[ct]),Z.$$.dirty&128&&W(6,tt=`M ${X.sourceX},${X.sourceY}L ${X.targetX},${X.targetY}`),Z.$$.dirty&128&&W(9,Y=Math.abs(X.targetX-X.sourceX)/2),Z.$$.dirty&128&&W(8,nt=Math.abs(X.targetY-X.sourceY)/2),Z.$$.dirty&640&&W(5,it=X.targetX<X.sourceX?X.targetX+Y:X.targetX-Y),Z.$$.dirty&384&&W(4,rt=X.targetY<X.sourceY?X.targetY+nt:X.targetY-nt),Z.$$.dirty&240&&W(1,st={...X,path:tt,centerX:it,centerY:rt})},[ht,st,_t,ct,rt,it,tt,X,nt,Y,at]}class StraightEdge extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$h,create_fragment$h,safe_not_equal,{edgeId:3,canvasId:0})}}const EdgeAnchor_svelte_svelte_type_style_lang="";function create_fragment$g(Z){let U;return{c(){U=svg_element("circle"),attr(U,"cx",Z[0]),attr(U,"cy",Z[1]),attr(U,"r",5),attr(U,"stroke","white"),attr(U,"fill","black"),attr(U,"class","svelte-1ulqurc")},m(W,X){insert(W,U,X)},p(W,[X]){X&1&&attr(U,"cx",W[0]),X&2&&attr(U,"cy",W[1])},i:noop$1,o:noop$1,d(W){W&&detach(U)}}}function instance$g(Z,U,W){let{x:X}=U,{y:tt}=U;return Z.$$set=Y=>{"x"in Y&&W(0,X=Y.x),"y"in Y&&W(1,tt=Y.y)},[X,tt]}class EdgeAnchor extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$g,create_fragment$g,safe_not_equal,{x:0,y:1})}}const ResizeNode_svelte_svelte_type_style_lang="";function create_fragment$f(Z){let U,W,X,tt;return{c(){U=element("div"),attr(U,"class","ResizeNode svelte-1g55lj2"),set_style(U,"left",Z[2].positionX-10+"px"),set_style(U,"top",Z[2].positionY-10+"px"),set_style(U,"width","20px"),set_style(U,"height","20px"),set_style(U,"background-color","purple"),set_style(U,"border-color","purple"),set_style(U,"border-radius","50%"),attr(U,"id",W="svelvet-"+Z[0])},m(Y,nt){insert(Y,U,nt),X||(tt=[listen(window,"mousemove",Z[11]),listen(window,"mouseup",Z[12]),listen(U,"mousedown",Z[13]),listen(U,"mouseover",Z[14]),listen(U,"focus",Z[9]),listen(U,"mouseleave",Z[15]),listen(U,"mouseenter",Z[16]),listen(U,"wheel",prevent_default(Z[10]))],X=!0)},p(Y,[nt]){nt&4&&set_style(U,"left",Y[2].positionX-10+"px"),nt&4&&set_style(U,"top",Y[2].positionY-10+"px"),nt&1&&W!==(W="svelvet-"+Y[0])&&attr(U,"id",W)},i:noop$1,o:noop$1,d(Y){Y&&detach(U),X=!1,run_all(tt)}}}function instance$f(Z,U,W){let X,tt,{resizeId:Y}=U,{canvasId:nt}=U;const it=findStore(nt),{resizeNodesStore:rt,nodeSelected:st}=it;component_subscribe(Z,rt,Lt=>W(8,X=Lt)),component_subscribe(Z,st,Lt=>W(3,tt=Lt));let at=!1,ct;function ht(Lt){bubble.call(this,Z,Lt)}function ut(Lt){bubble.call(this,Z,Lt)}const dt=Lt=>{Lt.preventDefault(),at&&rt.update(vt=>{const bt=vt[Y],Pt=get_store_value(it.d3Scale);return bt.setPositionAndCascade(Lt.movementX/Pt,Lt.movementY/Pt,Y),{...vt}})},_t=Lt=>{Lt.preventDefault(),W(1,at=!1)},kt=Lt=>{Lt.preventDefault(),set_store_value(st,tt=!0,tt),W(1,at=!0)},gt=Lt=>set_store_value(st,tt=!0,tt),Tt=Lt=>set_store_value(st,tt=!1,tt),Ot=Lt=>set_store_value(st,tt=!0,tt);return Z.$$set=Lt=>{"resizeId"in Lt&&W(0,Y=Lt.resizeId),"canvasId"in Lt&&W(7,nt=Lt.canvasId)},Z.$$.update=()=>{Z.$$.dirty&257&&W(2,ct=X[Y])},[Y,at,ct,tt,it,rt,st,nt,X,ht,ut,dt,_t,kt,gt,Tt,Ot]}class ResizeNode extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$f,create_fragment$f,safe_not_equal,{resizeId:0,canvasId:7})}}const EditNode_svelte_svelte_type_style_lang="";function create_if_block$4(Z){let U,W,X,tt,Y,nt,it,rt,st,at,ct,ht,ut,dt,_t,kt,gt,Tt,Ot,Lt,vt,bt;return{c(){U=element("div"),W=element("form"),X=element("label"),X.textContent="Label",tt=space(),Y=element("input"),rt=space(),st=element("label"),st.textContent="Background Color",at=space(),ct=element("input"),ut=space(),dt=element("input"),kt=space(),gt=element("div"),Tt=element("button"),Tt.textContent="Delete Node",Ot=space(),Lt=element("button"),Lt.textContent="Submit",attr(X,"for","label-input"),attr(X,"class","svelte-1rprzpr"),attr(Y,"type","text"),attr(Y,"id",nt="label-input-"+Z[1]),attr(Y,"placeholder",it=Z[5].data.label),attr(Y,"class","svelte-1rprzpr"),attr(st,"for","bg-color-input"),attr(st,"class","svelte-1rprzpr"),attr(ct,"type","color"),attr(ct,"id",ht="bg-color-input-"+Z[1]),attr(ct,"class","bgci svelte-1rprzpr"),attr(dt,"type","text"),attr(dt,"placeholder",_t=Z[5].bgColor),attr(dt,"class","svelte-1rprzpr"),attr(W,"class","svelte-1rprzpr"),attr(Tt,"class","svelte-1rprzpr"),attr(Lt,"class","svelte-1rprzpr"),attr(gt,"class","btn-container svelte-1rprzpr"),attr(U,"class","EditNode svelte-1rprzpr"),set_style(U,"left",Z[5].positionX+Z[5].width+"px"),set_style(U,"top",Z[5].positionY+"px")},m(Pt,zt){insert(Pt,U,zt),append(U,W),append(W,X),append(W,tt),append(W,Y),set_input_value(Y,Z[3]),append(W,rt),append(W,st),append(W,at),append(W,ct),set_input_value(ct,Z[4]),append(W,ut),append(W,dt),set_input_value(dt,Z[4]),append(U,kt),append(U,gt),append(gt,Tt),append(gt,Ot),append(gt,Lt),vt||(bt=[listen(Y,"input",Z[12]),listen(ct,"input",Z[13]),listen(dt,"input",Z[14]),listen(W,"submit",Z[9]),listen(Tt,"click",Z[15]),listen(Lt,"click",Z[16]),listen(U,"mouseover",Z[17]),listen(U,"focus",Z[10]),listen(U,"wheel",prevent_default(Z[11]))],vt=!0)},p(Pt,zt){zt&2&&nt!==(nt="label-input-"+Pt[1])&&attr(Y,"id",nt),zt&32&&it!==(it=Pt[5].data.label)&&attr(Y,"placeholder",it),zt&8&&Y.value!==Pt[3]&&set_input_value(Y,Pt[3]),zt&2&&ht!==(ht="bg-color-input-"+Pt[1])&&attr(ct,"id",ht),zt&16&&set_input_value(ct,Pt[4]),zt&32&&_t!==(_t=Pt[5].bgColor)&&attr(dt,"placeholder",_t),zt&16&&dt.value!==Pt[4]&&set_input_value(dt,Pt[4]),zt&32&&set_style(U,"left",Pt[5].positionX+Pt[5].width+"px"),zt&32&&set_style(U,"top",Pt[5].positionY+"px")},d(Pt){Pt&&detach(U),vt=!1,run_all(bt)}}}function create_fragment$e(Z){let U,W=Z[0]&&create_if_block$4(Z);return{c(){W&&W.c(),U=empty$1()},m(X,tt){W&&W.m(X,tt),insert(X,U,tt)},p(X,[tt]){X[0]?W?W.p(X,tt):(W=create_if_block$4(X),W.c(),W.m(U.parentNode,U)):W&&(W.d(1),W=null)},i:noop$1,o:noop$1,d(X){W&&W.d(X),X&&detach(U)}}}function instance$e(Z,U,W){let X,tt,{nodeId:Y}=U,{canvasId:nt}=U,{isEditing:it}=U,rt,st,at,ct;const ht=findStore(nt),{nodesStore:ut,nodeSelected:dt}=ht;component_subscribe(Z,ut,wt=>W(21,X=wt)),component_subscribe(Z,dt,wt=>W(6,tt=wt));let _t=X[Y];const kt=wt=>{wt.preventDefault(),rt&&W(5,_t.data.label=rt,_t),st&&W(5,_t.width=st,_t),at&&W(5,_t.height=at,_t),ct&&W(5,_t.bgColor=ct,_t),st="",at="",W(3,rt=""),ht.nodesStore.set(X)};function gt(wt){bubble.call(this,Z,wt)}function Tt(wt){bubble.call(this,Z,wt)}function Ot(){rt=this.value,W(3,rt)}function Lt(){ct=this.value,W(4,ct)}function vt(){ct=this.value,W(4,ct)}const bt=wt=>{const Ct=findStore(nt);getNodeById(Ct,Y).delete(),W(0,it=!1)},Pt=wt=>{kt(wt),W(0,it=!1)},zt=wt=>set_store_value(dt,tt=!0,tt);return Z.$$set=wt=>{"nodeId"in wt&&W(1,Y=wt.nodeId),"canvasId"in wt&&W(2,nt=wt.canvasId),"isEditing"in wt&&W(0,it=wt.isEditing)},[it,Y,nt,rt,ct,_t,tt,ut,dt,kt,gt,Tt,Ot,Lt,vt,bt,Pt,zt]}class EditNode extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$e,create_fragment$e,safe_not_equal,{nodeId:1,canvasId:2,isEditing:0})}}const forceCssHeightAndWidth=(Z,U)=>{let W,X,tt;for(let Y=0;Y<document.styleSheets.length;Y++){const it=document.styleSheets[Y].cssRules;for(let rt=0;rt<it.length;rt++){const st=it[rt];if(st instanceof CSSStyleRule&&st.selectorText===`.${U.className}`){const at=st.cssText,ct=at.indexOf("{");tt=at.substring(ct+1,at.length-1);const ht=tt.split(" ");ht.forEach((ut,dt)=>{ut==="width:"&&(W=ut.concat(ht[dt+1]),W=parseInt(ht[dt+1])),ut==="height:"&&(X=ut.concat(ht[dt+1]),X=parseInt(ht[dt+1]))})}}}Z.nodesStore.update(Y=>(W!==void 0&&(Y[U.id].width=W),X!==void 0&&(Y[U.id].height=X),{...Y})),U.setPositionFromMovement(0,0),Z.resizeNodesStore.update(Y=>{for(let nt of Object.values(Y))nt.nodeId===U.id&&(nt.positionX=U.positionX+U.width,nt.positionY=U.positionY+U.height);return{...Y}})},Node_svelte_svelte_type_style_lang="";function create_if_block_1$1(Z){let U,W;return U=new EditNode({props:{canvasId:Z[1],nodeId:Z[2],isEditing:Z[3]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt&2&&(Y.canvasId=X[1]),tt&4&&(Y.nodeId=X[2]),tt&8&&(Y.isEditing=X[3]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_if_block$3(Z){let U,W;return{c(){U=element("img"),src_url_equal(U.src,W=Z[0].src)||attr(U,"src",W),attr(U,"alt",""),set_style(U,"width",Z[0].width*.75+"px"),set_style(U,"height",Z[0].height*.75+"px"),set_style(U,"overflow","hidden"),attr(U,"class","svelte-g3bkh5")},m(X,tt){insert(X,U,tt)},p(X,tt){tt&1&&!src_url_equal(U.src,W=X[0].src)&&attr(U,"src",W),tt&1&&set_style(U,"width",X[0].width*.75+"px"),tt&1&&set_style(U,"height",X[0].height*.75+"px")},d(X){X&&detach(U)}}}function create_fragment$d(Z){let U,W,X,tt,Y,nt,it,rt,st=Z[3]&&Z[4]&&create_if_block_1$1(Z),at=Z[0].image&&create_if_block$3(Z);const ct=Z[18].default,ht=create_slot(ct,Z,Z[17],null);return{c(){st&&st.c(),U=space(),W=element("div"),at&&at.c(),X=space(),ht&&ht.c(),attr(W,"class",tt="Node "+Z[0].className+" svelte-g3bkh5"),set_style(W,"left",Z[0].positionX+"px"),set_style(W,"top",Z[0].positionY+"px"),set_style(W,"width",Z[0].width+"px"),set_style(W,"height",Z[0].height+"px"),set_style(W,"background-color",Z[0].bgColor),set_style(W,"border-color",Z[0].borderColor),set_style(W,"border-radius",Z[0].borderRadius+"px"),set_style(W,"color",Z[0].textColor),set_style(W,"cursor",Z[5]?"default":"grab"),attr(W,"id",Y="svelvet-"+Z[0].id)},m(ut,dt){st&&st.m(ut,dt),insert(ut,U,dt),insert(ut,W,dt),at&&at.m(W,null),append(W,X),ht&&ht.m(W,null),nt=!0,it||(rt=[listen(window,"mousemove",Z[14]),listen(window,"mouseup",Z[16]),listen(W,"mouseleave",Z[12]),listen(W,"mousedown",Z[10]),listen(W,"contextmenu",Z[11]),listen(W,"touchmove",Z[15]),listen(W,"touchstart",Z[10]),listen(W,"touchend",Z[16]),listen(W,"mouseenter",Z[13]),listen(W,"wheel",wheel_handler)],it=!0)},p(ut,[dt]){ut[3]&&ut[4]?st?(st.p(ut,dt),dt&24&&transition_in(st,1)):(st=create_if_block_1$1(ut),st.c(),transition_in(st,1),st.m(U.parentNode,U)):st&&(group_outros(),transition_out(st,1,1,()=>{st=null}),check_outros()),ut[0].image?at?at.p(ut,dt):(at=create_if_block$3(ut),at.c(),at.m(W,X)):at&&(at.d(1),at=null),ht&&ht.p&&(!nt||dt&131072)&&update_slot_base(ht,ct,ut,ut[17],nt?get_slot_changes(ct,ut[17],dt,null):get_all_dirty_from_scope(ut[17]),null),(!nt||dt&1&&tt!==(tt="Node "+ut[0].className+" svelte-g3bkh5"))&&attr(W,"class",tt),(!nt||dt&1)&&set_style(W,"left",ut[0].positionX+"px"),(!nt||dt&1)&&set_style(W,"top",ut[0].positionY+"px"),(!nt||dt&1)&&set_style(W,"width",ut[0].width+"px"),(!nt||dt&1)&&set_style(W,"height",ut[0].height+"px"),(!nt||dt&1)&&set_style(W,"background-color",ut[0].bgColor),(!nt||dt&1)&&set_style(W,"border-color",ut[0].borderColor),(!nt||dt&1)&&set_style(W,"border-radius",ut[0].borderRadius+"px"),(!nt||dt&1)&&set_style(W,"color",ut[0].textColor),(!nt||dt&32)&&set_style(W,"cursor",ut[5]?"default":"grab"),(!nt||dt&1&&Y!==(Y="svelvet-"+ut[0].id))&&attr(W,"id",Y)},i(ut){nt||(transition_in(st),transition_in(ht,ut),nt=!0)},o(ut){transition_out(st),transition_out(ht,ut),nt=!1},d(ut){st&&st.d(ut),ut&&detach(U),ut&&detach(W),at&&at.d(),ht&&ht.d(ut),it=!1,run_all(rt)}}}const wheel_handler=Z=>Z.preventDefault();function instance$d(Z,U,W){let X,tt,Y,nt,it,{$$slots:rt={},$$scope:st}=U,{node:at}=U,{canvasId:ct}=U,{nodeId:ht}=U;const ut=findStore(ct),{nodesStore:dt,edgesStore:_t,anchorsStore:kt,nodeSelected:gt,resizeNodesStore:Tt,editableOption:Ot,lockedOption:Lt}=ut;component_subscribe(Z,dt,mt=>W(22,Y=mt)),component_subscribe(Z,gt,mt=>W(21,tt=mt)),component_subscribe(Z,Ot,mt=>W(4,nt=mt)),component_subscribe(Z,Lt,mt=>W(5,it=mt));let vt=!1;afterUpdate(()=>{at.className&&forceCssHeightAndWidth(ut,at)});let bt=!1;const Pt=mt=>{bt=!0,toggleExpandAndCollapse(ut,ht),set_store_value(gt,tt=!0,tt),vt=!0},zt=mt=>{mt.preventDefault(),W(0,at=Y[ht]),set_store_value(gt,tt=!0,tt),vt=!1,W(3,X=X!==!0)},wt=mt=>{bt=!1,set_store_value(gt,tt=!1,tt)},Ct=mt=>{gt.set(!0)},Vt=mt=>{mt.preventDefault(),bt=!1,vt&&dt.update(Bt=>{const It=Bt[ht],At=get_store_value(ut.d3Scale);return It.setPositionFromMovement(mt.movementX/At,mt.movementY/At),{...Bt}})},Ut=mt=>{mt.preventDefault(),bt=!1,vt&&dt.update(Bt=>{const It=Bt[ht],{x:At,y:Et,width:jt,height:Mt}=mt.target.getBoundingClientRect(),Zt=(mt.touches[0].clientX-At)/jt*mt.target.offsetWidth,Xt=(mt.touches[0].clientY-Et)/Mt*mt.target.offsetHeight;return get_store_value(ut.d3Scale),It.setPositionFromMovement(Zt-It.width/2,Xt-It.height/2),{...Bt}})},oe=mt=>{if(mt.preventDefault(),vt=!1,at.clickCallback&&bt&&at.clickCallback(at),get_store_value(ut.options).snap){const Bt=get_store_value(ut.options).snapTo,It=at.positionX,At=at.positionY,Et=Math.round(at.positionX/Bt)*Bt,jt=Math.round(at.positionY/Bt)*Bt;dt.update(Mt=>(Mt[ht].setPositionFromMovement(Et-It,jt-At),{...Mt}))}};return Z.$$set=mt=>{"node"in mt&&W(0,at=mt.node),"canvasId"in mt&&W(1,ct=mt.canvasId),"nodeId"in mt&&W(2,ht=mt.nodeId),"$$scope"in mt&&W(17,st=mt.$$scope)},W(3,X=!1),[at,ct,ht,X,nt,it,dt,gt,Ot,Lt,Pt,zt,wt,Ct,Vt,Ut,oe,st,rt]}class Node extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$d,create_fragment$d,safe_not_equal,{node:0,canvasId:1,nodeId:2})}}const pkStringGenerator$1=()=>(Math.random()+1).toString(36).substring(7);function createEdgeAndAnchors(Z,U,W,X){const tt=pkStringGenerator$1(),Y=new Edge(tt,-1,-1,-1,-1,X,"","bezier","black","black","black",!1,!0,!1,()=>{},""),nt=pkStringGenerator$1(),it=dynamicCbCreator(Z,tt,nt),rt=new Anchor(nt,U,tt,"source",-1,-1,it,X,0),st=pkStringGenerator$1(),at=dynamicCbCreator(Z,tt,st),ct=new Anchor(st,W,tt,"target",-1,-1,at,X,0),{edgesStore:ht,anchorsStore:ut}=Z;ut.update(_t=>(_t[nt]=rt,_t[st]=ct,{..._t})),ht.update(_t=>(_t[tt]=Y,{..._t}));const dt=getAnchors(Z);for(const _t of dt)_t.callback()}const pkStringGenerator=()=>(Math.random()+1).toString(36).substring(7);function createNode(Z,U,W,X,tt){const Y=pkStringGenerator(),nt=new Node$1(Y,W,X,100,100,"white",{label:"new node"},tt,"black",!1,"","black",0,[],"",()=>{}),it=createPotentialAnchor(rightCb,Z,Y,tt),rt=createPotentialAnchor(leftCb,Z,Y,tt),st=createPotentialAnchor(topCb,Z,Y,tt),at=createPotentialAnchor(bottomCb,Z,Y,tt),ct=pkStringGenerator(),ht=new Edge(ct,-1,-1,-1,-1,tt,"","bezier","black","black","black",!1,!0,!1,()=>{},""),ut=pkStringGenerator(),dt=dynamicCbCreator(Z,ct,ut),_t=new Anchor(ut,U,ct,"source",-1,-1,dt,tt,0),kt=pkStringGenerator(),gt=dynamicCbCreator(Z,ct,kt),Tt=new Anchor(kt,Y,ct,"target",-1,-1,gt,tt,0),{nodesStore:Ot,edgesStore:Lt,anchorsStore:vt,potentialAnchorsStore:bt}=Z;Ot.update(wt=>(wt[Y]=nt,{...wt})),vt.update(wt=>(wt[ut]=_t,wt[kt]=Tt,{...wt})),bt.update(wt=>(wt[it.id]=it,wt[st.id]=st,wt[at.id]=at,wt[rt.id]=rt,{...wt})),Lt.update(wt=>(wt[ct]=ht,{...wt}));const Pt=getAnchors(Z);for(const wt of Pt)wt.callback();const zt=getPotentialAnchors(Z);for(const wt of zt)wt.callback()}let TemporaryEdge$1=class{constructor(U,W,X,tt,Y,nt,it,rt,st,at){this.id=U,this.sourcePotentialAnchorId=W,this.sourceX=X,this.sourceY=tt,this.targetPotentialAnchorId=Y,this.targetX=nt,this.targetY=it,this.canvasId=rt,this.type=st,this.edgeColor=at}createEdge(){if(this.targetPotentialAnchorId===null)throw"cannot create edge with null target";const U=findStore(this.canvasId),W=getPotentialAnchorById(U,this.sourcePotentialAnchorId),X=getPotentialAnchorById(U,this.targetPotentialAnchorId),tt=getNodeById(U,W.nodeId),Y=getNodeById(U,X.nodeId);createEdgeAndAnchors(U,tt.id,Y.id,this.canvasId)}createNode(){if(this.targetPotentialAnchorId!==null)throw"you should only create a node when you are hovering over blank space";const U=findStore(this.canvasId),X=getPotentialAnchorById(U,this.sourcePotentialAnchorId).nodeId;createNode(U,X,this.targetX,this.targetY,this.canvasId)}};const PotentialAnchor_svelte_svelte_type_style_lang="";function create_fragment$c(Z){let U,W,X,tt;return{c(){U=element("div"),attr(U,"class","Anchor svelte-1amf2u8"),attr(U,"style",W=`
      height:${anchorHeight}px;
      width:${anchorWidth}px;
      top: ${Z[2]-anchorHeight/2}px;
      left:${Z[1]-anchorWidth/2}px;
    `)},m(Y,nt){insert(Y,U,nt),X||(tt=[listen(window,"mousemove",Z[12]),listen(window,"mouseup",Z[13]),listen(U,"mouseenter",Z[14]),listen(U,"mouseleave",Z[15]),listen(U,"mousedown",Z[16])],X=!0)},p(Y,[nt]){nt&6&&W!==(W=`
      height:${anchorHeight}px;
      width:${anchorWidth}px;
      top: ${Y[2]-anchorHeight/2}px;
      left:${Y[1]-anchorWidth/2}px;
    `)&&attr(U,"style",W)},i:noop$1,o:noop$1,d(Y){Y&&detach(U),X=!1,run_all(tt)}}}let anchorWidth=8,anchorHeight=8;function instance$c(Z,U,W){let X,tt,{canvasId:Y}=U,{x:nt}=U,{y:it}=U,{potentialAnchorId:rt}=U;const st=findStore(Y),at=getPotentialAnchorById(st,rt),{temporaryEdgeStore:ct}=findStore(Y);let ht=!1,ut=!1;const dt=()=>(Math.random()+1).toString(36).substring(7),_t=Lt=>{Lt.preventDefault(),ht&&ct.update(vt=>{if(vt.length!==1)throw"if you are dragging, there should be one edge. We have not implemented multiple edges";const bt=vt[0],Pt=get_store_value(st.d3Scale);return bt.targetX+=Lt.movementX/Pt,bt.targetY+=Lt.movementY/Pt,[bt]})},kt=Lt=>{W(4,ht=!1),get_store_value(ct).length===1&&get_store_value(ct)[0].targetPotentialAnchorId===rt?ct.update(vt=>{for(let bt of vt)rt===bt.targetPotentialAnchorId&&bt.createEdge();return[]}):get_store_value(ct).length===1&&get_store_value(ct)[0].targetPotentialAnchorId===null&&ct.update(vt=>{for(let bt of vt)bt.createNode();return[]})},gt=Lt=>{W(5,ut=!0),ct.update(vt=>{for(let bt of vt)bt.targetPotentialAnchorId=rt;return[...vt]})},Tt=Lt=>{W(5,ut=!1),ht&&ct.update(vt=>{for(let bt of vt)bt.targetPotentialAnchorId===rt&&(bt.targetPotentialAnchorId=null);return[...vt]})},Ot=Lt=>{Lt.preventDefault(),Lt.stopPropagation(),W(4,ht=!0),ct.update(vt=>{if(vt.length===0)return[new TemporaryEdge$1(dt(),at.id,X,tt,null,X,tt,Y,"straight","black")];throw"there should only be zero or one temporary edge at any given time"})};return Z.$$set=Lt=>{"canvasId"in Lt&&W(0,Y=Lt.canvasId),"x"in Lt&&W(1,nt=Lt.x),"y"in Lt&&W(2,it=Lt.y),"potentialAnchorId"in Lt&&W(3,rt=Lt.potentialAnchorId)},Z.$$.update=()=>{Z.$$.dirty&2&&W(7,X=nt),Z.$$.dirty&4&&W(6,tt=it)},[Y,nt,it,rt,ht,ut,tt,X,st,at,ct,dt,_t,kt,gt,Tt,Ot]}class PotentialAnchor extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$c,create_fragment$c,safe_not_equal,{canvasId:0,x:1,y:2,potentialAnchorId:3})}}const TemporaryEdge_svelte_svelte_type_style_lang="";function create_fragment$b(Z){let U;return{c(){U=svg_element("path"),attr(U,"class","animate svelte-qtkn5z"),attr(U,"d",Z[0]),attr(U,"fill","transparent"),attr(U,"stroke","gray"),attr(U,"marker-end","url(#arrow)"),attr(U,"aria-label","svg-path")},m(W,X){insert(W,U,X)},p(W,[X]){X&1&&attr(U,"d",W[0])},i:noop$1,o:noop$1,d(W){W&&detach(U)}}}function instance$b(Z,U,W){let{temporaryEdge:X}=U,tt="";return Z.$$set=Y=>{"temporaryEdge"in Y&&W(1,X=Y.temporaryEdge)},Z.$$.update=()=>{Z.$$.dirty&2&&W(0,tt=`M ${X.sourceX},${X.sourceY}L ${X.targetX},${X.targetY}`)},[tt,X]}class TemporaryEdge extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$b,create_fragment$b,safe_not_equal,{temporaryEdge:1})}}function zoomInit(Z,U,W,X,tt,Y,nt){return Z.select(`.Edges-${U}`).transition().duration(0).call(W.translateTo,0,0).transition().duration(0).call(W.translateTo,tt.x/Y,tt.y/Y).transition().duration(0).call(W.scaleTo,Y.toFixed(2)),X=Z.zoomIdentity.translate(tt.x,tt.y).scale(Y.toFixed(2)),Z.select(`.Nodes-${U}`).transition().duration(0).call(W.translateTo,0,0).transition().duration(0).call(W.translateTo,tt.x/Y,tt.y/Y).transition().duration(0).call(W.scaleTo,Y.toFixed(2)),nt.set(Z.zoomTransform(Z.select(`.Nodes-${U}`)).k),X}function determineD3Instance(Z,U,W,X,tt,Y,nt,it,rt,st,at,ct){return Z?U.zoom().filter(()=>!get_store_value(W)).scaleExtent([.4,2]).translateExtent([[0,0],[Z.x,Z.y]]).extent([[0,0],[X,tt]]).on("zoom",ct):U.zoom().filter(()=>!get_store_value(W)).scaleExtent([.4,2]).on("zoom",ct)}const GreyNodeBoundary_svelte_svelte_type_style_lang="";function create_fragment$a(Z){let U,W;return{c(){U=element("div"),attr(U,"class",W="nodes nodes-"+Z[0]+" svelte-1eef8gz"),set_style(U,"top",Z[1]+"px"),set_style(U,"left",Z[2]+"px"),set_style(U,"height",Z[4]+"px"),set_style(U,"width",Z[3]+"px")},m(X,tt){insert(X,U,tt)},p(X,[tt]){tt&1&&W!==(W="nodes nodes-"+X[0]+" svelte-1eef8gz")&&attr(U,"class",W),tt&2&&set_style(U,"top",X[1]+"px"),tt&4&&set_style(U,"left",X[2]+"px"),tt&16&&set_style(U,"height",X[4]+"px"),tt&8&&set_style(U,"width",X[3]+"px")},i:noop$1,o:noop$1,d(X){X&&detach(U)}}}function instance$a(Z,U,W){let{key:X}=U,{node:tt}=U,{heightRatio:Y}=U,{widthRatio:nt}=U,it=0,rt=0,st=0,at=0;return Z.$$set=ct=>{"key"in ct&&W(0,X=ct.key),"node"in ct&&W(5,tt=ct.node),"heightRatio"in ct&&W(6,Y=ct.heightRatio),"widthRatio"in ct&&W(7,nt=ct.widthRatio)},Z.$$.update=()=>{Z.$$.dirty&224&&(W(4,at=Math.max(tt.height*Y,5)),W(3,st=Math.max(tt.width*nt,5)),W(1,it=tt.positionY*Y),W(2,rt=tt.positionX*nt))},[X,it,rt,st,at,tt,Y,nt]}class GreyNodeBoundary extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$a,create_fragment$a,safe_not_equal,{key:0,node:5,heightRatio:6,widthRatio:7})}}const MinimapBoundary_svelte_svelte_type_style_lang="";function get_each_context$2(Z,U,W){const X=Z.slice();return X[21]=U[W],X}function create_each_block$2(Z){let U,W;return U=new GreyNodeBoundary({props:{node:Z[21],key:Z[0],heightRatio:Z[5],widthRatio:Z[4]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt&2048&&(Y.node=X[21]),tt&1&&(Y.key=X[0]),tt&32&&(Y.heightRatio=X[5]),tt&16&&(Y.widthRatio=X[4]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_fragment$9(Z){let U,W,X,tt,Y,nt,it,rt,st=Object.values(Z[11]),at=[];for(let ht=0;ht<st.length;ht+=1)at[ht]=create_each_block$2(get_each_context$2(Z,st,ht));const ct=ht=>transition_out(at[ht],1,1,()=>{at[ht]=null});return{c(){U=element("div"),W=element("div"),tt=space();for(let ht=0;ht<at.length;ht+=1)at[ht].c();attr(W,"class",X="viewBox viewBox-"+Z[0]+" svelte-ds0tpb"),set_style(W,"height",Z[9]*Z[5]/Z[1].k+"px"),set_style(W,"width",Z[10]*Z[4]/Z[1].k+"px"),set_style(W,"top",Z[7]+"px"),set_style(W,"left",Z[6]+"px"),attr(U,"class",Y=null_to_empty(`miniMap miniMap-${Z[0]}`)+" svelte-ds0tpb"),set_style(U,"height",Z[2]+2+"px"),set_style(U,"width",Z[3]+2+"px")},m(ht,ut){insert(ht,U,ut),append(U,W),append(U,tt);for(let dt=0;dt<at.length;dt+=1)at[dt]&&at[dt].m(U,null);Z[18](U),nt=!0,it||(rt=[listen(U,"click",Z[15]),listen(U,"keydown",keydown_handler$1)],it=!0)},p(ht,[ut]){if((!nt||ut&1&&X!==(X="viewBox viewBox-"+ht[0]+" svelte-ds0tpb"))&&attr(W,"class",X),(!nt||ut&546)&&set_style(W,"height",ht[9]*ht[5]/ht[1].k+"px"),(!nt||ut&1042)&&set_style(W,"width",ht[10]*ht[4]/ht[1].k+"px"),(!nt||ut&128)&&set_style(W,"top",ht[7]+"px"),(!nt||ut&64)&&set_style(W,"left",ht[6]+"px"),ut&2097){st=Object.values(ht[11]);let dt;for(dt=0;dt<st.length;dt+=1){const _t=get_each_context$2(ht,st,dt);at[dt]?(at[dt].p(_t,ut),transition_in(at[dt],1)):(at[dt]=create_each_block$2(_t),at[dt].c(),transition_in(at[dt],1),at[dt].m(U,null))}for(group_outros(),dt=st.length;dt<at.length;dt+=1)ct(dt);check_outros()}(!nt||ut&1&&Y!==(Y=null_to_empty(`miniMap miniMap-${ht[0]}`)+" svelte-ds0tpb"))&&attr(U,"class",Y),(!nt||ut&4)&&set_style(U,"height",ht[2]+2+"px"),(!nt||ut&8)&&set_style(U,"width",ht[3]+2+"px")},i(ht){if(!nt){for(let ut=0;ut<st.length;ut+=1)transition_in(at[ut]);nt=!0}},o(ht){at=at.filter(Boolean);for(let ut=0;ut<at.length;ut+=1)transition_out(at[ut]);nt=!1},d(ht){ht&&detach(U),destroy_each(at,ht),Z[18](null),it=!1,run_all(rt)}}}const keydown_handler$1=()=>{};function instance$9(Z,U,W){let X,tt,Y,{key:nt}=U,{boundary:it}=U,{d3Translate:rt}=U,{store:st}=U;const{nodesStore:at,heightStore:ct,widthStore:ht}=st;component_subscribe(Z,at,zt=>W(11,Y=zt)),component_subscribe(Z,ct,zt=>W(9,X=zt)),component_subscribe(Z,ht,zt=>W(10,tt=zt));const ut=createEventDispatcher();let dt=100,_t=100,kt=1,gt=1,Tt=1,Ot=1,Lt,vt=!1;function bt(zt){if(!vt){vt=!0;let wt=Lt.getBoundingClientRect();ut("message",{x:(zt.clientX-wt.left)/kt,y:(zt.clientY-wt.top)/gt}),setTimeout(()=>{vt=!1},500)}}function Pt(zt){binding_callbacks[zt?"unshift":"push"](()=>{Lt=zt,W(8,Lt)})}return Z.$$set=zt=>{"key"in zt&&W(0,nt=zt.key),"boundary"in zt&&W(16,it=zt.boundary),"d3Translate"in zt&&W(1,rt=zt.d3Translate),"store"in zt&&W(17,st=zt.store)},Z.$$.update=()=>{Z.$$.dirty&65598&&(it.y>it.x?(W(2,dt=100),W(3,_t=Math.max(it.x.toFixed(0)*100/it.y.toFixed(0),25))):it.y<it.x?(W(3,_t=100),W(2,dt=Math.max(it.y.toFixed(0)*100/it.x.toFixed(0),25))):(W(2,dt=100),W(3,_t=100)),W(4,kt=_t/it.x),W(5,gt=dt/it.y),W(6,Tt=Math.abs(rt.x*kt/rt.k)),W(7,Ot=Math.abs(rt.y*gt/rt.k)))},[nt,rt,dt,_t,kt,gt,Tt,Ot,Lt,X,tt,Y,at,ct,ht,bt,it,st,Pt]}class MinimapBoundary extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$9,create_fragment$9,safe_not_equal,{key:0,boundary:16,d3Translate:1,store:17})}}const GreyNodeBoundless_svelte_svelte_type_style_lang="";function create_fragment$8(Z){let U,W;return{c(){U=element("div"),attr(U,"class",W="nodes nodes-"+Z[0]+" svelte-1eef8gz"),set_style(U,"top",Z[1]+"px"),set_style(U,"left",Z[2]+"px"),set_style(U,"height",Z[4]+"px"),set_style(U,"width",Z[3]+"px")},m(X,tt){insert(X,U,tt)},p(X,[tt]){tt&1&&W!==(W="nodes nodes-"+X[0]+" svelte-1eef8gz")&&attr(U,"class",W),tt&2&&set_style(U,"top",X[1]+"px"),tt&4&&set_style(U,"left",X[2]+"px"),tt&16&&set_style(U,"height",X[4]+"px"),tt&8&&set_style(U,"width",X[3]+"px")},i:noop$1,o:noop$1,d(X){X&&detach(U)}}}function instance$8(Z,U,W){let{key:X}=U,{node:tt}=U,{heightRatio:Y}=U,{widthRatio:nt}=U,{nodeXleftPosition:it}=U,{nodeYbottomPosition:rt}=U,st=0,at=0,ct=0,ht=0;return Z.$$set=ut=>{"key"in ut&&W(0,X=ut.key),"node"in ut&&W(5,tt=ut.node),"heightRatio"in ut&&W(6,Y=ut.heightRatio),"widthRatio"in ut&&W(7,nt=ut.widthRatio),"nodeXleftPosition"in ut&&W(8,it=ut.nodeXleftPosition),"nodeYbottomPosition"in ut&&W(9,rt=ut.nodeYbottomPosition)},Z.$$.update=()=>{Z.$$.dirty&992&&(W(4,ht=Math.max(tt.height*Y,5)),W(3,ct=Math.max(tt.width*nt,5)),W(1,st=tt.positionY*Y-rt*Y+1),W(2,at=tt.positionX*nt-it*nt+1))},[X,st,at,ct,ht,tt,Y,nt,it,rt]}class GreyNodeBoundless extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$8,create_fragment$8,safe_not_equal,{key:0,node:5,heightRatio:6,widthRatio:7,nodeXleftPosition:8,nodeYbottomPosition:9})}}const MinimapBoundless_svelte_svelte_type_style_lang="";function get_each_context$1(Z,U,W){const X=Z.slice();return X[30]=U[W],X}function create_each_block$1(Z){let U,W;return U=new GreyNodeBoundless({props:{node:Z[30],key:Z[0],heightRatio:Z[3],widthRatio:Z[4],nodeXleftPosition:Z[5],nodeYbottomPosition:Z[6]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt[0]&128&&(Y.node=X[30]),tt[0]&1&&(Y.key=X[0]),tt[0]&8&&(Y.heightRatio=X[3]),tt[0]&16&&(Y.widthRatio=X[4]),tt[0]&32&&(Y.nodeXleftPosition=X[5]),tt[0]&64&&(Y.nodeYbottomPosition=X[6]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_fragment$7(Z){let U,W,X,tt,Y,nt,it,rt,st=Object.values(Z[7]),at=[];for(let ht=0;ht<st.length;ht+=1)at[ht]=create_each_block$1(get_each_context$1(Z,st,ht));const ct=ht=>transition_out(at[ht],1,1,()=>{at[ht]=null});return{c(){U=element("div"),W=element("div"),tt=space();for(let ht=0;ht<at.length;ht+=1)at[ht].c();attr(W,"class",X="viewBox viewBox-"+Z[0]+" svelte-ds0tpb"),set_style(W,"height",Z[8]+"px"),set_style(W,"width",Z[9]+"px"),set_style(W,"top",Z[11]+"px"),set_style(W,"left",Z[10]+"px"),attr(U,"class",Y=null_to_empty(`miniMap miniMap-${Z[0]}`)+" svelte-ds0tpb"),set_style(U,"height",Z[2]+20+"px"),set_style(U,"width",Z[1]+20+"px")},m(ht,ut){insert(ht,U,ut),append(U,W),append(U,tt);for(let dt=0;dt<at.length;dt+=1)at[dt]&&at[dt].m(U,null);Z[25](U),nt=!0,it||(rt=[listen(U,"click",Z[16]),listen(U,"keydown",keydown_handler)],it=!0)},p(ht,ut){if((!nt||ut[0]&1&&X!==(X="viewBox viewBox-"+ht[0]+" svelte-ds0tpb"))&&attr(W,"class",X),(!nt||ut[0]&256)&&set_style(W,"height",ht[8]+"px"),(!nt||ut[0]&512)&&set_style(W,"width",ht[9]+"px"),(!nt||ut[0]&2048)&&set_style(W,"top",ht[11]+"px"),(!nt||ut[0]&1024)&&set_style(W,"left",ht[10]+"px"),ut[0]&249){st=Object.values(ht[7]);let dt;for(dt=0;dt<st.length;dt+=1){const _t=get_each_context$1(ht,st,dt);at[dt]?(at[dt].p(_t,ut),transition_in(at[dt],1)):(at[dt]=create_each_block$1(_t),at[dt].c(),transition_in(at[dt],1),at[dt].m(U,null))}for(group_outros(),dt=st.length;dt<at.length;dt+=1)ct(dt);check_outros()}(!nt||ut[0]&1&&Y!==(Y=null_to_empty(`miniMap miniMap-${ht[0]}`)+" svelte-ds0tpb"))&&attr(U,"class",Y),(!nt||ut[0]&4)&&set_style(U,"height",ht[2]+20+"px"),(!nt||ut[0]&2)&&set_style(U,"width",ht[1]+20+"px")},i(ht){if(!nt){for(let ut=0;ut<st.length;ut+=1)transition_in(at[ut]);nt=!0}},o(ht){at=at.filter(Boolean);for(let ut=0;ut<at.length;ut+=1)transition_out(at[ut]);nt=!1},d(ht){ht&&detach(U),destroy_each(at,ht),Z[25](null),it=!1,run_all(rt)}}}let mapMax=100;const keydown_handler=()=>{};function instance$7(Z,U,W){let X,tt,Y,{key:nt}=U,{d3Translate:it}=U,{store:rt}=U;const{nodesStore:st,widthStore:at,heightStore:ct}=rt;component_subscribe(Z,st,At=>W(7,Y=At)),component_subscribe(Z,at,At=>W(24,tt=At)),component_subscribe(Z,ct,At=>W(23,X=At));const ht=createEventDispatcher();let ut=mapMax,dt=mapMax,_t=mapMax-10,kt=mapMax-10,gt=10,Tt=10,Ot=10,Lt=10,vt=1,bt=1,Pt=1/0,zt=-1/0,wt=1/0,Ct=-1/0,Vt,Ut=!1;const oe=At=>At*(ut/kt),mt=At=>At*(dt/_t);function Bt(At){if(!Ut){let Et=Vt.getBoundingClientRect();Ut=!0,ht("message",{x:Pt+(At.clientX-Et.left)/bt,y:wt+(At.clientY-Et.top)/vt}),setTimeout(()=>{Ut=!1},500)}}function It(At){binding_callbacks[At?"unshift":"push"](()=>{Vt=At,W(12,Vt)})}return Z.$$set=At=>{"key"in At&&W(0,nt=At.key),"d3Translate"in At&&W(17,it=At.d3Translate),"store"in At&&W(18,rt=At.store)},Z.$$.update=()=>{Z.$$.dirty[0]&33161470&&(W(5,Pt=1/0),W(21,zt=-1/0),W(6,wt=1/0),W(22,Ct=-1/0),Object.values(Y).forEach(At=>{W(5,Pt=Math.min(Pt,At.positionX)),W(22,Ct=Math.max(Ct,At.positionX)),W(6,wt=Math.min(wt,At.positionY)),W(21,zt=Math.max(zt,At.positionY))}),W(19,_t=zt-wt),W(20,kt=Ct-Pt),_t>kt?(W(2,dt=100),W(1,ut=Math.max(kt.toFixed(0)*100/_t.toFixed(0),25))):_t<kt?(W(1,ut=100),W(2,dt=Math.max(_t.toFixed(0)*100/kt.toFixed(0),25))):(W(2,dt=100),W(1,ut=100)),W(3,vt=(dt/_t).toFixed(2)),W(4,bt=(ut/kt).toFixed(2)),W(10,Ot=oe(it.x*bt-it.x/it.k)-Pt*bt),W(11,Lt=mt(it.y*vt-it.y/it.k)-wt*vt),W(9,Tt=tt*bt/it.k),W(8,gt=X*vt/it.k))},[nt,ut,dt,vt,bt,Pt,wt,Y,gt,Tt,Ot,Lt,Vt,st,at,ct,Bt,it,rt,_t,kt,zt,Ct,X,tt,It]}class MinimapBoundless extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$7,create_fragment$7,safe_not_equal,{key:0,d3Translate:17,store:18},null,[-1,-1])}}const EditEdge_svelte_svelte_type_style_lang="";function create_fragment$6(Z){let U,W,X,tt,Y,nt,it,rt,st,at,ct,ht,ut,dt,_t,kt,gt,Tt,Ot,Lt,vt,bt,Pt,zt,wt,Ct,Vt;return{c(){U=element("div"),W=element("form"),X=element("label"),X.textContent="Edge label",tt=space(),Y=element("input"),it=space(),rt=element("label"),rt.textContent="Edge color",st=space(),at=element("input"),ht=space(),ut=element("input"),dt=space(),_t=element("label"),_t.textContent="Edge type",kt=space(),gt=element("input"),Ot=space(),Lt=element("div"),vt=element("button"),vt.textContent="Submit",bt=space(),Pt=element("button"),Pt.textContent="Delete",zt=space(),wt=element("button"),wt.textContent="Cancel",attr(X,"for","label-input"),attr(X,"class","svelte-1bj3i1h"),attr(Y,"type","text"),attr(Y,"id",nt="label-input-"+Z[0]),attr(Y,"placeholder",Z[7].label),attr(Y,"class","svelte-1bj3i1h"),attr(rt,"for","bg-color-input"),attr(rt,"class","svelte-1bj3i1h"),attr(at,"type","color"),attr(at,"id",ct="bg-color-input-"+Z[0]),attr(at,"class","bgci svelte-1bj3i1h"),attr(ut,"type","text"),attr(ut,"placeholder",Z[7].edgeColor),attr(ut,"class","svelte-1bj3i1h"),attr(_t,"for","type-input"),attr(_t,"class","svelte-1bj3i1h"),attr(gt,"type","text"),attr(gt,"id",Tt="type-input-"+Z[0]),attr(gt,"placeholder",Z[7].type),attr(gt,"class","svelte-1bj3i1h"),attr(W,"class","svelte-1bj3i1h"),attr(vt,"class","svelte-1bj3i1h"),attr(Pt,"class","svelte-1bj3i1h"),attr(wt,"class","svelte-1bj3i1h"),attr(Lt,"class","btn-container svelte-1bj3i1h"),attr(U,"class","EditEdge svelte-1bj3i1h"),set_style(U,"left",Z[5]/3+"px"),set_style(U,"top",Z[6]/3+"px")},m(Ut,oe){insert(Ut,U,oe),append(U,W),append(W,X),append(W,tt),append(W,Y),set_input_value(Y,Z[1]),append(W,it),append(W,rt),append(W,st),append(W,at),set_input_value(at,Z[2]),append(W,ht),append(W,ut),set_input_value(ut,Z[2]),append(W,dt),append(W,_t),append(W,kt),append(W,gt),set_input_value(gt,Z[3]),append(U,Ot),append(U,Lt),append(Lt,vt),append(Lt,bt),append(Lt,Pt),append(Lt,zt),append(Lt,wt),Ct||(Vt=[listen(Y,"input",Z[16]),listen(at,"input",Z[17]),listen(ut,"input",Z[18]),listen(gt,"input",Z[19]),listen(W,"submit",Z[12]),listen(vt,"click",Z[12]),listen(Pt,"click",Z[11]),listen(wt,"click",Z[10]),listen(U,"mouseover",Z[20]),listen(U,"focus",Z[14]),listen(U,"wheel",prevent_default(Z[15]))],Ct=!0)},p(Ut,[oe]){oe&1&&nt!==(nt="label-input-"+Ut[0])&&attr(Y,"id",nt),oe&2&&Y.value!==Ut[1]&&set_input_value(Y,Ut[1]),oe&1&&ct!==(ct="bg-color-input-"+Ut[0])&&attr(at,"id",ct),oe&4&&set_input_value(at,Ut[2]),oe&4&&ut.value!==Ut[2]&&set_input_value(ut,Ut[2]),oe&1&&Tt!==(Tt="type-input-"+Ut[0])&&attr(gt,"id",Tt),oe&8&&gt.value!==Ut[3]&&set_input_value(gt,Ut[3])},i:noop$1,o:noop$1,d(Ut){Ut&&detach(U),Ct=!1,run_all(Vt)}}}function instance$6(Z,U,W){let X,tt,{edgeId:Y}=U,{canvasId:nt}=U,it,rt,st;const at=findStore(nt),ct=get_store_value(at.widthStore),ht=get_store_value(at.widthStore),ut=getEdgeById(at,Y),{edgesStore:dt,nodeSelected:_t}=at;component_subscribe(Z,dt,Ct=>W(21,X=Ct)),component_subscribe(Z,_t,Ct=>W(4,tt=Ct));function kt(){findStore(nt).edgeEditModal.set(null)}function gt(){const Ct=findStore(nt);getEdgeById(Ct,Y).delete(),kt()}function Tt(Ct){Ct.preventDefault();const Vt=findStore(nt),Ut=getEdgeById(Vt,Y);it&&(Ut.label=it),rt&&(Ut.edgeColor=rt),st&&(Ut.type=st),Vt.edgesStore.set(X),kt()}function Ot(Ct){bubble.call(this,Z,Ct)}function Lt(Ct){bubble.call(this,Z,Ct)}function vt(){it=this.value,W(1,it)}function bt(){rt=this.value,W(2,rt)}function Pt(){rt=this.value,W(2,rt)}function zt(){st=this.value,W(3,st)}const wt=Ct=>set_store_value(_t,tt=!0,tt);return Z.$$set=Ct=>{"edgeId"in Ct&&W(0,Y=Ct.edgeId),"canvasId"in Ct&&W(13,nt=Ct.canvasId)},[Y,it,rt,st,tt,ct,ht,ut,dt,_t,kt,gt,Tt,nt,Ot,Lt,vt,bt,Pt,zt,wt]}class EditEdge extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$6,create_fragment$6,safe_not_equal,{edgeId:0,canvasId:13})}}const GraphView_svelte_svelte_type_style_lang="";function get_each_context(Z,U,W){const X=Z.slice();return X[55]=U[W],X}function get_each_context_1(Z,U,W){const X=Z.slice();return X[58]=U[W],X}function get_each_context_2(Z,U,W){const X=Z.slice();return X[61]=U[W],X}function get_each_context_3(Z,U,W){const X=Z.slice();return X[64]=U[W],X}function get_each_context_4(Z,U,W){const X=Z.slice();return X[67]=U[W],X}function get_each_context_5(Z,U,W){const X=Z.slice();return X[70]=U[W],X}function create_if_block_8(Z){let U,W;return U=new EditEdge({props:{edgeId:`${Z[10]}`,canvasId:Z[0]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt[0]&1024&&(Y.edgeId=`${X[10]}`),tt[0]&1&&(Y.canvasId=X[0]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_if_block_7(Z){let U,W,X;return W=new MinimapBoundless({props:{key:Z[28],d3Translate:Z[3],store:Z[14]}}),W.$on("message",Z[27]),{c(){U=element("div"),create_component(W.$$.fragment),attr(U,"class","pointer-events-auto svelte-76zvyt")},m(tt,Y){insert(tt,U,Y),mount_component(W,U,null),X=!0},p(tt,Y){const nt={};Y[0]&8&&(nt.d3Translate=tt[3]),W.$set(nt)},i(tt){X||(transition_in(W.$$.fragment,tt),X=!0)},o(tt){transition_out(W.$$.fragment,tt),X=!1},d(tt){tt&&detach(U),destroy_component(W)}}}function create_if_block_6(Z){let U,W,X;return W=new MinimapBoundary({props:{key:Z[28],boundary:Z[1],d3Translate:Z[3],store:Z[14]}}),W.$on("message",Z[27]),{c(){U=element("div"),create_component(W.$$.fragment),attr(U,"class","pointer-events-auto svelte-76zvyt")},m(tt,Y){insert(tt,U,Y),mount_component(W,U,null),X=!0},p(tt,Y){const nt={};Y[0]&2&&(nt.boundary=tt[1]),Y[0]&8&&(nt.d3Translate=tt[3]),W.$set(nt)},i(tt){X||(transition_in(W.$$.fragment,tt),X=!0)},o(tt){transition_out(W.$$.fragment,tt),X=!1},d(tt){tt&&detach(U),destroy_component(W)}}}function create_else_block_1(Z){let U,W;return U=new Node({props:{node:Z[70],canvasId:Z[0],nodeId:Z[70].id,$$slots:{default:[create_default_slot_2]},$$scope:{ctx:Z}}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt[0]&16&&(Y.node=X[70]),tt[0]&1&&(Y.canvasId=X[0]),tt[0]&16&&(Y.nodeId=X[70].id),tt[0]&16|tt[2]&2048&&(Y.$$scope={dirty:tt,ctx:X}),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_if_block_5(Z){let U,W;return U=new Node({props:{node:Z[70],canvasId:Z[0],nodeId:Z[70].id,$$slots:{default:[create_default_slot_1]},$$scope:{ctx:Z}}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt[0]&16&&(Y.node=X[70]),tt[0]&1&&(Y.canvasId=X[0]),tt[0]&16&&(Y.nodeId=X[70].id),tt[0]&16|tt[2]&2048&&(Y.$$scope={dirty:tt,ctx:X}),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_if_block_4(Z){let U,W;return U=new Node({props:{node:Z[70],canvasId:Z[0],nodeId:Z[70].id,$$slots:{default:[create_default_slot]},$$scope:{ctx:Z}}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt[0]&16&&(Y.node=X[70]),tt[0]&1&&(Y.canvasId=X[0]),tt[0]&16&&(Y.nodeId=X[70].id),tt[0]&16|tt[2]&2048&&(Y.$$scope={dirty:tt,ctx:X}),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_default_slot_2(Z){let U=Z[70].data.label+"",W;return{c(){W=text(U)},m(X,tt){insert(X,W,tt)},p(X,tt){tt[0]&16&&U!==(U=X[70].data.label+"")&&set_data(W,U)},d(X){X&&detach(W)}}}function create_default_slot_1(Z){let U,W,X;var tt=Z[70].data.custom;function Y(nt){return{}}return tt&&(U=construct_svelte_component(tt,Y())),{c(){U&&create_component(U.$$.fragment),W=empty$1()},m(nt,it){U&&mount_component(U,nt,it),insert(nt,W,it),X=!0},p(nt,it){if(it[0]&16&&tt!==(tt=nt[70].data.custom)){if(U){group_outros();const rt=U;transition_out(rt.$$.fragment,1,0,()=>{destroy_component(rt,1)}),check_outros()}tt?(U=construct_svelte_component(tt,Y()),create_component(U.$$.fragment),transition_in(U.$$.fragment,1),mount_component(U,W.parentNode,W)):U=null}},i(nt){X||(U&&transition_in(U.$$.fragment,nt),X=!0)},o(nt){U&&transition_out(U.$$.fragment,nt),X=!1},d(nt){nt&&detach(W),U&&destroy_component(U,nt)}}}function create_default_slot(Z){let U,W=Z[70].data.html+"",X;return{c(){U=new HtmlTag(!1),X=empty$1(),U.a=X},m(tt,Y){U.m(W,tt,Y),insert(tt,X,Y)},p(tt,Y){Y[0]&16&&W!==(W=tt[70].data.html+"")&&U.p(W)},d(tt){tt&&detach(X),tt&&U.d()}}}function create_each_block_5(Z){let U,W,X,tt;const Y=[create_if_block_4,create_if_block_5,create_else_block_1],nt=[];function it(rt,st){return rt[70].data.html?0:rt[70].data.custom?1:2}return U=it(Z),W=nt[U]=Y[U](Z),{c(){W.c(),X=empty$1()},m(rt,st){nt[U].m(rt,st),insert(rt,X,st),tt=!0},p(rt,st){let at=U;U=it(rt),U===at?nt[U].p(rt,st):(group_outros(),transition_out(nt[at],1,1,()=>{nt[at]=null}),check_outros(),W=nt[U],W?W.p(rt,st):(W=nt[U]=Y[U](rt),W.c()),transition_in(W,1),W.m(X.parentNode,X))},i(rt){tt||(transition_in(W),tt=!0)},o(rt){transition_out(W),tt=!1},d(rt){nt[U].d(rt),rt&&detach(X)}}}function create_each_block_4(Z){let U,W;return U=new ResizeNode({props:{resizeId:Z[67].id,canvasId:Z[0]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt[0]&64&&(Y.resizeId=X[67].id),tt[0]&1&&(Y.canvasId=X[0]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_each_block_3(Z){let U,W;return U=new PotentialAnchor({props:{canvasId:Z[0],x:Z[64].positionX,y:Z[64].positionY,potentialAnchorId:Z[64].id}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt[0]&1&&(Y.canvasId=X[0]),tt[0]&512&&(Y.x=X[64].positionX),tt[0]&512&&(Y.y=X[64].positionY),tt[0]&512&&(Y.potentialAnchorId=X[64].id),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_if_block_3(Z){let U;return{c(){U=svg_element("rect"),attr(U,"width","100%"),attr(U,"height","100%"),set_style(U,"fill","url(#background-"+Z[0]+")")},m(W,X){insert(W,U,X)},p(W,X){X[0]&1&&set_style(U,"fill","url(#background-"+W[0]+")")},d(W){W&&detach(U)}}}function create_else_block$1(Z){let U,W;return U=new SimpleBezierEdge({props:{edgeId:Z[61].id,canvasId:Z[0]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt[0]&32&&(Y.edgeId=X[61].id),tt[0]&1&&(Y.canvasId=X[0]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_if_block_2(Z){let U,W;return U=new StepEdge({props:{edge:Z[61],canvasId:Z[0]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt[0]&32&&(Y.edge=X[61]),tt[0]&1&&(Y.canvasId=X[0]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_if_block_1(Z){let U,W;return U=new SmoothStepEdge({props:{edge:Z[61],canvasId:Z[0]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt[0]&32&&(Y.edge=X[61]),tt[0]&1&&(Y.canvasId=X[0]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_if_block$2(Z){let U,W;return U=new StraightEdge({props:{edgeId:Z[61].id,canvasId:Z[0]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt[0]&32&&(Y.edgeId=X[61].id),tt[0]&1&&(Y.canvasId=X[0]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_each_block_2(Z){let U,W,X,tt;const Y=[create_if_block$2,create_if_block_1,create_if_block_2,create_else_block$1],nt=[];function it(rt,st){return rt[61].type==="straight"?0:rt[61].type==="smoothstep"?1:rt[61].type==="step"?2:3}return U=it(Z),W=nt[U]=Y[U](Z),{c(){W.c(),X=empty$1()},m(rt,st){nt[U].m(rt,st),insert(rt,X,st),tt=!0},p(rt,st){let at=U;U=it(rt),U===at?nt[U].p(rt,st):(group_outros(),transition_out(nt[at],1,1,()=>{nt[at]=null}),check_outros(),W=nt[U],W?W.p(rt,st):(W=nt[U]=Y[U](rt),W.c()),transition_in(W,1),W.m(X.parentNode,X))},i(rt){tt||(transition_in(W),tt=!0)},o(rt){transition_out(W),tt=!1},d(rt){nt[U].d(rt),rt&&detach(X)}}}function create_each_block_1(Z){let U,W;return U=new TemporaryEdge({props:{temporaryEdge:Z[58]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt[0]&256&&(Y.temporaryEdge=X[58]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_each_block(Z){let U,W;return U=new EdgeAnchor({props:{x:Z[55].positionX,y:Z[55].positionY}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt[0]&128&&(Y.x=X[55].positionX),tt[0]&128&&(Y.y=X[55].positionY),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_fragment$5(Z){let U,W,X,tt,Y,nt,it,rt,st,at,ct,ht,ut,dt,_t,kt,gt,Tt,Ot,Lt,vt,bt,Pt,zt,wt,Ct=Z[10]&&create_if_block_8(Z);const Vt=[create_if_block_6,create_if_block_7],Ut=[];function oe(St,Dt){return St[2]&&St[1]?0:St[2]?1:-1}~(X=oe(Z))&&(tt=Ut[X]=Vt[X](Z));let mt=Z[4],Bt=[];for(let St=0;St<mt.length;St+=1)Bt[St]=create_each_block_5(get_each_context_5(Z,mt,St));const It=St=>transition_out(Bt[St],1,1,()=>{Bt[St]=null});let At=Z[6],Et=[];for(let St=0;St<At.length;St+=1)Et[St]=create_each_block_4(get_each_context_4(Z,At,St));const jt=St=>transition_out(Et[St],1,1,()=>{Et[St]=null});let Mt=Z[9],Zt=[];for(let St=0;St<Mt.length;St+=1)Zt[St]=create_each_block_3(get_each_context_3(Z,Mt,St));const Xt=St=>transition_out(Zt[St],1,1,()=>{Zt[St]=null});let Yt=Z[13]&&create_if_block_3(Z),qt=Z[5],Ft=[];for(let St=0;St<qt.length;St+=1)Ft[St]=create_each_block_2(get_each_context_2(Z,qt,St));const te=St=>transition_out(Ft[St],1,1,()=>{Ft[St]=null});let se=Z[8],Jt=[];for(let St=0;St<se.length;St+=1)Jt[St]=create_each_block_1(get_each_context_1(Z,se,St));const be=St=>transition_out(Jt[St],1,1,()=>{Jt[St]=null});let me=Z[7],Qt=[];for(let St=0;St<me.length;St+=1)Qt[St]=create_each_block(get_each_context(Z,me,St));const _e=St=>transition_out(Qt[St],1,1,()=>{Qt[St]=null});return{c(){Ct&&Ct.c(),U=space(),W=element("div"),tt&&tt.c(),Y=space(),nt=element("div"),it=element("div");for(let St=0;St<Bt.length;St+=1)Bt[St].c();rt=space();for(let St=0;St<Et.length;St+=1)Et[St].c();st=space();for(let St=0;St<Zt.length;St+=1)Zt[St].c();ht=space(),ut=svg_element("svg"),dt=svg_element("defs"),_t=svg_element("pattern"),kt=svg_element("circle"),Yt&&Yt.c(),Tt=svg_element("g");for(let St=0;St<Ft.length;St+=1)Ft[St].c();Ot=empty$1();for(let St=0;St<Jt.length;St+=1)Jt[St].c();Lt=empty$1();for(let St=0;St<Qt.length;St+=1)Qt[St].c();attr(it,"class",at=null_to_empty(`Node Node-${Z[0]}`)+" svelte-76zvyt"),attr(nt,"class",ct=null_to_empty(`Nodes Nodes-${Z[0]}`)+" svelte-76zvyt"),attr(W,"id","graphview-container"),attr(W,"class","svelte-76zvyt"),attr(kt,"id","dot"),attr(kt,"cx",gridSize/2-dotSize/2),attr(kt,"cy",gridSize/2-dotSize/2),attr(kt,"r","0.5"),set_style(kt,"fill","gray"),attr(_t,"id",gt=`background-${Z[0]}`),attr(_t,"x","0"),attr(_t,"y","0"),attr(_t,"width",gridSize),attr(_t,"height",gridSize),attr(_t,"patternUnits","userSpaceOnUse"),attr(_t,"class","svelte-76zvyt"),attr(ut,"class",vt=null_to_empty(`Edges Edges-${Z[0]}`)+" svelte-76zvyt"),attr(ut,"viewBox",bt="0 0 "+Z[11]+" "+Z[12])},m(St,Dt){Ct&&Ct.m(St,Dt),insert(St,U,Dt),insert(St,W,Dt),~X&&Ut[X].m(W,null),append(W,Y),append(W,nt),append(nt,it);for(let ee=0;ee<Bt.length;ee+=1)Bt[ee]&&Bt[ee].m(it,null);append(it,rt);for(let ee=0;ee<Et.length;ee+=1)Et[ee]&&Et[ee].m(it,null);append(it,st);for(let ee=0;ee<Zt.length;ee+=1)Zt[ee]&&Zt[ee].m(it,null);insert(St,ht,Dt),insert(St,ut,Dt),append(ut,dt),append(dt,_t),append(_t,kt),Yt&&Yt.m(ut,null),append(ut,Tt);for(let ee=0;ee<Ft.length;ee+=1)Ft[ee]&&Ft[ee].m(Tt,null);append(Tt,Ot);for(let ee=0;ee<Jt.length;ee+=1)Jt[ee]&&Jt[ee].m(Tt,null);append(Tt,Lt);for(let ee=0;ee<Qt.length;ee+=1)Qt[ee]&&Qt[ee].m(Tt,null);Pt=!0,zt||(wt=[listen(nt,"contextmenu",prevent_default(Z[48])),listen(ut,"contextmenu",prevent_default(Z[47]))],zt=!0)},p(St,Dt){St[10]?Ct?(Ct.p(St,Dt),Dt[0]&1024&&transition_in(Ct,1)):(Ct=create_if_block_8(St),Ct.c(),transition_in(Ct,1),Ct.m(U.parentNode,U)):Ct&&(group_outros(),transition_out(Ct,1,1,()=>{Ct=null}),check_outros());let ee=X;if(X=oe(St),X===ee?~X&&Ut[X].p(St,Dt):(tt&&(group_outros(),transition_out(Ut[ee],1,1,()=>{Ut[ee]=null}),check_outros()),~X?(tt=Ut[X],tt?tt.p(St,Dt):(tt=Ut[X]=Vt[X](St),tt.c()),transition_in(tt,1),tt.m(W,Y)):tt=null),Dt[0]&17){mt=St[4];let Rt;for(Rt=0;Rt<mt.length;Rt+=1){const ue=get_each_context_5(St,mt,Rt);Bt[Rt]?(Bt[Rt].p(ue,Dt),transition_in(Bt[Rt],1)):(Bt[Rt]=create_each_block_5(ue),Bt[Rt].c(),transition_in(Bt[Rt],1),Bt[Rt].m(it,rt))}for(group_outros(),Rt=mt.length;Rt<Bt.length;Rt+=1)It(Rt);check_outros()}if(Dt[0]&65){At=St[6];let Rt;for(Rt=0;Rt<At.length;Rt+=1){const ue=get_each_context_4(St,At,Rt);Et[Rt]?(Et[Rt].p(ue,Dt),transition_in(Et[Rt],1)):(Et[Rt]=create_each_block_4(ue),Et[Rt].c(),transition_in(Et[Rt],1),Et[Rt].m(it,st))}for(group_outros(),Rt=At.length;Rt<Et.length;Rt+=1)jt(Rt);check_outros()}if(Dt[0]&513){Mt=St[9];let Rt;for(Rt=0;Rt<Mt.length;Rt+=1){const ue=get_each_context_3(St,Mt,Rt);Zt[Rt]?(Zt[Rt].p(ue,Dt),transition_in(Zt[Rt],1)):(Zt[Rt]=create_each_block_3(ue),Zt[Rt].c(),transition_in(Zt[Rt],1),Zt[Rt].m(it,null))}for(group_outros(),Rt=Mt.length;Rt<Zt.length;Rt+=1)Xt(Rt);check_outros()}if((!Pt||Dt[0]&1&&at!==(at=null_to_empty(`Node Node-${St[0]}`)+" svelte-76zvyt"))&&attr(it,"class",at),(!Pt||Dt[0]&1&&ct!==(ct=null_to_empty(`Nodes Nodes-${St[0]}`)+" svelte-76zvyt"))&&attr(nt,"class",ct),(!Pt||Dt[0]&1&&gt!==(gt=`background-${St[0]}`))&&attr(_t,"id",gt),St[13]?Yt?Yt.p(St,Dt):(Yt=create_if_block_3(St),Yt.c(),Yt.m(ut,Tt)):Yt&&(Yt.d(1),Yt=null),Dt[0]&33){qt=St[5];let Rt;for(Rt=0;Rt<qt.length;Rt+=1){const ue=get_each_context_2(St,qt,Rt);Ft[Rt]?(Ft[Rt].p(ue,Dt),transition_in(Ft[Rt],1)):(Ft[Rt]=create_each_block_2(ue),Ft[Rt].c(),transition_in(Ft[Rt],1),Ft[Rt].m(Tt,Ot))}for(group_outros(),Rt=qt.length;Rt<Ft.length;Rt+=1)te(Rt);check_outros()}if(Dt[0]&256){se=St[8];let Rt;for(Rt=0;Rt<se.length;Rt+=1){const ue=get_each_context_1(St,se,Rt);Jt[Rt]?(Jt[Rt].p(ue,Dt),transition_in(Jt[Rt],1)):(Jt[Rt]=create_each_block_1(ue),Jt[Rt].c(),transition_in(Jt[Rt],1),Jt[Rt].m(Tt,Lt))}for(group_outros(),Rt=se.length;Rt<Jt.length;Rt+=1)be(Rt);check_outros()}if(Dt[0]&128){me=St[7];let Rt;for(Rt=0;Rt<me.length;Rt+=1){const ue=get_each_context(St,me,Rt);Qt[Rt]?(Qt[Rt].p(ue,Dt),transition_in(Qt[Rt],1)):(Qt[Rt]=create_each_block(ue),Qt[Rt].c(),transition_in(Qt[Rt],1),Qt[Rt].m(Tt,null))}for(group_outros(),Rt=me.length;Rt<Qt.length;Rt+=1)_e(Rt);check_outros()}(!Pt||Dt[0]&1&&vt!==(vt=null_to_empty(`Edges Edges-${St[0]}`)+" svelte-76zvyt"))&&attr(ut,"class",vt),(!Pt||Dt[0]&6144&&bt!==(bt="0 0 "+St[11]+" "+St[12]))&&attr(ut,"viewBox",bt)},i(St){if(!Pt){transition_in(Ct),transition_in(tt);for(let Dt=0;Dt<mt.length;Dt+=1)transition_in(Bt[Dt]);for(let Dt=0;Dt<At.length;Dt+=1)transition_in(Et[Dt]);for(let Dt=0;Dt<Mt.length;Dt+=1)transition_in(Zt[Dt]);for(let Dt=0;Dt<qt.length;Dt+=1)transition_in(Ft[Dt]);for(let Dt=0;Dt<se.length;Dt+=1)transition_in(Jt[Dt]);for(let Dt=0;Dt<me.length;Dt+=1)transition_in(Qt[Dt]);Pt=!0}},o(St){transition_out(Ct),transition_out(tt),Bt=Bt.filter(Boolean);for(let Dt=0;Dt<Bt.length;Dt+=1)transition_out(Bt[Dt]);Et=Et.filter(Boolean);for(let Dt=0;Dt<Et.length;Dt+=1)transition_out(Et[Dt]);Zt=Zt.filter(Boolean);for(let Dt=0;Dt<Zt.length;Dt+=1)transition_out(Zt[Dt]);Ft=Ft.filter(Boolean);for(let Dt=0;Dt<Ft.length;Dt+=1)transition_out(Ft[Dt]);Jt=Jt.filter(Boolean);for(let Dt=0;Dt<Jt.length;Dt+=1)transition_out(Jt[Dt]);Qt=Qt.filter(Boolean);for(let Dt=0;Dt<Qt.length;Dt+=1)transition_out(Qt[Dt]);Pt=!1},d(St){Ct&&Ct.d(St),St&&detach(U),St&&detach(W),~X&&Ut[X].d(),destroy_each(Bt,St),destroy_each(Et,St),destroy_each(Zt,St),St&&detach(ht),St&&detach(ut),Yt&&Yt.d(),destroy_each(Ft,St),destroy_each(Jt,St),destroy_each(Qt,St),zt=!1,run_all(wt)}}}const gridSize=15,dotSize=10;function instance$5(Z,U,W){let X,tt,Y,nt,it,rt,st,at,ct,ht,ut,dt,_t,kt,gt,Tt,Ot,Lt,{canvasId:vt}=U,{width:bt}=U,{height:Pt}=U,{initialZoom:zt=3}=U,{initialLocation:wt}=U,{boundary:Ct=!1}=U,{minimap:Vt=!1}=U;const Ut=findStore(vt),{edgesStore:oe,nodesStore:mt,anchorsStore:Bt,potentialAnchorsStore:It,temporaryEdgeStore:At,resizeNodesStore:Et,nodeSelected:jt,backgroundStore:Mt,movementStore:Zt,widthStore:Xt,heightStore:Yt,d3Scale:qt,edgeEditModal:Ft,collapsibleStore:te}=Ut;component_subscribe(Z,oe,Gt=>W(45,_t=Gt)),component_subscribe(Z,mt,Gt=>W(46,kt=Gt)),component_subscribe(Z,Bt,Gt=>W(44,dt=Gt)),component_subscribe(Z,It,Gt=>W(42,ht=Gt)),component_subscribe(Z,At,Gt=>W(41,ct=Gt)),component_subscribe(Z,Et,Gt=>W(43,ut=Gt)),component_subscribe(Z,Mt,Gt=>W(13,Lt=Gt)),component_subscribe(Z,Zt,Gt=>W(49,st=Gt)),component_subscribe(Z,Xt,Gt=>W(11,Tt=Gt)),component_subscribe(Z,Yt,Gt=>W(12,Ot=Gt)),component_subscribe(Z,Ft,Gt=>W(10,gt=Gt)),component_subscribe(Z,te,Gt=>W(40,at=Gt));let se,Jt,be,me,Qt={zoom,zoomTransform:transform,zoomIdentity:identity,select,selectAll,pointer},_e=determineD3Instance(Ct,Qt,jt,bt,Pt,Zt,Mt,gridSize,dotSize,vt,qt,En),St={x:0,y:0,k:1};onMount(()=>{Qt.select(`.Edges-${vt}`).call(_e),Qt.select(`.Nodes-${vt}`).call(_e),Qt.select(`#background-${vt}`).call(_e),Qt.selectAll("#dot").call(_e),W(3,St=zoomInit(Qt,vt,_e,St,wt,zt,qt))});let Dt=zt,ee=wt.x,Rt=wt.y;function ue(Gt){Ct?(Qt.select(`.Edges-${Le}`).transition().duration(500).call(_e.translateTo,Gt.detail.x,Gt.detail.y),Qt.select(`.Nodes-${Le}`).transition().duration(500).call(_e.translateTo,Gt.detail.x,Gt.detail.y)):(Qt.select(`.Edges-${Le}`).transition().duration(500).call(_e.translateTo,Gt.detail.x,Gt.detail.y),Qt.select(`.Nodes-${Le}`).transition().duration(500).call(_e.translateTo,Gt.detail.x,Gt.detail.y))}const Le=vt;function En(Gt){if(!st)return;qt.set(Gt.transform.k),Mt&&Qt.select(`#background-${vt}`).attr("x",Gt.transform.x).attr("y",Gt.transform.y).attr("width",gridSize*Gt.transform.k).attr("height",gridSize*Gt.transform.k).selectAll("#dot").attr("x",gridSize*Gt.transform.k/2-dotSize/2).attr("y",gridSize*Gt.transform.k/2-dotSize/2).attr("opacity",Math.min(Gt.transform.k,1)),Qt.select(`.Edges-${vt} g`).attr("transform",Gt.transform);let Ae=Qt.zoomTransform(this);W(3,St=Ae),Ut.d3ZoomParameters.set({...Ae}),Qt.select(`.Node-${vt}`).style("transform","translate("+Ae.x+"px,"+Ae.y+"px) scale("+Ae.k+")").style("transform-origin","0 0")}function hn(Gt){bubble.call(this,Z,Gt)}function Ke(Gt){bubble.call(this,Z,Gt)}return Z.$$set=Gt=>{"canvasId"in Gt&&W(0,vt=Gt.canvasId),"width"in Gt&&W(29,bt=Gt.width),"height"in Gt&&W(30,Pt=Gt.height),"initialZoom"in Gt&&W(31,zt=Gt.initialZoom),"initialLocation"in Gt&&W(32,wt=Gt.initialLocation),"boundary"in Gt&&W(1,Ct=Gt.boundary),"minimap"in Gt&&W(2,Vt=Gt.minimap)},Z.$$.update=()=>{if(Z.$$.dirty[1]&32768&&W(39,X=Object.values(kt)),Z.$$.dirty[1]&16384&&W(36,tt=Object.values(_t)),Z.$$.dirty[1]&8192&&W(37,Y=Object.values(dt)),Z.$$.dirty[1]&4096&&W(38,nt=Object.values(ut)),Z.$$.dirty[1]&2048&&W(9,it=Object.values(ht)),Z.$$.dirty[1]&1024&&W(8,rt=ct),Z.$$.dirty[1]&992){const Gt=filterByCollapsible(Ut,X,nt,Y,tt);W(4,se=Gt.filteredNodes),W(5,Jt=Gt.filteredEdges),W(6,be=Gt.filteredResizeNodes),W(7,me=Gt.filteredAnchors)}Z.$$.dirty[0]&9|Z.$$.dirty[1]&31&&(zt!==Dt||ee!==wt.x||Rt!==wt.y)&&(W(33,Dt=zt),W(34,ee=wt.x),W(35,Rt=wt.y),W(3,St=zoomInit(Qt,vt,_e,St,wt,zt,qt)))},[vt,Ct,Vt,St,se,Jt,be,me,rt,it,gt,Tt,Ot,Lt,Ut,oe,mt,Bt,It,At,Et,Mt,Zt,Xt,Yt,Ft,te,ue,Le,bt,Pt,zt,wt,Dt,ee,Rt,tt,Y,nt,X,at,ct,ht,ut,dt,_t,kt,hn,Ke]}class GraphView extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$5,create_fragment$5,safe_not_equal,{canvasId:0,width:29,height:30,initialZoom:31,initialLocation:32,boundary:1,minimap:2},null,[-1,-1,-1])}}function sanitizeCanvasOptions(Z){enforceCollapsibleCompatibility(Z)}function enforceCollapsibleCompatibility(Z){get_store_value(Z.collapsibleOption)&&Z.nodeCreate.set(!1)}function sanitizeUserNodesAndEdges(Z,U){return convertIdToString(Z),convertEdgeIdsToString(U),convertAnchorPositionsToCallbacks(Z,U),setDefaultEdgeType(U),{userNodes:Z,userEdges:U}}function setDefaultEdgeType(Z){for(let U of Z)["smoothstep","step","bezier","straight"].includes(U.type)||(U.type="bezier")}function convertAnchorPositionsToCallbacks(Z,U){const W={};for(let X of Z)W[X.id]=X;for(let X of U){const tt=W[X.source],Y=W[X.target],nt=tt.sourcePosition,it=Y.targetPosition,rt={left:leftCb,right:rightCb,top:topCb,bottom:bottomCb};nt&&(X.sourceAnchorCb=rt[nt]),it&&(X.targetAnchorCb=rt[it])}}function convertIdToString(Z){Z=Z.map(U=>(U.id=U.id.toString(),U.childNodes=U.childNodes===void 0?[]:U.childNodes.map(W=>W.toString()),U))}function convertEdgeIdsToString(Z){Z=Z.map(U=>(U.source=U.source.toString(),U.target=U.target.toString(),U))}const ImportExport_svelte_svelte_type_style_lang="";function create_fragment$4(Z){let U,W,X,tt,Y,nt,it,rt,st,at,ct,ht,ut,dt,_t,kt,gt;return{c(){U=element("div"),W=element("a"),X=svg_element("svg"),tt=svg_element("g"),Y=svg_element("g"),nt=svg_element("path"),it=svg_element("g"),rt=svg_element("polygon"),st=svg_element("path"),ct=space(),ht=element("input"),dt=space(),_t=element("button"),_t.textContent="Upload",attr(tt,"id","SVGRepo_bgCarrier"),attr(tt,"stroke-width","0"),attr(nt,"d","M0 0h48v48H0z"),attr(nt,"fill","none"),attr(rt,"points","22,4 22,20 14,20 24,30 34,20 26,20 26,4 "),attr(st,"d","M8,44h32c2.206,0,4-1.794,4-4V30h-4v10H8V30H4v10C4,42.206,5.794,44,8,44z"),attr(it,"id","Shopicon"),attr(Y,"id","SVGRepo_iconCarrier"),attr(X,"id","dwnldimg"),attr(X,"viewBox","0 0 48 48"),attr(X,"xmlns","http://www.w3.org/2000/svg"),attr(X,"fill","#000000"),attr(X,"class","svelte-eba1ux"),attr(W,"href",Z[1]),attr(W,"id",at="downloadState-"+Z[0]),attr(W,"download","svelvet-state.json"),attr(W,"class","svelte-eba1ux"),attr(ht,"type","text"),attr(ht,"id",ut=`store-input-${Z[0]}`),attr(ht,"placeholder","Paste JSON here"),attr(ht,"class","svelte-eba1ux"),attr(_t,"id","store-input-btn"),attr(_t,"class","svelte-eba1ux"),attr(U,"id","export-import"),attr(U,"class","svelte-eba1ux")},m(Tt,Ot){insert(Tt,U,Ot),append(U,W),append(W,X),append(X,tt),append(X,Y),append(Y,nt),append(Y,it),append(it,rt),append(it,st),append(U,ct),append(U,ht),append(U,dt),append(U,_t),kt||(gt=[listen(W,"click",Z[7]),listen(_t,"click",Z[6])],kt=!0)},p(Tt,[Ot]){Ot&2&&attr(W,"href",Tt[1]),Ot&1&&at!==(at="downloadState-"+Tt[0])&&attr(W,"id",at),Ot&1&&ut!==(ut=`store-input-${Tt[0]}`)&&attr(ht,"id",ut)},i:noop$1,o:noop$1,d(Tt){Tt&&detach(U),kt=!1,run_all(gt)}}}function instance$4($$self,$$props,$$invalidate){let $edgesStore,$nodesStore,{canvasId}=$$props;const store=findStore(canvasId),{nodesStore,edgesStore}=store;component_subscribe($$self,nodesStore,Z=>$$invalidate(9,$nodesStore=Z)),component_subscribe($$self,edgesStore,Z=>$$invalidate(8,$edgesStore=Z));const rawNodeData=[],rawEdgeData=[];let fileHref="";const getData=()=>{for(const Z in $nodesStore)rawNodeData.push($nodesStore[Z].setExportableData());for(const Z in $edgesStore)rawEdgeData.push($edgesStore[Z].setExportableData())},exportNodesAndEdges=()=>{$$invalidate(1,fileHref=(W=>{const X=new Blob([JSON.stringify(W)],{type:"application/json"});return window.URL.createObjectURL(X)})({nodes:rawNodeData,edges:rawEdgeData}))},uploadStore=()=>{const storeInput=document.getElementById(`store-input-${canvasId}`),reviver=(key,value)=>key==="custom"?eval(value):value,text=storeInput.value;if(text==="")return;const newStore=JSON.parse(text,reviver);populateSvelvetStoreFromUserInput(canvasId,newStore.nodes,newStore.edges),storeInput.value=""},click_handler=()=>{getData(),exportNodesAndEdges()};return $$self.$$set=Z=>{"canvasId"in Z&&$$invalidate(0,canvasId=Z.canvasId)},[canvasId,fileHref,nodesStore,edgesStore,getData,exportNodesAndEdges,uploadStore,click_handler]}class ImportExport extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$4,create_fragment$4,safe_not_equal,{canvasId:0})}}const Svelvet_svelte_svelte_type_style_lang="";function create_if_block$1(Z){let U,W;return U=new ImportExport({props:{canvasId:Z[4]}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt&16&&(Y.canvasId=X[4]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_fragment$3(Z){let U,W,X,tt,Y;W=new GraphView({props:{canvasId:Z[4],width:Z[2],height:Z[3],initialLocation:Z[6],initialZoom:Z[5],boundary:Z[7],minimap:Z[1]}});let nt=Z[8]&&create_if_block$1(Z);return{c(){U=element("div"),create_component(W.$$.fragment),X=space(),nt&&nt.c(),attr(U,"class","Svelvet svelte-tw9ly1"),attr(U,"style",tt=`width: ${Z[2]}px; height: ${Z[3]}px; background-color: ${Z[0]};`)},m(it,rt){insert(it,U,rt),mount_component(W,U,null),append(U,X),nt&&nt.m(U,null),Y=!0},p(it,[rt]){const st={};rt&16&&(st.canvasId=it[4]),rt&4&&(st.width=it[2]),rt&8&&(st.height=it[3]),rt&64&&(st.initialLocation=it[6]),rt&32&&(st.initialZoom=it[5]),rt&128&&(st.boundary=it[7]),rt&2&&(st.minimap=it[1]),W.$set(st),it[8]?nt?(nt.p(it,rt),rt&256&&transition_in(nt,1)):(nt=create_if_block$1(it),nt.c(),transition_in(nt,1),nt.m(U,null)):nt&&(group_outros(),transition_out(nt,1,1,()=>{nt=null}),check_outros()),(!Y||rt&13&&tt!==(tt=`width: ${it[2]}px; height: ${it[3]}px; background-color: ${it[0]};`))&&attr(U,"style",tt)},i(it){Y||(transition_in(W.$$.fragment,it),transition_in(nt),Y=!0)},o(it){transition_out(W.$$.fragment,it),transition_out(nt),Y=!1},d(it){it&&detach(U),destroy_component(W),nt&&nt.d()}}}function instance$3(Z,U,W){const X=()=>(Math.random()+1).toString(36).substring(7);let{nodes:tt}=U,{edges:Y}=U,{bgColor:nt="#ffffff"}=U,{minimap:it=!1}=U,{width:rt=600}=U,{height:st=600}=U,{background:at=!0}=U,{movement:ct=!0}=U,{canvasId:ht=X()}=U,{snap:ut=!1}=U,{snapTo:dt=30}=U,{nodeCreate:_t=!1}=U,{initialZoom:kt=3}=U,{initialLocation:gt={x:0,y:0}}=U,{boundary:Tt=!1}=U,{collapsible:Ot=!1}=U,{shareable:Lt=!1}=U,{locked:vt=!1}=U,{editable:bt=!1}=U,{resizable:Pt=!0}=U,{highlightEdges:zt=!0}=U;const wt=createStoreEmpty(ht);return onMount(()=>{let Ct=sanitizeUserNodesAndEdges(tt,Y);const Vt=Ct.userNodes,Ut=Ct.userEdges;wt.widthStore.set(rt),wt.heightStore.set(st),wt.backgroundStore.set(at),wt.movementStore.set(ct);const oe={snap:ut,snapTo:dt};wt.options.set(oe),wt.nodeCreate.set(_t),wt.boundary.set(Tt),wt.collapsibleOption.set(Ot),wt.lockedOption.set(vt),wt.editableOption.set(bt),wt.resizableOption.set(Pt),wt.highlightEdgesOption.set(zt),sanitizeCanvasOptions(wt),populateSvelvetStoreFromUserInput(ht,Vt,Ut)}),afterUpdate(()=>{let Ct=sanitizeUserNodesAndEdges(tt,Y);const Vt=Ct.userNodes,Ut=Ct.userEdges;wt.widthStore.set(rt),wt.heightStore.set(st),wt.backgroundStore.set(at),wt.movementStore.set(ct);const oe={snap:ut,snapTo:dt};wt.options.set(oe),wt.nodeCreate.set(_t),wt.boundary.set(Tt),wt.collapsibleOption.set(Ot),wt.lockedOption.set(vt),wt.editableOption.set(bt),wt.resizableOption.set(Pt),wt.highlightEdgesOption.set(zt),sanitizeCanvasOptions(wt),populateSvelvetStoreFromUserInput(ht,Vt,Ut)}),Z.$$set=Ct=>{"nodes"in Ct&&W(9,tt=Ct.nodes),"edges"in Ct&&W(10,Y=Ct.edges),"bgColor"in Ct&&W(0,nt=Ct.bgColor),"minimap"in Ct&&W(1,it=Ct.minimap),"width"in Ct&&W(2,rt=Ct.width),"height"in Ct&&W(3,st=Ct.height),"background"in Ct&&W(11,at=Ct.background),"movement"in Ct&&W(12,ct=Ct.movement),"canvasId"in Ct&&W(4,ht=Ct.canvasId),"snap"in Ct&&W(13,ut=Ct.snap),"snapTo"in Ct&&W(14,dt=Ct.snapTo),"nodeCreate"in Ct&&W(15,_t=Ct.nodeCreate),"initialZoom"in Ct&&W(5,kt=Ct.initialZoom),"initialLocation"in Ct&&W(6,gt=Ct.initialLocation),"boundary"in Ct&&W(7,Tt=Ct.boundary),"collapsible"in Ct&&W(16,Ot=Ct.collapsible),"shareable"in Ct&&W(8,Lt=Ct.shareable),"locked"in Ct&&W(17,vt=Ct.locked),"editable"in Ct&&W(18,bt=Ct.editable),"resizable"in Ct&&W(19,Pt=Ct.resizable),"highlightEdges"in Ct&&W(20,zt=Ct.highlightEdges)},[nt,it,rt,st,ht,kt,gt,Tt,Lt,tt,Y,at,ct,ut,dt,_t,Ot,vt,bt,Pt,zt]}class Svelvet extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$3,create_fragment$3,safe_not_equal,{nodes:9,edges:10,bgColor:0,minimap:1,width:2,height:3,background:11,movement:12,canvasId:4,snap:13,snapTo:14,nodeCreate:15,initialZoom:5,initialLocation:6,boundary:7,collapsible:16,shareable:8,locked:17,editable:18,resizable:19,highlightEdges:20})}}const SelectedFeatures_svelte_svelte_type_style_lang="";function create_key_block(Z){let U,W;return U=new Svelvet({props:{nodes,edges:Z[4],width:Z[0],height:Z[1],background:!0,bgColor:"antiquewhite",nodeCreate:!0,snap:!0,editable:!0,initialZoom:1,shareable:!1}}),{c(){create_component(U.$$.fragment)},m(X,tt){mount_component(U,X,tt),W=!0},p(X,tt){const Y={};tt&0&&(Y.nodes=nodes),tt&1&&(Y.width=X[0]),tt&2&&(Y.height=X[1]),U.$set(Y)},i(X){W||(transition_in(U.$$.fragment,X),W=!0)},o(X){transition_out(U.$$.fragment,X),W=!1},d(X){destroy_component(U,X)}}}function create_else_block(Z){let U,W,X,tt,Y;return{c(){U=element("button"),U.textContent="Highlight all events",W=space(),X=element("button"),X.textContent="Clear all events",attr(U,"class","bg-slate-700 svelte-uny8tg"),attr(X,"class","bg-slate-700 svelte-uny8tg")},m(nt,it){insert(nt,U,it),insert(nt,W,it),insert(nt,X,it),tt||(Y=[listen(U,"click",Z[7]),listen(X,"click",Z[8])],tt=!0)},p:noop$1,d(nt){nt&&detach(U),nt&&detach(W),nt&&detach(X),tt=!1,run_all(Y)}}}function create_if_block(Z){let U;return{c(){U=element("p"),U.textContent='No events selected. Please open an event and click, "Add to list"'},m(W,X){insert(W,U,X)},p:noop$1,d(W){W&&detach(U)}}}function create_fragment$2(Z){let U,W=Z[2],X,tt,Y=create_key_block(Z);function nt(st,at){return nodes.length<1?create_if_block:create_else_block}let it=nt(),rt=it(Z);return{c(){U=element("div"),Y.c(),X=space(),rt.c(),attr(U,"id","events-in-focus")},m(st,at){insert(st,U,at),Y.m(U,null),append(U,X),rt.m(U,null),tt=!0},p(st,[at]){at&4&&safe_not_equal(W,W=st[2])?(group_outros(),transition_out(Y,1,1,noop$1),check_outros(),Y=create_key_block(st),Y.c(),transition_in(Y,1),Y.m(U,X)):Y.p(st,at),it===(it=nt())&&rt?rt.p(st,at):(rt.d(1),rt=it(st),rt&&(rt.c(),rt.m(U,null)))},i(st){tt||(transition_in(Y),tt=!0)},o(st){transition_out(Y),tt=!1},d(st){st&&detach(U),Y.d(st),rt.d()}}}let nodes=[];function instance$2(Z,U,W){let X;component_subscribe(Z,selectedFeatures,dt=>W(2,X=dt));let tt=new L.FeatureGroup,Y=[],nt=1,{width:it}=U,{height:rt}=U;function st(dt){tt.clearLayers(),console.log("Zooming to feature"),tt.addLayer(new L.CircleMarker(dt.geometry.coordinates.reverse(),{radius:30,color:"#ff7800",weight:5,opacity:.65})),map.flyTo(dt.geometry.coordinates,4),tt.addTo(map)}function at(dt){tt.clearLayers(),console.log("Zooming to feature"),X.forEach(_t=>{tt.addLayer(new L.CircleMarker(_t.feature.geometry.coordinates.reverse(),{radius:30,color:"#ff7800",weight:5,opacity:.9}))}),tt.addTo(map)}X.forEach(dt=>{nodes.push({id:`${W(6,nt++,nt)}`,position:{x:0,y:0},data:{html:String(dt.title)},width:100,height:50,clickCallback:()=>st(dt.feature)})});const ht=()=>at(),ut=()=>{selectedFeatures.set([]),tt.clearLayers(),nodes=[]};return Z.$$set=dt=>{"width"in dt&&W(0,it=dt.width),"height"in dt&&W(1,rt=dt.height)},Z.$$.update=()=>{if(Z.$$.dirty&68){const dt=X,_t=dt[dt.length-1];_t&&nodes.push({id:`${W(6,nt++,nt)}`,position:{x:0,y:0},data:{html:String(_t.title)},width:100,height:50,clickCallback:()=>st(_t.feature)})}},[it,rt,X,tt,Y,at,nt,ht,ut]}class SelectedFeatures extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$2,create_fragment$2,safe_not_equal,{width:0,height:1})}}const leafletSearch_min="";var leafletSearch_srcExports={},leafletSearch_src={get exports(){return leafletSearch_srcExports},set exports(Z){leafletSearch_srcExports=Z}};(function(Z){(function(U){Z.exports=U(leafletSrcExports)})(function(U){return U.Control.Search=U.Control.extend({includes:U.version[0]==="1"?U.Evented.prototype:U.Mixin.Events,options:{url:"",layer:null,sourceData:null,jsonpParam:null,propertyLoc:"loc",propertyName:"title",formatData:null,filterData:null,moveToLocation:null,buildTip:null,container:"",zoom:null,minLength:1,initial:!0,casesensitive:!1,autoType:!0,delayType:400,tooltipLimit:-1,tipAutoSubmit:!0,firstTipSubmit:!1,autoResize:!0,collapsed:!0,autoCollapse:!1,autoCollapseTime:1200,textErr:"Location not found",textCancel:"Cancel",textPlaceholder:"Search...",hideMarkerOnCollapse:!1,position:"topleft",marker:{icon:!1,animate:!0,circle:{radius:10,weight:3,color:"#e03",stroke:!0,fill:!1}}},_getPath:function(W,X){const tt=X.split("."),Y=tt.pop(),nt=tt.length;let it=tt[0],rt=1;if(nt>0)for(;(W=W[it])&&rt<nt;)it=tt[rt++];if(W)return W[Y]},_isObject:function(W){return Object.prototype.toString.call(W)==="[object Object]"},initialize:function(W){U.Util.setOptions(this,W||{}),this._inputMinSize=this.options.textPlaceholder?this.options.textPlaceholder.length:10,this._layer=this.options.layer||new U.LayerGroup,this._filterData=this.options.filterData||this._defaultFilterData,this._formatData=this.options.formatData||this._defaultFormatData,this._moveToLocation=this.options.moveToLocation||this._defaultMoveToLocation,this._autoTypeTmp=this.options.autoType,this._countertips=0,this._recordsCache={},this._curReq=null},onAdd:function(W){return this._map=W,this._container=U.DomUtil.create("div","leaflet-control-search"),this._input=this._createInput(this.options.textPlaceholder,"search-input"),this._tooltip=this._createTooltip("search-tooltip"),this._cancel=this._createCancel(this.options.textCancel,"search-cancel"),this._button=this._createButton(this.options.textPlaceholder,"search-button"),this._alert=this._createAlert("search-alert"),this.options.collapsed===!1&&this.expand(this.options.collapsed),this.options.marker&&(this.options.marker instanceof U.Marker||this.options.marker instanceof U.CircleMarker?this._markerSearch=this.options.marker:this._isObject(this.options.marker)&&(this._markerSearch=new U.Control.Search.Marker([0,0],this.options.marker)),this._markerSearch._isMarkerSearch=!0),this.setLayer(this._layer),W.on({resize:this._handleAutoresize},this),this._container},addTo:function(W){return this.options.container?(this._container=this.onAdd(W),this._wrapper=U.DomUtil.get(this.options.container),this._wrapper.style.position="relative",this._wrapper.appendChild(this._container)):U.Control.prototype.addTo.call(this,W),this},onRemove:function(W){this._recordsCache={},W.off({resize:this._handleAutoresize},this)},setLayer:function(W){return this._layer=W,this._layer.addTo(this._map),this},showAlert:function(W){const X=this;return W=W||this.options.textErr,this._alert.style.display="block",this._alert.innerHTML=W,clearTimeout(this.timerAlert),this.timerAlert=setTimeout(function(){X.hideAlert()},this.options.autoCollapseTime),this},hideAlert:function(){return this._alert.style.display="none",this},cancel:function(){return this._input.value="",this._handleKeypress({keyCode:8}),this._input.size=this._inputMinSize,this._input.focus(),this._cancel.style.display="none",this._hideTooltip(),this.fire("search:cancel"),this},expand:function(W){return W=typeof W=="boolean"?W:!0,this._input.style.display="block",U.DomUtil.addClass(this._container,"search-exp"),W!==!1&&(this._input.focus(),this._map.on("dragstart click",this.collapse,this)),this.fire("search:expanded"),this},collapse:function(){return this._hideTooltip(),this.cancel(),this._alert.style.display="none",this._input.blur(),this.options.collapsed&&(this._input.style.display="none",this._cancel.style.display="none",U.DomUtil.removeClass(this._container,"search-exp"),this.options.hideMarkerOnCollapse&&this._map.removeLayer(this._markerSearch),this._map.off("dragstart click",this.collapse,this)),this.fire("search:collapsed"),this},collapseDelayed:function(){const W=this;return this.options.autoCollapse?(clearTimeout(this.timerCollapse),this.timerCollapse=setTimeout(function(){W.collapse()},this.options.autoCollapseTime),this):this},collapseDelayedStop:function(){return clearTimeout(this.timerCollapse),this},_createAlert:function(W){const X=U.DomUtil.create("div",W,this._container);return X.style.display="none",U.DomEvent.on(X,"click",U.DomEvent.stop,this).on(X,"click",this.hideAlert,this),X},_createInput:function(W,X){const tt=this,Y=U.DomUtil.create("label",X,this._container),nt=U.DomUtil.create("input",X,this._container);return nt.type="text",nt.size=this._inputMinSize,nt.value="",nt.autocomplete="off",nt.autocorrect="off",nt.autocapitalize="off",nt.placeholder=W,nt.style.display="none",nt.role="search",nt.id=nt.role+nt.type+nt.size,Y.htmlFor=nt.id,Y.style.display="none",Y.value=W,U.DomEvent.disableClickPropagation(nt).on(nt,"keyup",this._handleKeypress,this).on(nt,"paste",function(it){setTimeout(function(rt){tt._handleKeypress(rt)},10,it)},this).on(nt,"blur",this.collapseDelayed,this).on(nt,"focus",this.collapseDelayedStop,this),nt},_createCancel:function(W,X){const tt=U.DomUtil.create("a",X,this._container);return tt.href="#",tt.title=W,tt.style.display="none",tt.innerHTML="<span>&otimes;</span>",U.DomEvent.on(tt,"click",U.DomEvent.stop,this).on(tt,"click",this.cancel,this),tt},_createButton:function(W,X){const tt=U.DomUtil.create("a",X,this._container);return tt.href="#",tt.title=W,U.DomEvent.on(tt,"click",U.DomEvent.stop,this).on(tt,"click",this._handleSubmit,this).on(tt,"focus",this.collapseDelayedStop,this).on(tt,"blur",this.collapseDelayed,this),tt},_createTooltip:function(W){const X=this,tt=U.DomUtil.create("ul",W,this._container);return tt.style.display="none",U.DomEvent.disableClickPropagation(tt).on(tt,"blur",this.collapseDelayed,this).on(tt,"wheel",function(Y){X.collapseDelayedStop(),U.DomEvent.stopPropagation(Y)},this).on(tt,"mouseover",function(Y){X.collapseDelayedStop()},this),tt},_createTip:function(W,X){let tt;if(this.options.buildTip){if(tt=this.options.buildTip.call(this,W,X),typeof tt=="string"){const Y=U.DomUtil.create("div");Y.innerHTML=tt,tt=Y.firstChild}}else tt=U.DomUtil.create("li",""),tt.innerHTML=W;return U.DomUtil.addClass(tt,"search-tip"),tt._text=W,this.options.tipAutoSubmit&&U.DomEvent.disableClickPropagation(tt).on(tt,"click",U.DomEvent.stop,this).on(tt,"click",function(Y){this._input.value=W,this._handleAutoresize(),this._input.focus(),this._hideTooltip(),this._handleSubmit()},this),tt},_getUrl:function(W){return typeof this.options.url=="function"?this.options.url(W):this.options.url},_defaultFilterData:function(W,X){const tt={};if(W=W.replace(new RegExp("[.*+?^${}()|[]\\]","g"),""),W==="")return[];const Y=this.options.initial?"^":"",nt=this.options.casesensitive?void 0:"i",it=new RegExp(Y+W,nt);for(const rt in X)it.test(rt)&&(tt[rt]=X[rt]);return tt},showTooltip:function(W){if(this._countertips=0,this._tooltip.innerHTML="",this._tooltip.currentSelection=-1,this.options.tooltipLimit)for(const X in W){if(this._countertips===this.options.tooltipLimit)break;this._countertips++,this._tooltip.appendChild(this._createTip(X,W[X]))}return this._countertips>0?(this._tooltip.style.display="block",this._autoTypeTmp&&this._autoType(),this._autoTypeTmp=this.options.autoType):this._hideTooltip(),this._tooltip.scrollTop=0,this._countertips},_hideTooltip:function(){return this._tooltip.style.display="none",this._tooltip.innerHTML="",0},_defaultFormatData:function(W){const X=this,tt=this.options.propertyName,Y=this.options.propertyLoc,nt={};if(U.Util.isArray(Y))for(const it in W)nt[X._getPath(W[it],tt)]=U.latLng(X._getPath(W[it],Y[0]),X._getPath(W[it],Y[1]));else for(const it in W)nt[X._getPath(W[it],tt)]=U.latLng(X._getPath(W[it],Y));return nt},_recordsFromJsonp:function(W,X){U.Control.Search.callJsonp=X;const tt=U.DomUtil.create("script","leaflet-search-jsonp",document.getElementsByTagName("body")[0]),Y=U.Util.template(this._getUrl(W)+"&"+this.options.jsonpParam+"=L.Control.Search.callJsonp",{s:W});return tt.type="text/javascript",tt.src=Y,{abort:function(){tt.parentNode.removeChild(tt)}}},_recordsFromAjax:function(W,X){let tt;try{tt=new window.XMLHttpRequest}catch{throw new Error("XMLHttpRequest is not supported")}const Y=U.Util.template(this._getUrl(W),{s:W});return tt.open("GET",Y),tt.onload=function(){X(JSON.parse(tt.responseText))},tt.onreadystatechange=function(){tt.readyState===4&&tt.status===200&&this.onload()},tt.send(),tt},_searchInLayer:function(W,X,tt){const Y=this;let nt;W instanceof U.Control.Search.Marker||(W instanceof U.Marker||W instanceof U.CircleMarker?Y._getPath(W.options,tt)?(nt=W.getLatLng(),nt.layer=W,X[Y._getPath(W.options,tt)]=nt):Y._getPath(W.feature.properties,tt)&&(nt=W.getLatLng(),nt.layer=W,X[Y._getPath(W.feature.properties,tt)]=nt):W instanceof U.Path||W instanceof U.Polyline||W instanceof U.Polygon?Y._getPath(W.options,tt)?(nt=W.getBounds().getCenter(),nt.layer=W,X[Y._getPath(W.options,tt)]=nt):Y._getPath(W.feature.properties,tt)&&(nt=W.getBounds().getCenter(),nt.layer=W,X[Y._getPath(W.feature.properties,tt)]=nt):Object.prototype.hasOwnProperty.call(W,"feature")?Object.prototype.hasOwnProperty.call(W.feature.properties,tt)&&(W.getLatLng&&typeof W.getLatLng=="function"?(nt=W.getLatLng(),nt.layer=W,X[W.feature.properties[tt]]=nt):W.getBounds&&typeof W.getBounds=="function"&&(nt=W.getBounds().getCenter(),nt.layer=W,X[W.feature.properties[tt]]=nt)):W instanceof U.LayerGroup&&W.eachLayer(function(it){Y._searchInLayer(it,X,tt)}))},_recordsFromLayer:function(){const W=this,X={},tt=this.options.propertyName;return this._layer.eachLayer(function(Y){W._searchInLayer(Y,X,tt)}),X},_autoType:function(){const W=this._input.value.length,X=this._tooltip.firstChild?this._tooltip.firstChild._text:"",tt=X.length;if(X.indexOf(this._input.value)===0)if(this._input.value=X,this._handleAutoresize(),this._input.createTextRange){const Y=this._input.createTextRange();Y.collapse(!0),Y.moveStart("character",W),Y.moveEnd("character",tt),Y.select()}else this._input.setSelectionRange?this._input.setSelectionRange(W,tt):this._input.selectionStart&&(this._input.selectionStart=W,this._input.selectionEnd=tt)},_hideAutoType:function(){let W;if((W=this._input.selection)&&W.empty)W.empty();else if(this._input.createTextRange){W=this._input.createTextRange(),W.collapse(!0);const X=this._input.value.length;W.moveStart("character",X),W.moveEnd("character",X),W.select()}else this._input.getSelection&&this._input.getSelection().removeAllRanges(),this._input.selectionStart=this._input.selectionEnd},_handleKeypress:function(W){const X=this;switch(W.keyCode){case 27:this.collapse();break;case 13:(this._countertips===1||this.options.firstTipSubmit&&this._countertips>0)&&this._tooltip.currentSelection===-1&&this._handleArrowSelect(1),this._handleSubmit();break;case 38:this._handleArrowSelect(-1);break;case 40:this._handleArrowSelect(1);break;case 45:case 46:this._autoTypeTmp=!1;break;case 37:case 39:case 16:case 17:case 35:case 36:break;default:this._input.value.length?this._cancel.style.display="block":this._cancel.style.display="none",this._input.value.length>=this.options.minLength?(clearTimeout(this.timerKeypress),this.timerKeypress=setTimeout(function(){X._fillRecordsCache()},this.options.delayType)):this._hideTooltip()}this._handleAutoresize()},searchText:function(W){const X=W.charCodeAt(W.length);this._input.value=W,this._input.style.display="block",U.DomUtil.addClass(this._container,"search-exp"),this._autoTypeTmp=!1,this._handleKeypress({keyCode:X})},_fillRecordsCache:function(){const W=this,X=this._input.value;let tt;this._curReq&&this._curReq.abort&&this._curReq.abort(),U.DomUtil.addClass(this._container,"search-load"),this.options.layer?(this._recordsCache=this._recordsFromLayer(),tt=this._filterData(this._input.value,this._recordsCache),this.showTooltip(tt),U.DomUtil.removeClass(this._container,"search-load")):(this.options.sourceData?this._retrieveData=this.options.sourceData:this.options.url&&(this._retrieveData=this.options.jsonpParam?this._recordsFromJsonp:this._recordsFromAjax),this._curReq=this._retrieveData(this,X,function(Y){W._recordsCache=W._formatData(W,Y),W.options.sourceData?tt=W._filterData(W._input.value,W._recordsCache):tt=W._recordsCache,W.showTooltip(tt),U.DomUtil.removeClass(W._container,"search-load")}))},_handleAutoresize:function(){let W;this._input.style.maxWidth!==this._map._container.offsetWidth&&(W=this._map._container.clientWidth,W-=10+20+1+30+22,this._input.style.maxWidth=W.toString()+"px"),this.options.autoResize&&this._container.offsetWidth+20<this._map._container.offsetWidth&&(this._input.size=this._input.value.length<this._inputMinSize?this._inputMinSize:this._input.value.length)},_handleArrowSelect:function(W){const X=this._tooltip.hasChildNodes()?this._tooltip.childNodes:[];for(let tt=0;tt<X.length;tt++)U.DomUtil.removeClass(X[tt],"search-tip-select");if(W===1&&this._tooltip.currentSelection>=X.length-1)U.DomUtil.addClass(X[this._tooltip.currentSelection],"search-tip-select");else if(W===-1&&this._tooltip.currentSelection<=0)this._tooltip.currentSelection=-1;else if(this._tooltip.style.display!=="none"){this._tooltip.currentSelection+=W,U.DomUtil.addClass(X[this._tooltip.currentSelection],"search-tip-select"),this._input.value=X[this._tooltip.currentSelection]._text;const tt=X[this._tooltip.currentSelection].offsetTop;tt+X[this._tooltip.currentSelection].clientHeight>=this._tooltip.scrollTop+this._tooltip.clientHeight?this._tooltip.scrollTop=tt-this._tooltip.clientHeight+X[this._tooltip.currentSelection].clientHeight:tt<=this._tooltip.scrollTop&&(this._tooltip.scrollTop=tt)}},_handleSubmit:function(){if(this._hideAutoType(),this.hideAlert(),this._hideTooltip(),this._input.style.display==="none")this.expand();else if(this._input.value==="")this.collapse();else{const W=this._getLocation(this._input.value);W?(this.showLocation(W,this._input.value),this.fire("search:locationfound",{latlng:W,text:this._input.value,layer:W.layer?W.layer:null})):this.showAlert()}},_getLocation:function(W){return Object.prototype.hasOwnProperty.call(this._recordsCache,W)?this._recordsCache[W]:!1},_defaultMoveToLocation:function(W,X,tt){this.options.zoom?this._map.setView(W,this.options.zoom):this._map.panTo(W)},showLocation:function(W,X){const tt=this;return tt._map.once("moveend zoomend",function(Y){tt._markerSearch&&tt._markerSearch.addTo(tt._map).setLatLng(W)}),tt._moveToLocation(W,X,tt._map),tt.options.autoCollapse&&tt.collapse(),tt}}),U.Control.Search.Marker=U.Marker.extend({includes:U.version[0]==="1"?U.Evented.prototype:U.Mixin.Events,options:{icon:new U.Icon.Default,animate:!0,circle:{radius:10,weight:3,color:"#e03",stroke:!0,fill:!1}},initialize:function(W,X){U.setOptions(this,X),X.icon===!0&&(X.icon=new U.Icon.Default),U.Marker.prototype.initialize.call(this,W,X),U.Control.Search.prototype._isObject(this.options.circle)&&(this._circleLoc=new U.CircleMarker(W,this.options.circle))},onAdd:function(W){U.Marker.prototype.onAdd.call(this,W),this._circleLoc&&(W.addLayer(this._circleLoc),this.options.animate&&this.animate())},onRemove:function(W){U.Marker.prototype.onRemove.call(this,W),this._circleLoc&&W.removeLayer(this._circleLoc)},setLatLng:function(W){return U.Marker.prototype.setLatLng.call(this,W),this._circleLoc&&this._circleLoc.setLatLng(W),this},_initIcon:function(){this.options.icon&&U.Marker.prototype._initIcon.call(this)},_removeIcon:function(){this.options.icon&&U.Marker.prototype._removeIcon.call(this)},animate:function(){if(this._circleLoc){const W=this._circleLoc,X=200,tt=5;let Y=parseInt(W._radius/tt);const nt=this.options.circle.radius;let it=W._radius*2,rt=0;W._timerAnimLoc=setInterval(function(){rt+=.5,Y+=rt,it-=Y,W.setRadius(it),it<nt&&(clearInterval(W._timerAnimLoc),W.setRadius(nt))},X)}return this}}),U.Map.addInitHook(function(){this.options.searchControl&&(this.searchControl=U.control.search(this.options.searchControl),this.addControl(this.searchControl))}),U.control.search=function(W){return new U.Control.Search(W)},U.Control.Search})})(leafletSearch_src);function create_fragment$1(Z){let U,W,X,tt,Y;return{c(){U=element("input"),W=space(),X=element("button"),X.textContent="Search",attr(U,"type","text"),attr(U,"id","search-input"),attr(U,"class","rounded-md text-white p-1 w-40 bg-slate-700"),attr(U,"placeholder","Search for an event"),attr(X,"class","rounded-md p-1 mt-2 bg-slate-700"),attr(X,"id","search-button")},m(nt,it){insert(nt,U,it),set_input_value(U,Z[1]),insert(nt,W,it),insert(nt,X,it),tt||(Y=[listen(U,"input",Z[2]),listen(X,"click",Z[3])],tt=!0)},p(nt,[it]){it&2&&U.value!==nt[1]&&set_input_value(U,nt[1])},i:noop$1,o:noop$1,d(nt){nt&&detach(U),nt&&detach(W),nt&&detach(X),tt=!1,run_all(Y)}}}function instance$1(Z,U,W){let X,tt=L.featureGroup();function Y(){tt.clearLayers(),dbLayer.eachLayer(rt=>{rt.feature.properties.excerpt.toLowerCase().includes(X.toLowerCase())&&tt.addLayer(new L.CircleMarker(rt.getLatLng(),{radius:30,color:"#ff7800",weight:5,opacity:.65}))}),tt.getLayers().length>0?tt.addTo(map):alert("No results found.")}function nt(){X=this.value,W(1,X)}return[Y,X,nt,()=>Y()]}class Search extends SvelteComponent{constructor(U){super(),init$1(this,U,instance$1,create_fragment$1,safe_not_equal,{searchLayer:0})}get searchLayer(){return this.$$.ctx[0]}}function n(){}function t(Z){return Z()}function e(){return Object.create(null)}function o(Z){Z.forEach(t)}function i(Z){return typeof Z=="function"}function c(Z,U){return Z!=Z?U==U:Z!==U||Z&&typeof Z=="object"||typeof Z=="function"}function s(Z,U,W,X){if(Z){const tt=u(Z,U,W,X);return Z[0](tt)}}function u(Z,U,W,X){return Z[1]&&X?function(tt,Y){for(const nt in Y)tt[nt]=Y[nt];return tt}(W.ctx.slice(),Z[1](X(U))):W.ctx}function a(Z,U,W,X,tt,Y,nt){const it=function(rt,st,at,ct){if(rt[2]&&ct){const ht=rt[2](ct(at));if(st.dirty===void 0)return ht;if(typeof ht=="object"){const ut=[],dt=Math.max(st.dirty.length,ht.length);for(let _t=0;_t<dt;_t+=1)ut[_t]=st.dirty[_t]|ht[_t];return ut}return st.dirty|ht}return st.dirty}(U,X,tt,Y);if(it){const rt=u(U,W,X,nt);Z.p(rt,it)}}function l(Z){return Z&&i(Z.destroy)?Z.destroy:n}function d(Z,U){Z.appendChild(U)}function f(Z,U,W){Z.insertBefore(U,W||null)}function p(Z){Z.parentNode.removeChild(Z)}function $(Z){return document.createElement(Z)}function h(){return Z=" ",document.createTextNode(Z);var Z}function g(Z,U,W,X){return Z.addEventListener(U,W,X),()=>Z.removeEventListener(U,W,X)}function y(Z,U,W){W==null?Z.removeAttribute(U):Z.getAttribute(U)!==W&&Z.setAttribute(U,W)}function m(Z,U,W){Z.classList[W?"add":"remove"](U)}let b;function x(Z){b=Z}function v(){if(!b)throw new Error("Function called outside component initialization");return b}function k(){const Z=v();return(U,W)=>{const X=Z.$$.callbacks[U];if(X){const tt=function(Y,nt){const it=document.createEvent("CustomEvent");return it.initCustomEvent(Y,!1,!1,nt),it}(U,W);X.slice().forEach(Y=>{Y.call(Z,tt)})}}}const _=[],E=[],w=[],j=[],O=Promise.resolve();let A=!1;function L$1(Z){w.push(Z)}let C=!1;const N=new Set;function P(){if(!C){C=!0;do{for(let Z=0;Z<_.length;Z+=1){const U=_[Z];x(U),q(U.$$)}for(x(null),_.length=0;E.length;)E.pop()();for(let Z=0;Z<w.length;Z+=1){const U=w[Z];N.has(U)||(N.add(U),U())}w.length=0}while(_.length);for(;j.length;)j.pop()();A=!1,C=!1,N.clear()}}function q(Z){if(Z.fragment!==null){Z.update(),o(Z.before_update);const U=Z.dirty;Z.dirty=[-1],Z.fragment&&Z.fragment.p(Z.ctx,U),Z.after_update.forEach(L$1)}}const F=new Set;function H(Z,U){Z&&Z.i&&(F.delete(Z),Z.i(U))}function M(Z,U,W,X){if(Z&&Z.o){if(F.has(Z))return;F.add(Z),(void 0).c.push(()=>{F.delete(Z),X&&(W&&Z.d(1),X())}),Z.o(U)}}function S(Z,U){Z.$$.dirty[0]===-1&&(_.push(Z),A||(A=!0,O.then(P)),Z.$$.dirty.fill(0)),Z.$$.dirty[U/31|0]|=1<<U%31}function z(Z,U,W,X,tt,Y,nt=[-1]){const it=b;x(Z);const rt=Z.$$={fragment:null,ctx:null,props:Y,update:n,not_equal:tt,bound:e(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(it?it.$$.context:U.context||[]),callbacks:e(),dirty:nt,skip_bound:!1};let st=!1;if(rt.ctx=W?W(Z,U.props||{},(at,ct,...ht)=>{const ut=ht.length?ht[0]:ct;return rt.ctx&&tt(rt.ctx[at],rt.ctx[at]=ut)&&(!rt.skip_bound&&rt.bound[at]&&rt.bound[at](ut),st&&S(Z,at)),ct}):[],rt.update(),st=!0,o(rt.before_update),rt.fragment=!!X&&X(rt.ctx),U.target){if(U.hydrate){const at=function(ct){return Array.from(ct.childNodes)}(U.target);rt.fragment&&rt.fragment.l(at),at.forEach(p)}else rt.fragment&&rt.fragment.c();U.intro&&H(Z.$$.fragment),function(at,ct,ht,ut){const{fragment:dt,on_mount:_t,on_destroy:kt,after_update:gt}=at.$$;dt&&dt.m(ct,ht),ut||L$1(()=>{const Tt=_t.map(t).filter(i);kt?kt.push(...Tt):o(Tt),at.$$.on_mount=[]}),gt.forEach(L$1)}(Z,U.target,U.anchor,U.customElement),P()}x(it)}class B{$destroy(){(function(U,W){const X=U.$$;X.fragment!==null&&(o(X.on_destroy),X.fragment&&X.fragment.d(W),X.on_destroy=X.fragment=null,X.ctx=[])})(this,1),this.$destroy=n}$on(U,W){const X=this.$$.callbacks[U]||(this.$$.callbacks[U]=[]);return X.push(W),()=>{const tt=X.indexOf(W);tt!==-1&&X.splice(tt,1)}}$set(U){var W;this.$$set&&(W=U,Object.keys(W).length!==0)&&(this.$$.skip_bound=!0,this.$$set(U),this.$$.skip_bound=!1)}}function T(Z,U){U=Object.assign({open:!0,duration:.2,easing:"ease"},U);const W=()=>{};let X=W,tt=W;const Y=Z.addEventListener("transitionend",()=>{X(),X=W,tt=W});async function nt(){return new Promise(requestAnimationFrame)}function it(){return`height ${U.duration}s ${U.easing}`}async function rt(){Z.style.height=Z.scrollHeight+"px";try{await async function(){return new Promise((st,at)=>{X=st,tt=at})}(),Z.style.height="auto"}catch{}}return Z.style.overflow="hidden",Z.style.transition=it(),Z.style.height=U.open?"auto":"0px",{update:function(st){(U=Object.assign(U,st)).open?rt():async function(){Z.style.height==="auto"?(Z.style.transition="none",await nt(),Z.style.height=Z.scrollHeight+"px",Z.style.transition=it(),await nt(),Z.style.height="0px"):(tt(),Z.style.height="0px")}()},destroy:function(){Z.removeEventListener("transitionend",Y)}}}const D=Z=>({}),G=Z=>({}),I=Z=>({}),J=Z=>({});function K(Z){let U,W,X,tt,Y,nt,it,rt;const st=Z[5].header,at=s(st,Z,Z[4],J),ct=Z[5].body,ht=s(ct,Z,Z[4],G);return{c(){U=$("div"),W=$("div"),at&&at.c(),X=h(),tt=$("div"),ht&&ht.c(),y(W,"class","card-header svelte-yon7im"),y(tt,"class","card-body"),y(U,"class","card"),y(U,"aria-expanded",Z[0]),m(U,"open",Z[0])},m(ut,dt){f(ut,U,dt),d(U,W),at&&at.m(W,null),d(U,X),d(U,tt),ht&&ht.m(tt,null),nt=!0,it||(rt=[g(W,"click",Z[3]),l(Y=T.call(null,tt,{open:Z[0],duration:Z[1],easing:Z[2]}))],it=!0)},p(ut,[dt]){at&&at.p&&(!nt||16&dt)&&a(at,st,ut,ut[4],dt,I,J),ht&&ht.p&&(!nt||16&dt)&&a(ht,ct,ut,ut[4],dt,D,G),Y&&i(Y.update)&&7&dt&&Y.update.call(null,{open:ut[0],duration:ut[1],easing:ut[2]}),(!nt||1&dt)&&y(U,"aria-expanded",ut[0]),1&dt&&m(U,"open",ut[0])},i(ut){nt||(H(at,ut),H(ht,ut),nt=!0)},o(ut){M(at,ut),M(ht,ut),nt=!1},d(ut){ut&&p(U),at&&at.d(ut),ht&&ht.d(ut),it=!1,o(rt)}}}function Q(Z,U,W){let{$$slots:X={},$$scope:tt}=U,{open:Y=!0}=U,{duration:nt=.2}=U,{easing:it="ease"}=U;const rt=k();return Z.$$set=st=>{"open"in st&&W(0,Y=st.open),"duration"in st&&W(1,nt=st.duration),"easing"in st&&W(2,it=st.easing),"$$scope"in st&&W(4,tt=st.$$scope)},[Y,nt,it,function(){W(0,Y=!Y),rt(Y?"open":"close")},tt,X]}class R extends B{constructor(U){super(),z(this,U,Q,K,c,{open:0,duration:1,easing:2})}}const App_svelte_svelte_type_style_lang="";function create_header_slot(Z){let U;return{c(){U=element("h2"),U.textContent="Events in focus ⌄",attr(U,"class","font-semibold text-xl "),attr(U,"slot","header")},m(W,X){insert(W,U,X)},p:noop$1,d(W){W&&detach(U)}}}function create_body_slot(Z){let U,W,X;return W=new SelectedFeatures({props:{height:Z[2]}}),{c(){U=element("div"),create_component(W.$$.fragment),attr(U,"slot","body")},m(tt,Y){insert(tt,U,Y),mount_component(W,U,null),X=!0},p(tt,Y){const nt={};Y&4&&(nt.height=tt[2]),W.$set(nt)},i(tt){X||(transition_in(W.$$.fragment,tt),X=!0)},o(tt){transition_out(W.$$.fragment,tt),X=!1},d(tt){tt&&detach(U),destroy_component(W)}}}function create_fragment(Z){let U,W,X,tt,Y,nt,it,rt,st,at,ct,ht,ut,dt;return add_render_callback(Z[3]),W=new Map$1({}),rt=new Search({}),ct=new R({props:{$$slots:{body:[create_body_slot],header:[create_header_slot]},$$scope:{ctx:Z}}}),{c(){U=element("main"),create_component(W.$$.fragment),X=space(),tt=element("div"),Y=element("div"),Y.innerHTML=`<h1 class="font-bold text-3xl ">Explorer for Hindutva Watch</h1> 
      <h3>This is a prototype to explore linked stories of Hindutva</h3>`,nt=space(),it=element("div"),create_component(rt.$$.fragment),st=space(),at=element("div"),create_component(ct.$$.fragment),attr(Y,"id","meta-info"),attr(Y,"class","m-3 svelte-4w7jep"),attr(it,"id","search"),attr(it,"class","m-2"),attr(tt,"id","left-bar"),attr(tt,"class","p-4 svelte-4w7jep"),attr(at,"id","right-bar"),attr(at,"class","p-4 svelte-4w7jep")},m(_t,kt){insert(_t,U,kt),mount_component(W,U,null),append(U,X),append(U,tt),append(tt,Y),append(tt,nt),append(tt,it),mount_component(rt,it,null),append(U,st),append(U,at),mount_component(ct,at,null),ht=!0,ut||(dt=listen(window,"resize",Z[3]),ut=!0)},p(_t,[kt]){const gt={};kt&20&&(gt.$$scope={dirty:kt,ctx:_t}),ct.$set(gt)},i(_t){ht||(transition_in(W.$$.fragment,_t),transition_in(rt.$$.fragment,_t),transition_in(ct.$$.fragment,_t),ht=!0)},o(_t){transition_out(W.$$.fragment,_t),transition_out(rt.$$.fragment,_t),transition_out(ct.$$.fragment,_t),ht=!1},d(_t){_t&&detach(U),destroy_component(W),destroy_component(rt),destroy_component(ct),ut=!1,dt()}}}function instance(Z,U,W){let X,tt,Y;function nt(){W(1,X=window.innerWidth),W(0,tt=window.innerHeight)}return Z.$$.update=()=>{Z.$$.dirty&1&&W(2,Y=tt/2)},[tt,X,Y,nt]}class App extends SvelteComponent{constructor(U){super(),init$1(this,U,instance,create_fragment,safe_not_equal,{})}}new App({target:document.getElementById("app")});
